â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  Byaboneka+ Frontend                                       â•‘
â•‘  Project Code Dump â€” AI Review Edition                      â•‘
â•‘  Generated: 2026-02-14T17:57:19.879Z                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  PROJECT SUMMARY
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Files included:  57
  Total lines:     11,353
  Total size:      407.7 KB
  Languages:       SVG (1), TSX (37), TypeScript (8), CSS (1), Text (3), HTML (1), JSON (4), JavaScript (2)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  DIRECTORY STRUCTURE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  frontend/
  â”œâ”€â”€ public/
  â”‚   â”œâ”€â”€ fonts/
  â”‚   â”‚   â””â”€â”€ satoshi/
  â”‚   â”‚       â”œâ”€â”€ Satoshi-Black.woff2 (23.7 KB)
  â”‚   â”‚       â”œâ”€â”€ Satoshi-BlackItalic.woff2 (24.9 KB)
  â”‚   â”‚       â”œâ”€â”€ Satoshi-Bold.woff2 (26.1 KB)
  â”‚   â”‚       â”œâ”€â”€ Satoshi-BoldItalic.woff2 (27.8 KB)
  â”‚   â”‚       â”œâ”€â”€ Satoshi-Italic.woff2 (27.9 KB)
  â”‚   â”‚       â”œâ”€â”€ Satoshi-Light.woff2 (23.2 KB)
  â”‚   â”‚       â”œâ”€â”€ Satoshi-LightItalic.woff2 (24.2 KB)
  â”‚   â”‚       â”œâ”€â”€ Satoshi-Medium.woff2 (26.6 KB)
  â”‚   â”‚       â”œâ”€â”€ Satoshi-MediumItalic.woff2 (27.9 KB)
  â”‚   â”‚       â”œâ”€â”€ Satoshi-Regular.woff2 (26.5 KB)
  â”‚   â”‚       â”œâ”€â”€ Satoshi-Variable.woff2 (41.6 KB)
  â”‚   â”‚       â””â”€â”€ Satoshi-VariableItalic.woff2 (42.8 KB)
  â”‚   â”œâ”€â”€ logo.svg (260 B)
  â”‚   â””â”€â”€ placeholder.png (270 B)
  â”œâ”€â”€ src/
  â”‚   â”œâ”€â”€ components/
  â”‚   â”‚   â”œâ”€â”€ layout/
  â”‚   â”‚   â”‚   â””â”€â”€ index.tsx (13.0 KB)
  â”‚   â”‚   â”œâ”€â”€ ui/
  â”‚   â”‚   â”‚   â””â”€â”€ index.tsx (24.0 KB)
  â”‚   â”‚   â”œâ”€â”€ CooperativeLeaderboard.tsx (9.2 KB)
  â”‚   â”‚   â”œâ”€â”€ DisputeForm.tsx (7.5 KB)
  â”‚   â”‚   â”œâ”€â”€ DuplicateWarning.tsx (7.5 KB)
  â”‚   â”‚   â”œâ”€â”€ HandoverOTPPanel.tsx (11.6 KB)
  â”‚   â”‚   â”œâ”€â”€ SafeHandoverLocationPicker.tsx (6.6 KB)
  â”‚   â”‚   â”œâ”€â”€ SafetyWarningBanner.tsx (5.5 KB)
  â”‚   â”‚   â”œâ”€â”€ ScamReportButton.tsx (8.1 KB)
  â”‚   â”‚   â””â”€â”€ VerificationStrengthIndicator.tsx (9.4 KB)
  â”‚   â”œâ”€â”€ pages/
  â”‚   â”‚   â”œâ”€â”€ AboutPage.tsx (0 B)
  â”‚   â”‚   â”œâ”€â”€ AdminDashboardPage.tsx (7.4 KB)
  â”‚   â”‚   â”œâ”€â”€ AdminFraudDashboard.tsx (7.6 KB)
  â”‚   â”‚   â”œâ”€â”€ AdminScamReportsPage.tsx (11.9 KB)
  â”‚   â”‚   â”œâ”€â”€ AdminUsersPage.tsx (12.1 KB)
  â”‚   â”‚   â”œâ”€â”€ ClaimDetailPage.tsx (13.9 KB)
  â”‚   â”‚   â”œâ”€â”€ ContactPage.tsx (9.0 KB)
  â”‚   â”‚   â”œâ”€â”€ CoopDashboardPage.tsx (6.0 KB)
  â”‚   â”‚   â”œâ”€â”€ DashboardPage.tsx (13.4 KB)
  â”‚   â”‚   â”œâ”€â”€ EditFoundItemPage.tsx (9.7 KB)
  â”‚   â”‚   â”œâ”€â”€ EditLostItemPage.tsx (8.6 KB)
  â”‚   â”‚   â”œâ”€â”€ ForgotPasswordPage.tsx (3.4 KB)
  â”‚   â”‚   â”œâ”€â”€ FoundItemDetailPage.tsx (16.1 KB)
  â”‚   â”‚   â”œâ”€â”€ HomePage.tsx (13.5 KB)
  â”‚   â”‚   â”œâ”€â”€ LoginPage.tsx (5.3 KB)
  â”‚   â”‚   â”œâ”€â”€ LostItemDetailPage.tsx (13.5 KB)
  â”‚   â”‚   â”œâ”€â”€ MessagesPage.tsx (4.2 KB)
  â”‚   â”‚   â”œâ”€â”€ MyItemsPage.tsx (14.0 KB)
  â”‚   â”‚   â”œâ”€â”€ PrivacyPolicyPage.tsx (4.4 KB)
  â”‚   â”‚   â”œâ”€â”€ RegisterPage.tsx (9.6 KB)
  â”‚   â”‚   â”œâ”€â”€ ReportFoundPage.tsx (14.4 KB)
  â”‚   â”‚   â”œâ”€â”€ ReportLostPage.tsx (16.3 KB)
  â”‚   â”‚   â”œâ”€â”€ ResetPasswordPage.tsx (5.4 KB)
  â”‚   â”‚   â”œâ”€â”€ SearchPage.tsx (16.6 KB)
  â”‚   â”‚   â”œâ”€â”€ SettingsPage.tsx (11.3 KB)
  â”‚   â”‚   â””â”€â”€ TermsPage.tsx (5.4 KB)
  â”‚   â”œâ”€â”€ services/
  â”‚   â”‚   â”œâ”€â”€ api.ts (18.0 KB)
  â”‚   â”‚   â””â”€â”€ novelFeatureApi.ts (2.6 KB)
  â”‚   â”œâ”€â”€ store/
  â”‚   â”‚   â””â”€â”€ authStore.ts (1.7 KB)
  â”‚   â”œâ”€â”€ types/
  â”‚   â”‚   â””â”€â”€ index.ts (7.8 KB)
  â”‚   â”œâ”€â”€ utils/
  â”‚   â”‚   â”œâ”€â”€ dateUtils.ts (1.8 KB)
  â”‚   â”‚   â””â”€â”€ index.ts (29 B)
  â”‚   â”œâ”€â”€ App.tsx (9.1 KB)
  â”‚   â”œâ”€â”€ index.css (4.3 KB)
  â”‚   â”œâ”€â”€ main.tsx (236 B)
  â”‚   â””â”€â”€ vite-env.d.ts (157 B)
  â”œâ”€â”€ .env.example (106 B)
  â”œâ”€â”€ Dockerfile (140 B)
  â”œâ”€â”€ generate-dump.cjs (11.2 KB)
  â”œâ”€â”€ index.html (806 B)
  â”œâ”€â”€ package.json (1.0 KB)
  â”œâ”€â”€ postcss.config.js (80 B)
  â”œâ”€â”€ tailwind.config.js (1.2 KB)
  â”œâ”€â”€ tsconfig.json (640 B)
  â”œâ”€â”€ tsconfig.node.json (212 B)
  â”œâ”€â”€ vercel.json (345 B)
  â””â”€â”€ vite.config.ts (319 B)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  TABLE OF CONTENTS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

  ğŸ“ public/
      1. public/logo.svg  [5 lines | SVG]

  ğŸ“ src/
      1. src/components/layout/index.tsx  [315 lines | TSX]
      2. src/components/ui/index.tsx  [870 lines | TSX]
      3. src/components/CooperativeLeaderboard.tsx  [236 lines | TSX]
      4. src/components/DisputeForm.tsx  [208 lines | TSX]
      5. src/components/DuplicateWarning.tsx  [184 lines | TSX]
      6. src/components/HandoverOTPPanel.tsx  [306 lines | TSX]
      7. src/components/SafeHandoverLocationPicker.tsx  [196 lines | TSX]
      8. src/components/SafetyWarningBanner.tsx  [128 lines | TSX]
      9. src/components/ScamReportButton.tsx  [204 lines | TSX]
     10. src/components/VerificationStrengthIndicator.tsx  [255 lines | TSX]
     11. src/pages/AdminDashboardPage.tsx  [172 lines | TSX]
     12. src/pages/AdminFraudDashboard.tsx  [234 lines | TSX]
     13. src/pages/AdminScamReportsPage.tsx  [320 lines | TSX]
     14. src/pages/AdminUsersPage.tsx  [326 lines | TSX]
     15. src/pages/ClaimDetailPage.tsx  [350 lines | TSX]
     16. src/pages/ContactPage.tsx  [178 lines | TSX]
     17. src/pages/CoopDashboardPage.tsx  [177 lines | TSX]
     18. src/pages/DashboardPage.tsx  [319 lines | TSX]
     19. src/pages/EditFoundItemPage.tsx  [273 lines | TSX]
     20. src/pages/EditLostItemPage.tsx  [249 lines | TSX]
     21. src/pages/ForgotPasswordPage.tsx  [101 lines | TSX]
     22. src/pages/FoundItemDetailPage.tsx  [406 lines | TSX]
     23. src/pages/HomePage.tsx  [263 lines | TSX]
     24. src/pages/LoginPage.tsx  [141 lines | TSX]
     25. src/pages/LostItemDetailPage.tsx  [365 lines | TSX]
     26. src/pages/MessagesPage.tsx  [113 lines | TSX]
     27. src/pages/MyItemsPage.tsx  [306 lines | TSX]
     28. src/pages/PrivacyPolicyPage.tsx  [91 lines | TSX]
     29. src/pages/RegisterPage.tsx  [257 lines | TSX]
     30. src/pages/ReportFoundPage.tsx  [382 lines | TSX]
     31. src/pages/ReportLostPage.tsx  [432 lines | TSX]
     32. src/pages/ResetPasswordPage.tsx  [170 lines | TSX]
     33. src/pages/SearchPage.tsx  [428 lines | TSX]
     34. src/pages/SettingsPage.tsx  [312 lines | TSX]
     35. src/pages/TermsPage.tsx  [105 lines | TSX]
     36. src/services/api.ts  [562 lines | TypeScript]
     37. src/services/novelFeatureApi.ts  [83 lines | TypeScript]
     38. src/store/authStore.ts  [70 lines | TypeScript]
     39. src/types/index.ts  [320 lines | TypeScript]
     40. src/utils/dateUtils.ts  [61 lines | TypeScript]
     41. src/utils/index.ts  [2 lines | TypeScript]
     42. src/App.tsx  [328 lines | TSX]
     43. src/index.css  [208 lines | CSS]
     44. src/main.tsx  [11 lines | TSX]
     45. src/vite-env.d.ts  [10 lines | TypeScript]

  ğŸ“ (root)/
      1. .env.example  [6 lines | Text]
      2. .gitignore  [107 lines | Text]
      3. Dockerfile  [14 lines | Text]
      4. index.html  [19 lines | HTML]
      5. package.json  [40 lines | JSON]
      6. postcss.config.js  [7 lines | JavaScript]
      7. tailwind.config.js  [54 lines | JavaScript]
      8. tsconfig.json  [25 lines | JSON]
      9. tsconfig.node.json  [10 lines | JSON]
     10. vercel.json  [23 lines | JSON]
     11. vite.config.ts  [16 lines | TypeScript]




â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                      SOURCE CODE FILES                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  SECTION: public/
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: public/logo.svg
â”‚ Language: SVG | Lines: 5 | Size: 260 B
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
  <rect width="100" height="100" rx="20" fill="#1E3A5F"/>
  <text x="50" y="65" font-family="Arial, sans-serif" font-size="40" font-weight="bold" fill="white" text-anchor="middle">B+</text>
</svg>




â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  SECTION: src/
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/components/layout/index.tsx
â”‚ Language: TSX | Lines: 315 | Size: 13.0 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState } from 'react';
import { Link, useNavigate, useLocation } from 'react-router-dom';
import { 
  Menu, X, Search, Bell, User, LogOut, 
  Home, FileText, Package, MessageSquare, Settings,
  Shield, ChevronDown, Trophy
} from 'lucide-react';
import { clsx } from 'clsx';
import { useAuthStore } from '../../store/authStore';
import { authApi } from '../../services/api';
import toast from 'react-hot-toast';

// ============================================
// HEADER
// ============================================

export const Header: React.FC = () => {
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
  const [profileMenuOpen, setProfileMenuOpen] = useState(false);
  const { user, isAuthenticated, logout } = useAuthStore();
  const navigate = useNavigate();
  const location = useLocation();

  const handleLogout = async () => {
    try {
      await authApi.logout();
    } catch (error) {
      // Continue with logout even if API call fails
    }
    logout();
    toast.success('Logged out successfully');
    navigate('/');
  };

  const navLinks = [
    { href: '/', label: 'Home', icon: Home },
    { href: '/search', label: 'Search', icon: Search },
    { href: '/report-lost', label: 'Report Lost', icon: FileText },
    { href: '/report-found', label: 'Report Found', icon: Package },
    { href: '/leaderboard', label: 'Leaderboard', icon: Trophy },
  ];

  const isActive = (href: string) => location.pathname === href;

  return (
    <header className="bg-white shadow-sm border-b border-gray-100 sticky top-0 z-40">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex justify-between items-center h-16">
          {/* Logo */}
          <Link to="/" className="flex items-center space-x-2">
            <div className="w-10 h-10 bg-primary-500 rounded-lg flex items-center justify-center">
              <span className="text-white font-bold text-xl">B+</span>
            </div>
            <span className="font-bold text-xl text-primary-500 hidden sm:block">
              Byaboneka+
            </span>
          </Link>

          {/* Desktop Navigation */}
          <nav className="hidden md:flex items-center space-x-1">
            {navLinks.map((link) => (
              <Link
                key={link.href}
                to={link.href}
                className={clsx(
                  'px-3 py-2 rounded-lg text-sm font-medium transition-colors',
                  isActive(link.href)
                    ? 'bg-primary-50 text-primary-600'
                    : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'
                )}
              >
                {link.label}
              </Link>
            ))}
          </nav>

          {/* Right side */}
          <div className="flex items-center space-x-4">
            {isAuthenticated ? (
              <>
                {/* Notifications */}
                <Link 
                  to="/messages" 
                  className="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg relative"
                >
                  <Bell className="w-5 h-5" />
                </Link>

                {/* Profile Dropdown */}
                <div className="relative">
                  <button
                    onClick={() => setProfileMenuOpen(!profileMenuOpen)}
                    className="flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100 transition-colors"
                  >
                    <div className="w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center">
                      <User className="w-4 h-4 text-primary-600" />
                    </div>
                    <span className="hidden sm:block text-sm font-medium text-gray-700">
                      {user?.name?.split(' ')[0]}
                    </span>
                    <ChevronDown className="w-4 h-4 text-gray-500" />
                  </button>

                  {profileMenuOpen && (
                    <>
                      <div 
                        className="fixed inset-0" 
                        onClick={() => setProfileMenuOpen(false)} 
                      />
                      <div className="absolute right-0 mt-2 w-56 bg-white rounded-xl shadow-lg border border-gray-100 py-2 animate-fade-in">
                        <div className="px-4 py-2 border-b border-gray-100">
                          <p className="text-sm font-medium text-gray-900">{user?.name}</p>
                          <p className="text-xs text-gray-500">{user?.email}</p>
                          <div className="flex items-center mt-1">
                            <Shield className="w-3 h-3 text-trust-500 mr-1" />
                            <span className="text-xs text-trust-600">
                              Trust Score: {user?.trust_score}
                            </span>
                          </div>
                        </div>
                        <Link
                          to="/dashboard"
                          className="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50"
                          onClick={() => setProfileMenuOpen(false)}
                        >
                          <Home className="w-4 h-4 mr-3" />
                          Dashboard
                        </Link>
                        <Link
                          to="/my-items"
                          className="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50"
                          onClick={() => setProfileMenuOpen(false)}
                        >
                          <Package className="w-4 h-4 mr-3" />
                          My Items
                        </Link>
                        <Link
                          to="/messages"
                          className="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50"
                          onClick={() => setProfileMenuOpen(false)}
                        >
                          <MessageSquare className="w-4 h-4 mr-3" />
                          Messages
                        </Link>
                        <Link
                          to="/settings"
                          className="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50"
                          onClick={() => setProfileMenuOpen(false)}
                        >
                          <Settings className="w-4 h-4 mr-3" />
                          Settings
                        </Link>
                        {user?.role === 'admin' && (
                          <Link
                            to="/admin"
                            className="flex items-center px-4 py-2 text-sm text-purple-600 hover:bg-purple-50"
                            onClick={() => setProfileMenuOpen(false)}
                          >
                            <Shield className="w-4 h-4 mr-3" />
                            Admin Panel
                          </Link>
                        )}
                        {user?.role === 'coop_staff' && (
                          <Link
                            to="/coop"
                            className="flex items-center px-4 py-2 text-sm text-blue-600 hover:bg-blue-50"
                            onClick={() => setProfileMenuOpen(false)}
                          >
                            <Package className="w-4 h-4 mr-3" />
                            Cooperative
                          </Link>
                        )}
                        <div className="border-t border-gray-100 mt-2 pt-2">
                          <button
                            onClick={handleLogout}
                            className="flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50"
                          >
                            <LogOut className="w-4 h-4 mr-3" />
                            Logout
                          </button>
                        </div>
                      </div>
                    </>
                  )}
                </div>
              </>
            ) : (
              <div className="flex items-center space-x-2">
                <Link
                  to="/login"
                  className="px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900"
                >
                  Log in
                </Link>
                <Link
                  to="/register"
                  className="px-4 py-2 text-sm font-medium text-white bg-primary-500 rounded-lg hover:bg-primary-600 transition-colors"
                >
                  Sign up
                </Link>
              </div>
            )}

            {/* Mobile menu button */}
            <button
              className="md:hidden p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg"
              onClick={() => setMobileMenuOpen(!mobileMenuOpen)}
            >
              {mobileMenuOpen ? <X className="w-6 h-6" /> : <Menu className="w-6 h-6" />}
            </button>
          </div>
        </div>

        {/* Mobile Navigation */}
        {mobileMenuOpen && (
          <div className="md:hidden py-4 border-t border-gray-100 animate-fade-in">
            <nav className="space-y-1">
              {navLinks.map((link) => (
                <Link
                  key={link.href}
                  to={link.href}
                  onClick={() => setMobileMenuOpen(false)}
                  className={clsx(
                    'flex items-center px-4 py-3 rounded-lg text-sm font-medium',
                    isActive(link.href)
                      ? 'bg-primary-50 text-primary-600'
                      : 'text-gray-600 hover:bg-gray-50'
                  )}
                >
                  <link.icon className="w-5 h-5 mr-3" />
                  {link.label}
                </Link>
              ))}
            </nav>
          </div>
        )}
      </div>
    </header>
  );
};

// ============================================
// FOOTER (FIX: All links now point to real pages)
// ============================================

export const Footer: React.FC = () => {
  return (
    <footer className="bg-white border-t border-gray-100 mt-auto">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div className="grid grid-cols-1 md:grid-cols-4 gap-8">
          {/* Brand */}
          <div className="col-span-1 md:col-span-2">
            <div className="flex items-center space-x-2 mb-4">
              <div className="w-10 h-10 bg-primary-500 rounded-lg flex items-center justify-center">
                <span className="text-white font-bold text-xl">B+</span>
              </div>
              <span className="font-bold text-xl text-primary-500">Byaboneka+</span>
            </div>
            <p className="text-gray-600 text-sm max-w-md">
              Trust-Aware Lost & Found Infrastructure for Rwanda's Transport Ecosystem. 
              Helping reunite people with their belongings securely.
            </p>
          </div>

          {/* Quick Links - FIX: Updated to point to real pages */}
          <div>
            <h4 className="font-semibold text-gray-900 mb-4">Quick Links</h4>
            <ul className="space-y-2">
              <li><Link to="/search" className="text-sm text-gray-600 hover:text-primary-500">Search Items</Link></li>
              <li><Link to="/report-lost" className="text-sm text-gray-600 hover:text-primary-500">Report Lost</Link></li>
              <li><Link to="/report-found" className="text-sm text-gray-600 hover:text-primary-500">Report Found</Link></li>
              <li><Link to="/how-it-works" className="text-sm text-gray-600 hover:text-primary-500">How It Works</Link></li>
              <li><Link to="/leaderboard" className="text-sm text-gray-600 hover:text-primary-500">Leaderboard</Link></li>
            </ul>
          </div>

          {/* Support - FIX: Updated to point to real pages */}
          <div>
            <h4 className="font-semibold text-gray-900 mb-4">Support</h4>
            <ul className="space-y-2">
              <li><Link to="/faq" className="text-sm text-gray-600 hover:text-primary-500">FAQ</Link></li>
              <li><Link to="/contact" className="text-sm text-gray-600 hover:text-primary-500">Contact Us</Link></li>
              <li><Link to="/privacy" className="text-sm text-gray-600 hover:text-primary-500">Privacy Policy</Link></li>
              <li><Link to="/terms" className="text-sm text-gray-600 hover:text-primary-500">Terms of Service</Link></li>
            </ul>
          </div>
        </div>

        <div className="mt-8 pt-8 border-t border-gray-100 text-center">
          <p className="text-sm text-gray-500">
            Â© {new Date().getFullYear()} Byaboneka+. ALU Mission Capstone Project.
          </p>
        </div>
      </div>
    </footer>
  );
};

// ============================================
// LAYOUT
// ============================================

interface LayoutProps {
  children: React.ReactNode;
}

export const Layout: React.FC<LayoutProps> = ({ children }) => {
  return (
    <div className="min-h-screen flex flex-col">
      <Header />
      <main className="flex-1">{children}</main>
      <Footer />
    </div>
  );
};


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/components/ui/index.tsx
â”‚ Language: TSX | Lines: 870 | Size: 24.0 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useRef, useEffect } from 'react';
import { clsx } from 'clsx';
import { Loader2, X, AlertTriangle, CheckCircle, Info, AlertCircle, ChevronDown } from 'lucide-react';
// ============================================
// BUTTON - Professional, clean, and standards-compliant
// ============================================
interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: 'primary' | 'secondary' | 'accent' | 'danger' | 'ghost' | 'outline';
  size?: 'xs' | 'sm' | 'md' | 'lg' | 'xl';
  loading?: boolean;
  fullWidth?: boolean;
  leftIcon?: React.ReactNode;
  rightIcon?: React.ReactNode;
  children: React.ReactNode;
}

export const Button: React.FC<ButtonProps> = ({
  variant = 'primary',
  size = 'md',
  loading = false,
  fullWidth = false,
  leftIcon,
  rightIcon,
  disabled,
  className = '',
  children,
  ...props
}) => {
  const baseStyles = 'inline-flex items-center justify-center font-medium rounded-lg transition-all duration-150 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-60 disabled:cursor-not-allowed';
  
  const variants = {
    primary: 'bg-gradient-to-r from-primary-500 to-primary-600 text-white hover:from-primary-600 hover:to-primary-700 focus:ring-primary-500 shadow-sm hover:shadow',
    secondary: 'bg-white text-gray-700 border border-gray-200 hover:border-gray-300 hover:bg-gray-50 focus:ring-gray-300',
    accent: 'bg-gradient-to-r from-accent-500 to-accent-600 text-white hover:from-accent-600 hover:to-accent-700 focus:ring-accent-500 shadow-sm hover:shadow',
    danger: 'bg-gradient-to-r from-red-500 to-red-600 text-white hover:from-red-600 hover:to-red-700 focus:ring-red-500 shadow-sm hover:shadow',
    ghost: 'bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-300',
    outline: 'bg-transparent text-primary-600 border border-primary-500 hover:bg-primary-50 focus:ring-primary-500',
  };
  
  const sizes = {
    xs: 'px-2.5 py-1.5 text-xs gap-1.5',
    sm: 'px-3 py-2 text-sm gap-2',
    md: 'px-4 py-2.5 text-sm gap-2',
    lg: 'px-5 py-3 text-base gap-2.5',
    xl: 'px-6 py-3.5 text-base gap-3',
  };

  const iconSize = {
    xs: 'w-3.5 h-3.5',
    sm: 'w-4 h-4',
    md: 'w-4 h-4',
    lg: 'w-5 h-5',
    xl: 'w-5 h-5',
  };

  return (
    <button
      className={`${baseStyles} ${variants[variant]} ${sizes[size]} ${fullWidth ? 'w-full' : ''} ${className}`}
      disabled={disabled || loading}
      {...props}
    >
      {loading && (
        <svg 
          className={`animate-spin ${iconSize[size]}`} 
          xmlns="http://www.w3.org/2000/svg" 
          fill="none" 
          viewBox="0 0 24 24"
        >
          <circle 
            className="opacity-25" 
            cx="12" 
            cy="12" 
            r="10" 
            stroke="currentColor" 
            strokeWidth="4"
          />
          <path 
            className="opacity-75" 
            fill="currentColor" 
            d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
          />
        </svg>
      )}
      
      {!loading && leftIcon && (
        <span className={iconSize[size]}>{leftIcon}</span>
      )}
      
      {children}
      
      {!loading && rightIcon && (
        <span className={iconSize[size]}>{rightIcon}</span>
      )}
    </button>
  );
};

// ============================================
// INPUT - Professional with icons and validation
// ============================================
interface InputProps extends React.InputHTMLAttributes<HTMLInputElement> {
  label?: string;
  error?: string;
  helperText?: string;
  leftIcon?: React.ReactNode;
  rightIcon?: React.ReactNode;
  containerClassName?: string;
}

export const Input: React.FC<InputProps> = ({
  label,
  error,
  helperText,
  leftIcon,
  rightIcon,
  className,
  containerClassName,
  id,
  ...props
}) => {
  const inputId = id || label?.toLowerCase().replace(/\s/g, '-');
  
  return (
    <div className={clsx('w-full', containerClassName)}>
      {label && (
        <label htmlFor={inputId} className="block text-sm font-medium text-gray-700 mb-1.5">
          {label}
          {props.required && <span className="text-red-500 ml-0.5">*</span>}
        </label>
      )}
      <div className="relative">
        {leftIcon && (
          <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400">
            {leftIcon}
          </div>
        )}
        <input
          id={inputId}
          className={clsx(
            'w-full rounded-xl border transition-all duration-200 outline-none',
            'px-4 py-3 text-gray-900 placeholder-gray-400',
            'focus:ring-2 focus:ring-offset-0',
            leftIcon && 'pl-10',
            rightIcon && 'pr-10',
            error
              ? 'border-red-300 focus:border-red-500 focus:ring-red-200 bg-red-50'
              : 'border-gray-200 focus:border-primary-500 focus:ring-primary-200 hover:border-gray-300',
            props.disabled && 'bg-gray-50 cursor-not-allowed',
            className
          )}
          {...props}
        />
        {rightIcon && (
          <div className="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400">
            {rightIcon}
          </div>
        )}
      </div>
      {error && (
        <p className="mt-1.5 text-sm text-red-600 flex items-center gap-1">
          <AlertCircle className="w-4 h-4 flex-shrink-0" />
          {error}
        </p>
      )}
      {helperText && !error && (
        <p className="mt-1.5 text-sm text-gray-500">{helperText}</p>
      )}
    </div>
  );
};

// ============================================
// TEXTAREA - Professional multi-line input
// ============================================
interface TextareaProps extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {
  label?: string;
  error?: string;
  helperText?: string;
  containerClassName?: string;
}

export const Textarea: React.FC<TextareaProps> = ({
  label,
  error,
  helperText,
  className,
  containerClassName,
  id,
  ...props
}) => {
  const inputId = id || label?.toLowerCase().replace(/\s/g, '-');
  
  return (
    <div className={clsx('w-full', containerClassName)}>
      {label && (
        <label htmlFor={inputId} className="block text-sm font-medium text-gray-700 mb-1.5">
          {label}
          {props.required && <span className="text-red-500 ml-0.5">*</span>}
        </label>
      )}
      <textarea
        id={inputId}
        className={clsx(
          'w-full rounded-xl border transition-all duration-200 outline-none resize-none',
          'px-4 py-3 text-gray-900 placeholder-gray-400',
          'focus:ring-2 focus:ring-offset-0',
          error
            ? 'border-red-300 focus:border-red-500 focus:ring-red-200 bg-red-50'
            : 'border-gray-200 focus:border-primary-500 focus:ring-primary-200 hover:border-gray-300',
          props.disabled && 'bg-gray-50 cursor-not-allowed',
          className
        )}
        {...props}
      />
      {error && (
        <p className="mt-1.5 text-sm text-red-600 flex items-center gap-1">
          <AlertCircle className="w-4 h-4 flex-shrink-0" />
          {error}
        </p>
      )}
      {helperText && !error && (
        <p className="mt-1.5 text-sm text-gray-500">{helperText}</p>
      )}
    </div>
  );
};

// ============================================
// SELECT - Professional dropdown
// ============================================
interface SelectProps extends React.SelectHTMLAttributes<HTMLSelectElement> {
  label?: string;
  error?: string;
  helperText?: string;
  options: Array<{ value: string; label: string }>;
  containerClassName?: string;
  placeholder?: string;
}

export const Select: React.FC<SelectProps> = ({
  label,
  error,
  helperText,
  options,
  className,
  containerClassName,
  id,
  placeholder,
  ...props
}) => {
  const inputId = id || label?.toLowerCase().replace(/\s/g, '-');
  
  return (
    <div className={clsx('w-full', containerClassName)}>
      {label && (
        <label htmlFor={inputId} className="block text-sm font-medium text-gray-700 mb-1.5">
          {label}
          {props.required && <span className="text-red-500 ml-0.5">*</span>}
        </label>
      )}
      <div className="relative">
        <select
          id={inputId}
          className={clsx(
            'w-full rounded-xl border transition-all duration-200 outline-none appearance-none',
            'px-4 py-3 pr-10 text-gray-900 bg-white',
            'focus:ring-2 focus:ring-offset-0',
            error
              ? 'border-red-300 focus:border-red-500 focus:ring-red-200'
              : 'border-gray-200 focus:border-primary-500 focus:ring-primary-200 hover:border-gray-300',
            props.disabled && 'bg-gray-50 cursor-not-allowed',
            !props.value && 'text-gray-400',
            className
          )}
          {...props}
        >
          {placeholder && (
            <option value="" disabled>
              {placeholder}
            </option>
          )}
          {options.map((option) => (
            <option key={option.value} value={option.value}>
              {option.label}
            </option>
          ))}
        </select>
        <ChevronDown className="absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none" />
      </div>
      {error && (
        <p className="mt-1.5 text-sm text-red-600 flex items-center gap-1">
          <AlertCircle className="w-4 h-4 flex-shrink-0" />
          {error}
        </p>
      )}
      {helperText && !error && (
        <p className="mt-1.5 text-sm text-gray-500">{helperText}</p>
      )}
    </div>
  );
};

// ============================================
// CARD - Professional container
// ============================================
interface CardProps {
  children: React.ReactNode;
  className?: string;
  onClick?: () => void;
  hover?: boolean;
  padding?: 'none' | 'sm' | 'md' | 'lg';
}

export const Card: React.FC<CardProps> = ({ 
  children, 
  className, 
  onClick, 
  hover,
  padding = 'none'
}) => {
  const paddings = {
    none: '',
    sm: 'p-3 sm:p-4',
    md: 'p-4 sm:p-6',
    lg: 'p-6 sm:p-8',
  };

  return (
    <div
      className={clsx(
        'bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden',
        hover && 'cursor-pointer hover:shadow-md hover:border-gray-200 hover:-translate-y-0.5 transition-all duration-200',
        paddings[padding],
        className
      )}
      onClick={onClick}
    >
      {children}
    </div>
  );
};

// ============================================
// BADGE - Professional status indicator
// ============================================
interface BadgeProps {
  children: React.ReactNode;
  variant?: 'default' | 'active' | 'verified' | 'pending' | 'expired' | 'danger' | 'info';
  size?: 'sm' | 'md' | 'lg';
  dot?: boolean;
  className?: string;
}

export const Badge: React.FC<BadgeProps> = ({ 
  children, 
  variant = 'default', 
  size = 'md',
  dot = false,
  className 
}) => {
  const variants = {
    default: 'bg-gray-100 text-gray-700',
    active: 'bg-blue-100 text-blue-700',
    verified: 'bg-green-100 text-green-700',
    pending: 'bg-yellow-100 text-yellow-700',
    expired: 'bg-gray-100 text-gray-500',
    danger: 'bg-red-100 text-red-700',
    info: 'bg-purple-100 text-purple-700',
  };

  const sizes = {
    sm: 'px-2 py-0.5 text-xs',
    md: 'px-2.5 py-1 text-xs',
    lg: 'px-3 py-1.5 text-sm',
  };

  const dotColors = {
    default: 'bg-gray-400',
    active: 'bg-blue-500',
    verified: 'bg-green-500',
    pending: 'bg-yellow-500',
    expired: 'bg-gray-400',
    danger: 'bg-red-500',
    info: 'bg-purple-500',
  };

  return (
    <span
      className={clsx(
        'inline-flex items-center gap-1.5 font-medium rounded-full',
        variants[variant],
        sizes[size],
        className
      )}
    >
      {dot && <span className={clsx('w-1.5 h-1.5 rounded-full', dotColors[variant])} />}
      {children}
    </span>
  );
};

// ============================================
// LOADING SPINNER
// ============================================
interface LoadingSpinnerProps {
  size?: 'sm' | 'md' | 'lg' | 'xl';
  className?: string;
}

export const LoadingSpinner: React.FC<LoadingSpinnerProps> = ({ size = 'md', className }) => {
  const sizes = {
    sm: 'w-4 h-4',
    md: 'w-8 h-8',
    lg: 'w-12 h-12',
    xl: 'w-16 h-16',
  };

  return (
    <div className={clsx('flex items-center justify-center p-4', className)}>
      <Loader2 className={clsx('animate-spin text-primary-500', sizes[size])} />
    </div>
  );
};

// ============================================
// ALERT - Professional notification
// ============================================
interface AlertProps {
  type: 'info' | 'success' | 'warning' | 'error';
  title?: string;
  children: React.ReactNode;
  onClose?: () => void;
  className?: string;
}

export const Alert: React.FC<AlertProps> = ({ type, title, children, onClose, className }) => {
  const config = {
    info: { bg: 'bg-blue-50', border: 'border-blue-200', text: 'text-blue-800', icon: Info },
    success: { bg: 'bg-green-50', border: 'border-green-200', text: 'text-green-800', icon: CheckCircle },
    warning: { bg: 'bg-yellow-50', border: 'border-yellow-200', text: 'text-yellow-800', icon: AlertTriangle },
    error: { bg: 'bg-red-50', border: 'border-red-200', text: 'text-red-800', icon: AlertCircle },
  };

  const { bg, border, text, icon: Icon } = config[type];

  return (
    <div className={clsx('p-4 rounded-xl border flex gap-3', bg, border, className)}>
      <Icon className={clsx('w-5 h-5 flex-shrink-0 mt-0.5', text)} />
      <div className="flex-1 min-w-0">
        {title && <h4 className={clsx('font-semibold mb-1', text)}>{title}</h4>}
        <div className={clsx('text-sm', text)}>{children}</div>
      </div>
      {onClose && (
        <button onClick={onClose} className={clsx('flex-shrink-0', text, 'hover:opacity-70')}>
          <X className="w-5 h-5" />
        </button>
      )}
    </div>
  );
};

// ============================================
// MODAL - Professional dialog
// ============================================
interface ModalProps {
  isOpen: boolean;
  onClose: () => void;
  title?: string;
  children: React.ReactNode;
  size?: 'sm' | 'md' | 'lg' | 'xl' | 'full';
  showClose?: boolean;
}

export const Modal: React.FC<ModalProps> = ({ 
  isOpen, 
  onClose, 
  title, 
  children, 
  size = 'md',
  showClose = true
}) => {
  const modalRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    if (isOpen) {
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = 'unset';
    }
    return () => {
      document.body.style.overflow = 'unset';
    };
  }, [isOpen]);

  useEffect(() => {
    const handleEscape = (e: KeyboardEvent) => {
      if (e.key === 'Escape') onClose();
    };
    if (isOpen) {
      document.addEventListener('keydown', handleEscape);
    }
    return () => document.removeEventListener('keydown', handleEscape);
  }, [isOpen, onClose]);

  if (!isOpen) return null;

  const sizes = {
    sm: 'max-w-sm',
    md: 'max-w-md',
    lg: 'max-w-lg',
    xl: 'max-w-2xl',
    full: 'max-w-4xl',
  };

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6">
      <div 
        className="absolute inset-0 bg-black/50 backdrop-blur-sm animate-fade-in" 
        onClick={onClose} 
      />
      <div 
        ref={modalRef}
        className={clsx(
          'relative bg-white rounded-2xl shadow-2xl w-full animate-slide-up max-h-[90vh] overflow-hidden flex flex-col',
          sizes[size]
        )}
      >
        {(title || showClose) && (
          <div className="px-6 py-4 border-b border-gray-100 flex items-center justify-between flex-shrink-0">
            {title && <h3 className="text-lg font-semibold text-gray-900">{title}</h3>}
            {showClose && (
              <button
                onClick={onClose}
                className="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors -mr-2"
              >
                <X className="w-5 h-5" />
              </button>
            )}
          </div>
        )}
        <div className="p-6 overflow-y-auto flex-1">{children}</div>
      </div>
    </div>
  );
};

// ============================================
// CONFIRM MODAL - For delete confirmations
// ============================================
interface ConfirmModalProps {
  isOpen: boolean;
  onClose: () => void;
  onConfirm: () => void;
  title: string;
  message: string;
  confirmText?: string;
  cancelText?: string;
  variant?: 'danger' | 'warning' | 'info';
  loading?: boolean;
}

export const ConfirmModal: React.FC<ConfirmModalProps> = ({
  isOpen,
  onClose,
  onConfirm,
  title,
  message,
  confirmText = 'Confirm',
  cancelText = 'Cancel',
  variant = 'danger',
  loading = false,
}) => {
  const icons = {
    danger: <AlertTriangle className="w-12 h-12 text-red-500" />,
    warning: <AlertTriangle className="w-12 h-12 text-yellow-500" />,
    info: <Info className="w-12 h-12 text-blue-500" />,
  };

  return (
    <Modal isOpen={isOpen} onClose={onClose} size="sm" showClose={false}>
      <div className="text-center">
        <div className="flex justify-center mb-4">{icons[variant]}</div>
        <h3 className="text-lg font-semibold text-gray-900 mb-2">{title}</h3>
        <p className="text-gray-600 mb-6">{message}</p>
        <div className="flex gap-3">
          <Button 
            variant="secondary" 
            onClick={onClose} 
            fullWidth
            disabled={loading}
          >
            {cancelText}
          </Button>
          <Button 
            variant={variant === 'danger' ? 'danger' : 'primary'} 
            onClick={onConfirm} 
            fullWidth
            loading={loading}
          >
            {confirmText}
          </Button>
        </div>
      </div>
    </Modal>
  );
};

// ============================================
// EMPTY STATE - Professional placeholder
// ============================================
interface EmptyStateProps {
  icon?: React.ReactNode;
  title: string;
  description?: string;
  action?: React.ReactNode;
  className?: string;
}

export const EmptyState: React.FC<EmptyStateProps> = ({ 
  icon, 
  title, 
  description, 
  action,
  className 
}) => {
  return (
    <div className={clsx('text-center py-12 px-4', className)}>
      {icon && (
        <div className="flex justify-center mb-4 text-gray-300">
          {icon}
        </div>
      )}
      <h3 className="text-lg font-semibold text-gray-900 mb-2">{title}</h3>
      {description && <p className="text-gray-500 mb-6 max-w-sm mx-auto">{description}</p>}
      {action && <div className="flex justify-center">{action}</div>}
    </div>
  );
};

// ============================================
// SKELETON - Loading placeholder
// ============================================
interface SkeletonProps {
  className?: string;
  variant?: 'text' | 'circular' | 'rectangular';
  width?: string | number;
  height?: string | number;
}

export const Skeleton: React.FC<SkeletonProps> = ({ 
  className, 
  variant = 'text',
  width,
  height
}) => {
  const variants = {
    text: 'rounded',
    circular: 'rounded-full',
    rectangular: 'rounded-xl',
  };

  return (
    <div
      className={clsx(
        'animate-pulse bg-gray-200',
        variants[variant],
        variant === 'text' && 'h-4',
        className
      )}
      style={{ width, height }}
    />
  );
};

// ============================================
// AVATAR - User profile image
// ============================================
interface AvatarProps {
  src?: string;
  alt?: string;
  name?: string;
  size?: 'xs' | 'sm' | 'md' | 'lg' | 'xl';
  className?: string;
}

export const Avatar: React.FC<AvatarProps> = ({ 
  src, 
  alt, 
  name, 
  size = 'md',
  className 
}) => {
  const sizes = {
    xs: 'w-6 h-6 text-xs',
    sm: 'w-8 h-8 text-sm',
    md: 'w-10 h-10 text-base',
    lg: 'w-12 h-12 text-lg',
    xl: 'w-16 h-16 text-xl',
  };

  const getInitials = (name: string) => {
    return name
      .split(' ')
      .map((n) => n[0])
      .join('')
      .toUpperCase()
      .slice(0, 2);
  };

  if (src) {
    return (
      <img
        src={src}
        alt={alt || name}
        className={clsx('rounded-full object-cover', sizes[size], className)}
      />
    );
  }

  return (
    <div
      className={clsx(
        'rounded-full bg-gradient-to-br from-primary-400 to-primary-600 text-white font-semibold flex items-center justify-center',
        sizes[size],
        className
      )}
    >
      {name ? getInitials(name) : '?'}
    </div>
  );
};

// ============================================
// TOOLTIP - Professional hover info
// ============================================
interface TooltipProps {
  content: string;
  children: React.ReactNode;
  position?: 'top' | 'bottom' | 'left' | 'right';
}

export const Tooltip: React.FC<TooltipProps> = ({ 
  content, 
  children, 
  position = 'top' 
}) => {
  const [show, setShow] = useState(false);

  const positions = {
    top: 'bottom-full left-1/2 -translate-x-1/2 mb-2',
    bottom: 'top-full left-1/2 -translate-x-1/2 mt-2',
    left: 'right-full top-1/2 -translate-y-1/2 mr-2',
    right: 'left-full top-1/2 -translate-y-1/2 ml-2',
  };

  return (
    <div 
      className="relative inline-block"
      onMouseEnter={() => setShow(true)}
      onMouseLeave={() => setShow(false)}
    >
      {children}
      {show && (
        <div
          className={clsx(
            'absolute z-50 px-3 py-2 text-sm text-white bg-gray-900 rounded-lg whitespace-nowrap animate-fade-in',
            positions[position]
          )}
        >
          {content}
        </div>
      )}
    </div>
  );
};

// ============================================
// TABS - Professional tab navigation
// ============================================
interface Tab {
  id: string;
  label: string;
  icon?: React.ReactNode;
  count?: number;
}

interface TabsProps {
  tabs: Tab[];
  activeTab: string;
  onChange: (tabId: string) => void;
  className?: string;
}

export const Tabs: React.FC<TabsProps> = ({ tabs, activeTab, onChange, className }) => {
  return (
    <div className={clsx('border-b border-gray-200', className)}>
      <nav className="flex gap-1 -mb-px overflow-x-auto scrollbar-hide">
        {tabs.map((tab) => (
          <button
            key={tab.id}
            onClick={() => onChange(tab.id)}
            className={clsx(
              'flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap',
              activeTab === tab.id
                ? 'border-primary-500 text-primary-600'
                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
            )}
          >
            {tab.icon}
            {tab.label}
            {tab.count !== undefined && (
              <span
                className={clsx(
                  'px-2 py-0.5 text-xs font-medium rounded-full',
                  activeTab === tab.id
                    ? 'bg-primary-100 text-primary-600'
                    : 'bg-gray-100 text-gray-600'
                )}
              >
                {tab.count}
              </span>
            )}
          </button>
        ))}
      </nav>
    </div>
  );
};

// ============================================
// PROGRESS - Progress bar
// ============================================
interface ProgressProps {
  value: number;
  max?: number;
  size?: 'sm' | 'md' | 'lg';
  showLabel?: boolean;
  className?: string;
}

export const Progress: React.FC<ProgressProps> = ({ 
  value, 
  max = 100, 
  size = 'md',
  showLabel = false,
  className 
}) => {
  const percentage = Math.min(100, Math.max(0, (value / max) * 100));
  
  const sizes = {
    sm: 'h-1.5',
    md: 'h-2.5',
    lg: 'h-4',
  };

  return (
    <div className={className}>
      <div className={clsx('w-full bg-gray-100 rounded-full overflow-hidden', sizes[size])}>
        <div
          className="h-full bg-gradient-to-r from-primary-500 to-primary-600 rounded-full transition-all duration-300"
          style={{ width: `${percentage}%` }}
        />
      </div>
      {showLabel && (
        <p className="text-sm text-gray-500 mt-1">{Math.round(percentage)}%</p>
      )}
    </div>
  );
};



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/components/CooperativeLeaderboard.tsx
â”‚ Language: TSX | Lines: 236 | Size: 9.2 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { cooperativeLeaderboardApi } from '../services/novelFeatureApi';

// ============================================
// TYPES
// ============================================

interface CooperativeAccountability {
  cooperative_id: number;
  cooperative_name: string;
  registration_number: string;
  total_items_received: number;
  total_items_returned: number;
  avg_return_hours: number | null;
  total_disputes: number;
  staff_count: number;
  staff_trust_average: number;
  return_rate_score: number;
  speed_score: number;
  reliability_score: number;
  staff_quality_score: number;
  accountability_score: number;
  accountability_grade: 'A' | 'B' | 'C' | 'D' | 'F';
  rank: number;
}

// ============================================
// COMPONENT
// ============================================

const CooperativeLeaderboard: React.FC = () => {
  const [cooperatives, setCooperatives] = useState<CooperativeAccountability[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [expandedId, setExpandedId] = useState<number | null>(null);

  useEffect(() => {
    loadLeaderboard();
  }, []);

  const loadLeaderboard = async () => {
    try {
      setLoading(true);
      const res = await cooperativeLeaderboardApi.getLeaderboard();
      setCooperatives(res.data?.data || []);
    } catch (err) {
      setError('Failed to load leaderboard');
    } finally {
      setLoading(false);
    }
  };

  const gradeColors: Record<string, { bg: string; text: string }> = {
    A: { bg: '#D1FAE5', text: '#065F46' },
    B: { bg: '#DBEAFE', text: '#1E40AF' },
    C: { bg: '#FEF3C7', text: '#92400E' },
    D: { bg: '#FFE4E6', text: '#9F1239' },
    F: { bg: '#FEE2E2', text: '#991B1B' },
  };

  const getRankEmoji = (rank: number) => {
    if (rank === 1) return 'ğŸ¥‡';
    if (rank === 2) return 'ğŸ¥ˆ';
    if (rank === 3) return 'ğŸ¥‰';
    return `#${rank}`;
  };

  const getReturnRate = (c: CooperativeAccountability) => {
    if (c.total_items_received === 0) return 'N/A';
    return `${Math.round((c.total_items_returned / c.total_items_received) * 100)}%`;
  };

  const getAvgTime = (hours: number | null) => {
    if (hours === null) return 'N/A';
    if (hours < 24) return `${Math.round(hours)}h`;
    return `${Math.round(hours / 24)}d`;
  };

  if (loading) {
    return (
      <div style={{ padding: 40, textAlign: 'center' }}>
        <div style={{ fontSize: 32, marginBottom: 8 }}>ğŸ“Š</div>
        <p style={{ color: '#6B7280' }}>Loading cooperative rankings...</p>
      </div>
    );
  }

  if (error) {
    return (
      <div style={{ padding: 40, textAlign: 'center' }}>
        <p style={{ color: '#EF4444' }}>{error}</p>
        <button onClick={loadLeaderboard} style={{
          marginTop: 8, padding: '8px 16px', background: '#1E3A5F',
          color: 'white', border: 'none', borderRadius: 8, cursor: 'pointer'
        }}>Retry</button>
      </div>
    );
  }

  return (
    <div style={{ maxWidth: 800, margin: '0 auto', padding: 16 }}>
      {/* Header */}
      <div style={{ marginBottom: 24 }}>
        <h1 style={{ fontSize: 24, fontWeight: 700, color: '#1E3A5F', marginBottom: 4 }}>
          ğŸ† Cooperative Accountability Index
        </h1>
        <p style={{ fontSize: 14, color: '#6B7280', marginBottom: 12 }}>
          Ranking transport cooperatives by their item return performance. 
          Choose cooperatives with higher scores for better recovery chances.
        </p>
        <div style={{
          display: 'flex', gap: 12, flexWrap: 'wrap', fontSize: 12, color: '#6B7280'
        }}>
          <span>ğŸ“¦ Return Rate: 35%</span>
          <span>â±ï¸ Speed: 25%</span>
          <span>ğŸ›¡ï¸ Reliability: 20%</span>
          <span>ğŸ‘¥ Staff Quality: 20%</span>
        </div>
      </div>

      {/* Leaderboard */}
      {cooperatives.length === 0 ? (
        <p style={{ textAlign: 'center', color: '#9CA3AF', padding: 40 }}>
          No cooperative data available yet.
        </p>
      ) : (
        <div style={{ display: 'flex', flexDirection: 'column', gap: 8 }}>
          {cooperatives.map(coop => (
            <div key={coop.cooperative_id}
              onClick={() => setExpandedId(expandedId === coop.cooperative_id ? null : coop.cooperative_id)}
              style={{
                background: 'white', borderRadius: 12,
                border: '1px solid #E5E7EB',
                cursor: 'pointer',
                transition: 'box-shadow 0.2s',
                boxShadow: expandedId === coop.cooperative_id ? '0 4px 12px rgba(0,0,0,0.08)' : '0 1px 3px rgba(0,0,0,0.05)',
              }}
            >
              {/* Main row */}
              <div style={{
                padding: '14px 16px',
                display: 'flex', alignItems: 'center', justifyContent: 'space-between'
              }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: 12 }}>
                  {/* Rank */}
                  <span style={{ fontSize: 20, width: 36, textAlign: 'center' }}>
                    {getRankEmoji(coop.rank)}
                  </span>
                  
                  {/* Name & stats */}
                  <div>
                    <div style={{ fontWeight: 600, fontSize: 15, color: '#1F2937' }}>
                      {coop.cooperative_name}
                    </div>
                    <div style={{ fontSize: 12, color: '#6B7280', marginTop: 2 }}>
                      {coop.total_items_returned}/{coop.total_items_received} returned
                      {coop.avg_return_hours !== null && ` â€¢ avg ${getAvgTime(coop.avg_return_hours)}`}
                    </div>
                  </div>
                </div>

                {/* Grade & Score */}
                <div style={{ display: 'flex', alignItems: 'center', gap: 10 }}>
                  {/* Score bar */}
                  <div style={{ width: 80, textAlign: 'right' }}>
                    <div style={{
                      width: 80, height: 6, background: '#E5E7EB',
                      borderRadius: 3, overflow: 'hidden'
                    }}>
                      <div style={{
                        width: `${coop.accountability_score}%`, height: '100%',
                        background: coop.accountability_score >= 70 ? '#10B981' :
                                    coop.accountability_score >= 40 ? '#F59E0B' : '#EF4444',
                        borderRadius: 3
                      }} />
                    </div>
                    <span style={{ fontSize: 11, color: '#6B7280' }}>
                      {coop.accountability_score}/100
                    </span>
                  </div>
                  
                  {/* Grade badge */}
                  <div style={{
                    width: 36, height: 36, borderRadius: '50%',
                    display: 'flex', alignItems: 'center', justifyContent: 'center',
                    background: gradeColors[coop.accountability_grade].bg,
                    color: gradeColors[coop.accountability_grade].text,
                    fontWeight: 700, fontSize: 16
                  }}>
                    {coop.accountability_grade}
                  </div>
                </div>
              </div>

              {/* Expanded detail */}
              {expandedId === coop.cooperative_id && (
                <div style={{
                  padding: '12px 16px 16px 64px',
                  borderTop: '1px solid #F3F4F6',
                  display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 12
                }}>
                  <ScoreBar label="Return Rate" score={coop.return_rate_score} detail={getReturnRate(coop)} />
                  <ScoreBar label="Speed" score={coop.speed_score} detail={getAvgTime(coop.avg_return_hours)} />
                  <ScoreBar label="Reliability" score={coop.reliability_score} detail={`${coop.total_disputes} disputes`} />
                  <ScoreBar label="Staff Quality" score={coop.staff_quality_score} detail={`${coop.staff_count} staff, avg trust ${coop.staff_trust_average}`} />
                </div>
              )}
            </div>
          ))}
        </div>
      )}
    </div>
  );
};

// ============================================
// SUB-COMPONENT: Score Bar
// ============================================

const ScoreBar: React.FC<{ label: string; score: number; detail: string }> = ({ label, score, detail }) => (
  <div>
    <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 4 }}>
      <span style={{ fontSize: 12, fontWeight: 500, color: '#374151' }}>{label}</span>
      <span style={{ fontSize: 11, color: '#6B7280' }}>{detail}</span>
    </div>
    <div style={{ width: '100%', height: 6, background: '#E5E7EB', borderRadius: 3, overflow: 'hidden' }}>
      <div style={{
        width: `${score}%`, height: '100%', borderRadius: 3,
        background: score >= 70 ? '#10B981' : score >= 40 ? '#F59E0B' : '#EF4444',
        transition: 'width 0.5s ease'
      }} />
    </div>
  </div>
);

export default CooperativeLeaderboard;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/components/DisputeForm.tsx
â”‚ Language: TSX | Lines: 208 | Size: 7.5 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState } from 'react';
import { disputeApi, getErrorMessage } from '../services/api';

/**
 * DisputeForm Component for Byaboneka+
 * 
 * Implements CLAIM-07: Dispute mechanism for edge cases
 * Allows users to open a dispute when verification fails despite ownership
 * 
 * FIX #4 & #8: Now uses centralized axios `disputeApi` instead of raw fetch().
 */

interface DisputeFormProps {
  claimId: number;
  claimStatus: string;
  onDisputeOpened?: () => void;
  existingDispute?: {
    id: number;
    status: string;
    reason: string;
    created_at: string;
  } | null;
}

export const DisputeForm: React.FC<DisputeFormProps> = ({
  claimId,
  claimStatus,
  onDisputeOpened,
  existingDispute
}) => {
  const [isOpen, setIsOpen] = useState(false);
  const [reason, setReason] = useState('');
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [error, setError] = useState('');
  const [success, setSuccess] = useState(false);

  // Check if dispute can be opened
  const canDispute = ['PENDING', 'VERIFIED', 'REJECTED'].includes(claimStatus);
  const hasActiveDispute = existingDispute && ['OPEN', 'UNDER_REVIEW'].includes(existingDispute.status);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    if (reason.trim().length < 20) {
      setError('Please provide a detailed explanation (at least 20 characters)');
      return;
    }

    setIsSubmitting(true);
    setError('');

    try {
      await disputeApi.open(claimId, { reason: reason.trim() });
      setSuccess(true);
      onDisputeOpened?.();
    } catch (err: any) {
      setError(getErrorMessage(err));
    } finally {
      setIsSubmitting(false);
    }
  };

  if (hasActiveDispute) {
    return (
      <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
        <div className="flex items-start gap-3">
          <div className="flex-shrink-0">
            <svg className="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          <div>
            <h4 className="font-medium text-blue-900">Dispute Submitted</h4>
            <p className="text-sm text-blue-700 mt-1">
              Your dispute is currently <span className="font-medium">{existingDispute?.status.replace('_', ' ').toLowerCase()}</span>.
              Our team will review your case and contact you soon.
            </p>
            <p className="text-xs text-blue-600 mt-2">
              Submitted on {new Date(existingDispute!.created_at).toLocaleDateString()}
            </p>
          </div>
        </div>
      </div>
    );
  }

  if (!canDispute) {
    return null;
  }

  if (success) {
    return (
      <div className="bg-green-50 border border-green-200 rounded-lg p-4">
        <div className="flex items-center gap-3">
          <svg className="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
          </svg>
          <div>
            <h4 className="font-medium text-green-900">Dispute Submitted Successfully</h4>
            <p className="text-sm text-green-700 mt-1">
              An administrator will review your case within 24-48 hours.
            </p>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="border border-gray-200 rounded-lg overflow-hidden">
      {/* Header */}
      <button
        onClick={() => setIsOpen(!isOpen)}
        className="w-full px-4 py-3 bg-gray-50 hover:bg-gray-100 flex items-center justify-between transition-colors"
      >
        <div className="flex items-center gap-2">
          <svg 
            className="w-5 h-5 text-orange-500" 
            fill="none" 
            stroke="currentColor" 
            viewBox="0 0 24 24"
          >
            <path 
              strokeLinecap="round" 
              strokeLinejoin="round" 
              strokeWidth={2} 
              d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" 
            />
          </svg>
          <span className="font-medium text-gray-900">Having issues? Open a Dispute</span>
        </div>
        <svg 
          className={`w-5 h-5 text-gray-500 transform transition-transform ${isOpen ? 'rotate-180' : ''}`} 
          fill="none" 
          stroke="currentColor" 
          viewBox="0 0 24 24"
        >
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
        </svg>
      </button>

      {/* Form */}
      {isOpen && (
        <div className="p-4 border-t border-gray-200">
          <p className="text-sm text-gray-600 mb-4">
            If you believe you are the true owner but verification failed, or if there's an issue 
            with the handover process, you can open a dispute. An administrator will review your case.
          </p>

          <form onSubmit={handleSubmit}>
            <div className="mb-4">
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Explain your situation <span className="text-red-500">*</span>
              </label>
              <textarea
                value={reason}
                onChange={(e) => setReason(e.target.value)}
                placeholder="Please explain why you believe you are the rightful owner and why verification may have failed..."
                className="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"
                rows={4}
                maxLength={2000}
              />
              <p className="text-xs text-gray-500 mt-1">
                {reason.length}/2000 characters (minimum 20)
              </p>
            </div>

            {/* Tips */}
            <div className="bg-gray-50 rounded-lg p-3 mb-4">
              <p className="text-sm text-gray-700 font-medium mb-2">Tips for a successful dispute:</p>
              <ul className="text-xs text-gray-600 space-y-1">
                <li>â€¢ Explain what specific details you know about the item</li>
                <li>â€¢ Mention if the verification questions might have been set incorrectly</li>
                <li>â€¢ Include any additional proof of ownership you can provide</li>
                <li>â€¢ Be specific about dates and locations</li>
              </ul>
            </div>

            {error && (
              <div className="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4 text-sm">
                {error}
              </div>
            )}

            <div className="flex justify-end gap-3">
              <button
                type="button"
                onClick={() => setIsOpen(false)}
                className="px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors"
              >
                Cancel
              </button>
              <button
                type="submit"
                disabled={isSubmitting || reason.trim().length < 20}
                className="px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
              >
                {isSubmitting ? 'Submitting...' : 'Open Dispute'}
              </button>
            </div>
          </form>
        </div>
      )}
    </div>
  );
};

export default DisputeForm;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/components/DuplicateWarning.tsx
â”‚ Language: TSX | Lines: 184 | Size: 7.5 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React from 'react';

/**
 * DuplicateWarning Component for Byaboneka+
 * 
 * Implements SYS-05: Duplicate detection warning
 * Shows users potential duplicate items before they create a new report
 */

interface DuplicateCandidate {
  id: number;
  type: 'lost' | 'found';
  title: string;
  description: string;
  category: string;
  location_area: string;
  date: string;
  similarity_score: number;
  similarity_reasons: string[];
}

interface DuplicateWarningProps {
  candidates: DuplicateCandidate[];
  itemType: 'lost' | 'found';
  onContinue: () => void;
  onViewDuplicate: (id: number, type: 'lost' | 'found') => void;
  onCancel: () => void;
}

export const DuplicateWarning: React.FC<DuplicateWarningProps> = ({
  candidates,
  itemType,
  onContinue,
  onViewDuplicate,
  onCancel
}) => {
  if (candidates.length === 0) return null;

  const highestScore = Math.max(...candidates.map(c => c.similarity_score));
  const isHighProbability = highestScore >= 12;

  return (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
      <div className="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col">
        {/* Header */}
        <div className={`px-6 py-4 ${isHighProbability ? 'bg-orange-50' : 'bg-yellow-50'} border-b`}>
          <div className="flex items-start gap-3">
            <div className={`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ${isHighProbability ? 'bg-orange-100' : 'bg-yellow-100'}`}>
              <svg 
                className={`w-6 h-6 ${isHighProbability ? 'text-orange-600' : 'text-yellow-600'}`} 
                fill="none" 
                stroke="currentColor" 
                viewBox="0 0 24 24"
              >
                <path 
                  strokeLinecap="round" 
                  strokeLinejoin="round" 
                  strokeWidth={2} 
                  d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" 
                />
              </svg>
            </div>
            <div>
              <h3 className={`text-lg font-semibold ${isHighProbability ? 'text-orange-900' : 'text-yellow-900'}`}>
                {isHighProbability 
                  ? 'Possible Duplicate Detected' 
                  : 'Similar Items Found'}
              </h3>
              <p className={`text-sm mt-1 ${isHighProbability ? 'text-orange-700' : 'text-yellow-700'}`}>
                {itemType === 'lost' 
                  ? 'We found similar reports that might be yours. Please check before creating a new one.'
                  : 'We found similar items already reported. Please verify this is not a duplicate.'}
              </p>
            </div>
          </div>
        </div>

        {/* Candidate List */}
        <div className="flex-1 overflow-y-auto p-6">
          <p className="text-sm text-gray-600 mb-4">
            Found {candidates.length} similar {itemType === 'lost' ? 'report(s)' : 'item(s)'}:
          </p>

          <div className="space-y-4">
            {candidates.map((candidate) => (
              <div 
                key={`${candidate.type}-${candidate.id}`}
                className="border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors"
              >
                <div className="flex justify-between items-start mb-2">
                  <h4 className="font-medium text-gray-900">{candidate.title}</h4>
                  <span className={`text-xs px-2 py-1 rounded-full ${
                    candidate.similarity_score >= 12 
                      ? 'bg-orange-100 text-orange-700' 
                      : candidate.similarity_score >= 10 
                        ? 'bg-yellow-100 text-yellow-700'
                        : 'bg-gray-100 text-gray-700'
                  }`}>
                    {candidate.similarity_score >= 12 ? 'High match' : 
                     candidate.similarity_score >= 10 ? 'Medium match' : 'Low match'}
                  </span>
                </div>
                
                <p className="text-sm text-gray-600 mb-2 line-clamp-2">
                  {candidate.description}
                </p>
                
                <div className="flex flex-wrap gap-2 text-xs text-gray-500 mb-3">
                  <span className="flex items-center gap-1">
                    <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                    </svg>
                    {candidate.location_area}
                  </span>
                  <span className="flex items-center gap-1">
                    <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    {new Date(candidate.date).toLocaleDateString()}
                  </span>
                  <span className="bg-gray-100 px-2 py-0.5 rounded">
                    {candidate.category}
                  </span>
                </div>

                {/* Match Reasons */}
                <div className="flex flex-wrap gap-1 mb-3">
                  {candidate.similarity_reasons.slice(0, 3).map((reason, idx) => (
                    <span 
                      key={idx}
                      className="text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded"
                    >
                      {reason}
                    </span>
                  ))}
                </div>

                <button
                  onClick={() => onViewDuplicate(candidate.id, candidate.type)}
                  className="text-sm text-blue-600 hover:text-blue-700 font-medium flex items-center gap-1"
                >
                  View details
                  <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                  </svg>
                </button>
              </div>
            ))}
          </div>
        </div>

        {/* Footer */}
        <div className="px-6 py-4 bg-gray-50 border-t flex justify-between items-center">
          <p className="text-xs text-gray-500">
            {isHighProbability 
              ? 'We recommend checking the similar items before proceeding.'
              : 'You can still create your report if none of these match.'}
          </p>
          <div className="flex gap-3">
            <button
              onClick={onCancel}
              className="px-4 py-2 text-gray-700 bg-white border border-gray-300 hover:bg-gray-50 rounded-lg font-medium transition-colors"
            >
              Cancel
            </button>
            <button
              onClick={onContinue}
              className={`px-4 py-2 text-white rounded-lg font-medium transition-colors ${
                isHighProbability 
                  ? 'bg-orange-600 hover:bg-orange-700' 
                  : 'bg-blue-600 hover:bg-blue-700'
              }`}
            >
              {isHighProbability ? 'Continue Anyway' : 'Create New Report'}
            </button>
          </div>
        </div>
      </div>
    </div>
  );
};

export default DuplicateWarning;



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/components/HandoverOTPPanel.tsx
â”‚ Language: TSX | Lines: 306 | Size: 11.6 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { handoverApi, getErrorMessage } from '../services/api';

/**
 * HandoverOTPPanel Component for Byaboneka+
 * 
 * Implements secure handover OTP flow:
 * - HAND-01: OTP generation for verified claims
 * - HAND-02: 24-hour validity display
 * - HAND-03: Single-use indication
 * - HAND-04: Finder OTP input
 * - HAND-05: Attempt tracking
 * 
 * FIX #4: Now uses centralized axios `api` instance instead of raw fetch().
 *         This ensures proper auth token injection, refresh handling, and
 *         correct base URL in production (Vercel â†’ Render).
 */

interface HandoverOTPPanelProps {
  claimId: number;
  claimStatus: string;
  userRole: 'owner' | 'finder' | 'coop_staff';
  onHandoverComplete?: () => void;
}

interface HandoverStatus {
  has_otp: boolean;
  otp_verified?: boolean;
  expires_at?: string;
  attempts_used?: number;
  is_expired?: boolean;
}

export const HandoverOTPPanel: React.FC<HandoverOTPPanelProps> = ({
  claimId,
  claimStatus,
  userRole,
  onHandoverComplete
}) => {
  const [status, setStatus] = useState<HandoverStatus | null>(null);
  const [generatedOTP, setGeneratedOTP] = useState<string | null>(null);
  const [otpInput, setOtpInput] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');
  const [success, setSuccess] = useState('');
  const [showOTP, setShowOTP] = useState(false);

  // Fetch handover status
  useEffect(() => {
    fetchHandoverStatus();
  }, [claimId]);

  const fetchHandoverStatus = async () => {
    try {
      const response = await handoverApi.getStatus(claimId);
      if (response.data.success) {
        setStatus(response.data.data);
      }
    } catch (err) {
      console.error('Failed to fetch handover status:', err);
    }
  };

  // Generate OTP (Owner only)
  const handleGenerateOTP = async () => {
    setLoading(true);
    setError('');
    setGeneratedOTP(null);

    try {
      const response = await handoverApi.generateOtp(claimId);
      setGeneratedOTP(response.data.data.otp);
      setSuccess('Handover code generated! Share it only when meeting in person.');
      fetchHandoverStatus();
    } catch (err: any) {
      setError(getErrorMessage(err));
    } finally {
      setLoading(false);
    }
  };

  // Verify OTP (Finder/Coop only)
  const handleVerifyOTP = async (e: React.FormEvent) => {
    e.preventDefault();
    
    if (otpInput.length !== 6) {
      setError('Please enter a 6-digit code');
      return;
    }

    setLoading(true);
    setError('');

    try {
      const response = await handoverApi.confirmHandover(claimId, otpInput);
      setSuccess(response.data.message || 'Handover confirmed!');
      onHandoverComplete?.();
    } catch (err: any) {
      const errData = err.response?.data;
      if (errData?.attempts_remaining !== undefined) {
        setError(`Invalid code. ${errData.attempts_remaining} attempts remaining.`);
      } else {
        setError(getErrorMessage(err));
      }
      fetchHandoverStatus();
    } finally {
      setLoading(false);
      setOtpInput('');
    }
  };

  // Format time remaining
  const getTimeRemaining = () => {
    if (!status?.expires_at) return null;
    const expires = new Date(status.expires_at);
    const now = new Date();
    const diff = expires.getTime() - now.getTime();
    
    if (diff <= 0) return 'Expired';
    
    const hours = Math.floor(diff / (1000 * 60 * 60));
    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
    
    return `${hours}h ${minutes}m remaining`;
  };

  // Claim must be VERIFIED for handover
  if (claimStatus !== 'VERIFIED') {
    return null;
  }

  // Handover already completed
  if (status?.otp_verified) {
    return (
      <div className="bg-green-50 border border-green-200 rounded-lg p-6">
        <div className="flex items-center gap-4">
          <div className="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
            <svg className="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
            </svg>
          </div>
          <div>
            <h3 className="text-lg font-semibold text-green-900">Handover Complete!</h3>
            <p className="text-green-700">The item has been successfully returned to its owner.</p>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="bg-white border border-gray-200 rounded-lg overflow-hidden">
      {/* Header */}
      <div className="px-6 py-4 bg-blue-50 border-b border-blue-100">
        <h3 className="text-lg font-semibold text-blue-900 flex items-center gap-2">
          <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
          </svg>
          Secure Handover
        </h3>
        <p className="text-sm text-blue-700 mt-1">
          {userRole === 'owner' 
            ? 'Generate a one-time code to confirm the item return.'
            : 'Enter the code provided by the owner to confirm handover.'}
        </p>
      </div>

      {/* Content */}
      <div className="p-6">
        {/* Status Display */}
        {status?.has_otp && !status.is_expired && (
          <div className="mb-6 p-4 bg-gray-50 rounded-lg">
            <div className="flex justify-between items-center">
              <span className="text-sm text-gray-600">Active handover code</span>
              <span className="text-sm font-medium text-blue-600">
                {getTimeRemaining()}
              </span>
            </div>
            {status.attempts_used !== undefined && status.attempts_used > 0 && (
              <p className="text-xs text-orange-600 mt-1">
                {3 - status.attempts_used} verification attempts remaining
              </p>
            )}
          </div>
        )}

        {/* Owner View: Generate OTP */}
        {userRole === 'owner' && (
          <div>
            {generatedOTP ? (
              <div className="text-center">
                <p className="text-sm text-gray-600 mb-3">Your handover code:</p>
                <div className="relative">
                  <div className="text-4xl font-mono font-bold text-blue-600 tracking-widest bg-blue-50 py-4 rounded-lg">
                    {showOTP ? generatedOTP : 'â€¢â€¢â€¢â€¢â€¢â€¢'}
                  </div>
                  <button
                    onClick={() => setShowOTP(!showOTP)}
                    className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700"
                  >
                    {showOTP ? (
                      <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" />
                      </svg>
                    ) : (
                      <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                      </svg>
                    )}
                  </button>
                </div>
                <p className="text-xs text-gray-500 mt-3">
                  Share this code ONLY when you meet the finder in person to collect your item.
                </p>
              </div>
            ) : (
              <div className="text-center">
                {!status?.has_otp || status.is_expired ? (
                  <>
                    <p className="text-sm text-gray-600 mb-4">
                      Ready to collect your item? Generate a secure handover code.
                    </p>
                    <button
                      onClick={handleGenerateOTP}
                      disabled={loading}
                      className="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50"
                    >
                      {loading ? 'Generating...' : 'Generate Handover Code'}
                    </button>
                  </>
                ) : (
                  <p className="text-sm text-gray-600">
                    A handover code is already active. Check your records or wait for it to expire.
                  </p>
                )}
              </div>
            )}
          </div>
        )}

        {/* Finder/Coop View: Verify OTP */}
        {(userRole === 'finder' || userRole === 'coop_staff') && (
          <form onSubmit={handleVerifyOTP}>
            <p className="text-sm text-gray-600 mb-4">
              Enter the 6-digit code provided by the item owner:
            </p>
            <div className="flex gap-3">
              <input
                type="text"
                value={otpInput}
                onChange={(e) => setOtpInput(e.target.value.replace(/\D/g, '').slice(0, 6))}
                placeholder="000000"
                className="flex-1 text-center text-2xl font-mono tracking-widest border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                maxLength={6}
              />
              <button
                type="submit"
                disabled={loading || otpInput.length !== 6}
                className="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50"
              >
                {loading ? 'Verifying...' : 'Confirm'}
              </button>
            </div>
          </form>
        )}

        {/* Messages */}
        {error && (
          <div className="mt-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm">
            {error}
          </div>
        )}
        {success && (
          <div className="mt-4 p-3 bg-green-50 border border-green-200 text-green-700 rounded-lg text-sm">
            {success}
          </div>
        )}

        {/* Instructions */}
        <div className="mt-6 pt-6 border-t border-gray-200">
          <h4 className="text-sm font-medium text-gray-900 mb-2">How it works:</h4>
          <ol className="text-xs text-gray-600 space-y-1">
            {userRole === 'owner' ? (
              <>
                <li>1. Generate a secure handover code</li>
                <li>2. Meet the finder in a safe, public location</li>
                <li>3. Verify your item before sharing the code</li>
                <li>4. Share the code ONLY after receiving your item</li>
              </>
            ) : (
              <>
                <li>1. Meet the owner at the agreed location</li>
                <li>2. Hand over the item to the verified owner</li>
                <li>3. Ask the owner for the 6-digit handover code</li>
                <li>4. Enter the code here to confirm the return</li>
              </>
            )}
          </ol>
        </div>
      </div>
    </div>
  );
};

export default HandoverOTPPanel;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/components/SafeHandoverLocationPicker.tsx
â”‚ Language: TSX | Lines: 196 | Size: 6.6 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { handoverLocationsApi } from '../services/novelFeatureApi';

// ============================================
// TYPES
// ============================================

interface SafeHandoverPoint {
  id: number;
  name: string;
  type: 'COOPERATIVE_OFFICE' | 'SECTOR_OFFICE' | 'POLICE_POST' | 'TRANSIT_HUB';
  address: string;
  area: string;
  operating_hours: string;
  safety_rating: number;
}

interface Props {
  itemArea: string;
  itemCategory: string;
  onSelectLocation?: (location: SafeHandoverPoint) => void;
}

// ============================================
// COMPONENT
// ============================================

const SafeHandoverLocationPicker: React.FC<Props> = ({
  itemArea, itemCategory, onSelectLocation
}) => {
  const [locations, setLocations] = useState<SafeHandoverPoint[]>([]);
  const [loading, setLoading] = useState(true);
  const [selectedId, setSelectedId] = useState<number | null>(null);

  useEffect(() => {
    loadRecommendations();
  }, [itemArea, itemCategory]);

  const loadRecommendations = async () => {
    try {
      setLoading(true);
      const res = await handoverLocationsApi.getRecommended(itemArea, itemCategory);
      setLocations(res.data?.data || []);
    } catch {
      // Fallback to all locations
      try {
        const res = await handoverLocationsApi.getAllLocations();
        setLocations(res.data?.data?.slice(0, 5) || []);
      } catch {
        setLocations([]);
      }
    } finally {
      setLoading(false);
    }
  };

  const typeIcons: Record<string, string> = {
    'COOPERATIVE_OFFICE': 'ğŸ¢',
    'SECTOR_OFFICE': 'ğŸ›ï¸',
    'POLICE_POST': 'ğŸ‘®',
    'TRANSIT_HUB': 'ğŸšŒ',
  };

  const typeLabels: Record<string, string> = {
    'COOPERATIVE_OFFICE': 'Cooperative Office',
    'SECTOR_OFFICE': 'Sector Office',
    'POLICE_POST': 'Police Post',
    'TRANSIT_HUB': 'Transit Hub',
  };

  const typeColors: Record<string, string> = {
    'COOPERATIVE_OFFICE': '#1E3A5F',
    'SECTOR_OFFICE': '#2E7D32',
    'POLICE_POST': '#4A148C',
    'TRANSIT_HUB': '#E65100',
  };

  const handleSelect = (loc: SafeHandoverPoint) => {
    setSelectedId(loc.id);
    onSelectLocation?.(loc);
  };

  if (loading) {
    return (
      <div style={{ padding: 20, textAlign: 'center', color: '#6B7280', fontSize: 14 }}>
        Loading safe meeting points...
      </div>
    );
  }

  return (
    <div style={{ borderRadius: 12, border: '1px solid #E5E7EB', overflow: 'hidden' }}>
      {/* Header */}
      <div style={{
        padding: '12px 16px', background: '#F0F7FF',
        borderBottom: '1px solid #DBEAFE'
      }}>
        <div style={{ fontWeight: 600, fontSize: 14, color: '#1E3A5F', marginBottom: 4 }}>
          ğŸ“ Recommended Safe Meeting Points
        </div>
        <div style={{ fontSize: 12, color: '#6B7280' }}>
          {['ID', 'WALLET', 'PHONE'].includes(itemCategory)
            ? 'âš ï¸ For sensitive items, cooperative offices and sector offices are strongly recommended.'
            : 'Choose a well-lit public location during business hours.'}
        </div>
      </div>

      {/* Location list */}
      {locations.length === 0 ? (
        <div style={{ padding: 20, textAlign: 'center', color: '#9CA3AF', fontSize: 13 }}>
          No locations found for this area. You can arrange a meeting at any cooperative office.
        </div>
      ) : (
        <div>
          {locations.map((loc, i) => (
            <div
              key={loc.id}
              onClick={() => handleSelect(loc)}
              style={{
                padding: '12px 16px',
                borderBottom: i < locations.length - 1 ? '1px solid #F3F4F6' : 'none',
                cursor: 'pointer',
                background: selectedId === loc.id ? '#EFF6FF' : 'white',
                transition: 'background 0.15s',
                display: 'flex', alignItems: 'flex-start', gap: 12
              }}
            >
              {/* Icon */}
              <span style={{ fontSize: 24, flexShrink: 0, marginTop: 2 }}>
                {typeIcons[loc.type] || 'ğŸ“'}
              </span>

              {/* Details */}
              <div style={{ flex: 1, minWidth: 0 }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: 8, marginBottom: 2 }}>
                  <span style={{ fontWeight: 600, fontSize: 14, color: '#1F2937' }}>
                    {loc.name}
                  </span>
                  {i === 0 && (
                    <span style={{
                      fontSize: 10, fontWeight: 600, padding: '1px 6px',
                      borderRadius: 8, background: '#D1FAE5', color: '#065F46'
                    }}>
                      RECOMMENDED
                    </span>
                  )}
                </div>
                <div style={{ fontSize: 12, color: '#6B7280', marginBottom: 2 }}>
                  {loc.address}
                </div>
                <div style={{ display: 'flex', gap: 12, fontSize: 11, color: '#9CA3AF' }}>
                  <span style={{
                    padding: '1px 6px', borderRadius: 6,
                    background: `${typeColors[loc.type]}15`,
                    color: typeColors[loc.type],
                    fontWeight: 500
                  }}>
                    {typeLabels[loc.type]}
                  </span>
                  <span>ğŸ• {loc.operating_hours}</span>
                  <span>
                    {'â­'.repeat(Math.min(loc.safety_rating, 5))}
                  </span>
                </div>
              </div>

              {/* Selection indicator */}
              <div style={{
                width: 22, height: 22, borderRadius: '50%', flexShrink: 0,
                border: `2px solid ${selectedId === loc.id ? '#1E3A5F' : '#D1D5DB'}`,
                display: 'flex', alignItems: 'center', justifyContent: 'center',
                marginTop: 8
              }}>
                {selectedId === loc.id && (
                  <div style={{
                    width: 12, height: 12, borderRadius: '50%', background: '#1E3A5F'
                  }} />
                )}
              </div>
            </div>
          ))}
        </div>
      )}

      {/* Safety reminder */}
      <div style={{
        padding: '10px 16px', background: '#FFFBEB',
        borderTop: '1px solid #FDE68A', fontSize: 12, color: '#92400E'
      }}>
        ğŸ›¡ï¸ Never share your OTP code until you physically receive your item at the meeting location.
      </div>
    </div>
  );
};

export default SafeHandoverLocationPicker;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/components/SafetyWarningBanner.tsx
â”‚ Language: TSX | Lines: 128 | Size: 5.5 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React from 'react';

/**
 * SafetyWarningBanner Component for Byaboneka+
 * 
 * Implements COMM-04: Auto-warning banner "Never pay..."
 * Displayed on every message thread to remind users about safe practices
 */

interface SafetyWarningBannerProps {
  variant?: 'compact' | 'full';
  onDismiss?: () => void;
  dismissible?: boolean;
}

export const SafetyWarningBanner: React.FC<SafetyWarningBannerProps> = ({
  variant = 'compact',
  onDismiss,
  dismissible = false
}) => {
  if (variant === 'compact') {
    return (
      <div className="bg-amber-50 border-b border-amber-200 px-4 py-2">
        <div className="flex items-center justify-between max-w-4xl mx-auto">
          <div className="flex items-center gap-2 text-sm">
            <svg 
              className="w-4 h-4 text-amber-600 flex-shrink-0" 
              fill="none" 
              stroke="currentColor" 
              viewBox="0 0 24 24"
            >
              <path 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                strokeWidth={2} 
                d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" 
              />
            </svg>
            <span className="text-amber-800">
              <strong>Safety reminder:</strong> Never pay money before verification. 
              <span className="hidden sm:inline"> Report suspicious behavior using the button below.</span>
            </span>
          </div>
          {dismissible && onDismiss && (
            <button
              onClick={onDismiss}
              className="text-amber-600 hover:text-amber-700 ml-2"
              aria-label="Dismiss"
            >
              <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          )}
        </div>
      </div>
    );
  }

  return (
    <div className="bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4">
      <div className="flex gap-3">
        <div className="flex-shrink-0">
          <div className="w-10 h-10 bg-amber-100 rounded-full flex items-center justify-center">
            <svg 
              className="w-6 h-6 text-amber-600" 
              fill="none" 
              stroke="currentColor" 
              viewBox="0 0 24 24"
            >
              <path 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                strokeWidth={2} 
                d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" 
              />
            </svg>
          </div>
        </div>
        <div className="flex-1">
          <h4 className="text-sm font-semibold text-amber-800 mb-1">
            Stay Safe on Byaboneka+
          </h4>
          <ul className="text-sm text-amber-700 space-y-1">
            <li className="flex items-start gap-2">
              <svg className="w-4 h-4 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
              </svg>
              <span><strong>Never pay money</strong> before meeting in person and verifying the item</span>
            </li>
            <li className="flex items-start gap-2">
              <svg className="w-4 h-4 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
              </svg>
              <span><strong>Meet in public places</strong> like cooperative offices or bus stations</span>
            </li>
            <li className="flex items-start gap-2">
              <svg className="w-4 h-4 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
              </svg>
              <span><strong>Use the official OTP</strong> handover process to confirm return</span>
            </li>
            <li className="flex items-start gap-2">
              <svg className="w-4 h-4 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
              </svg>
              <span><strong>Report suspicious behavior</strong> immediately using the report button</span>
            </li>
          </ul>
        </div>
        {dismissible && onDismiss && (
          <button
            onClick={onDismiss}
            className="text-amber-600 hover:text-amber-700 self-start"
            aria-label="Dismiss"
          >
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        )}
      </div>
    </div>
  );
};

export default SafetyWarningBanner;



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/components/ScamReportButton.tsx
â”‚ Language: TSX | Lines: 204 | Size: 8.1 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState } from 'react';
import { messagesApi, getErrorMessage } from '../services/api';

/**
 * ScamReportButton Component for Byaboneka+
 * 
 * Implements COMM-03: Scam report button in every message thread
 * Allows users to report suspicious messages or behavior
 * 
 * FIX #4: Now uses centralized axios instance instead of raw fetch().
 * FIX: Uses correct backend route: POST /messages/:messageId/report
 *      (not the non-existent POST /scam-reports endpoint)
 */

interface ScamReportButtonProps {
  claimId: number;
  messageId: number;
  reportedUserId: number;
  reportedUserName: string;
  onReportSubmitted?: () => void;
}

export const ScamReportButton: React.FC<ScamReportButtonProps> = ({
  claimId,
  messageId,
  reportedUserId,
  reportedUserName,
  onReportSubmitted
}) => {
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [reason, setReason] = useState('');
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [error, setError] = useState('');
  const [success, setSuccess] = useState(false);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    if (reason.trim().length < 10) {
      setError('Please provide a detailed reason (at least 10 characters)');
      return;
    }

    setIsSubmitting(true);
    setError('');

    try {
      // Uses the correct backend route: POST /messages/:messageId/report
      await messagesApi.reportScam(messageId, reason.trim());

      setSuccess(true);
      setTimeout(() => {
        setIsModalOpen(false);
        setSuccess(false);
        setReason('');
        onReportSubmitted?.();
      }, 2000);
    } catch (err: any) {
      setError(getErrorMessage(err));
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <>
      {/* Report Button */}
      <button
        onClick={() => setIsModalOpen(true)}
        className="flex items-center gap-1 text-red-600 hover:text-red-700 text-sm font-medium transition-colors"
        title="Report suspicious behavior"
      >
        <svg
          className="w-4 h-4"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            strokeLinecap="round"
            strokeLinejoin="round"
            strokeWidth={2}
            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
          />
        </svg>
        Report Scam
      </button>

      {/* Modal */}
      {isModalOpen && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
          <div className="bg-white rounded-lg shadow-xl max-w-md w-full">
            {/* Header */}
            <div className="px-6 py-4 border-b border-gray-200">
              <div className="flex items-center justify-between">
                <h3 className="text-lg font-semibold text-gray-900">
                  Report Suspicious Behavior
                </h3>
                <button
                  onClick={() => setIsModalOpen(false)}
                  className="text-gray-400 hover:text-gray-600"
                >
                  <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>
              </div>
            </div>

            {/* Content */}
            <div className="px-6 py-4">
              {success ? (
                <div className="text-center py-8">
                  <div className="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg className="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                    </svg>
                  </div>
                  <p className="text-gray-900 font-medium">Report Submitted</p>
                  <p className="text-gray-500 text-sm mt-1">
                    Our team will review this report shortly.
                  </p>
                </div>
              ) : (
                <form onSubmit={handleSubmit}>
                  {/* Warning Banner */}
                  <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
                    <div className="flex">
                      <svg className="w-5 h-5 text-yellow-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                      </svg>
                      <div className="ml-3">
                        <p className="text-sm text-yellow-800">
                          <strong>Never pay money</strong> before meeting in person and verifying the item.
                          Legitimate finders will never ask for payment upfront.
                        </p>
                      </div>
                    </div>
                  </div>

                  <p className="text-sm text-gray-600 mb-4">
                    You are reporting <span className="font-medium">{reportedUserName}</span> for suspicious behavior.
                  </p>

                  <div className="mb-4">
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      Describe the issue <span className="text-red-500">*</span>
                    </label>
                    <textarea
                      value={reason}
                      onChange={(e) => setReason(e.target.value)}
                      placeholder="Please describe what happened and why you believe this is suspicious..."
                      className="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"
                      rows={4}
                      maxLength={1000}
                    />
                    <p className="text-xs text-gray-500 mt-1">
                      {reason.length}/1000 characters
                    </p>
                  </div>

                  {error && (
                    <div className="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4 text-sm">
                      {error}
                    </div>
                  )}

                  <div className="flex justify-end gap-3">
                    <button
                      type="button"
                      onClick={() => setIsModalOpen(false)}
                      className="px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors"
                    >
                      Cancel
                    </button>
                    <button
                      type="submit"
                      disabled={isSubmitting || reason.trim().length < 10}
                      className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                      {isSubmitting ? (
                        <span className="flex items-center gap-2">
                          <svg className="animate-spin h-4 w-4" viewBox="0 0 24 24">
                            <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" fill="none" />
                            <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" />
                          </svg>
                          Submitting...
                        </span>
                      ) : (
                        'Submit Report'
                      )}
                    </button>
                  </div>
                </form>
              )}
            </div>
          </div>
        </div>
      )}
    </>
  );
};

export default ScamReportButton;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/components/VerificationStrengthIndicator.tsx
â”‚ Language: TSX | Lines: 255 | Size: 9.4 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect, useCallback } from 'react';
import { verificationStrengthApi } from '../services/novelFeatureApi';

// ============================================
// TYPES
// ============================================

interface QuestionAnalysis {
  question_index: number;
  strength: 'WEAK' | 'MODERATE' | 'STRONG';
  score: number;
  issues: string[];
  suggestions: string[];
}

interface StrengthResult {
  overall_strength: 'WEAK' | 'MODERATE' | 'STRONG';
  overall_score: number;
  questions: QuestionAnalysis[];
  redundancy_warning: boolean;
  improvement_tips: string[];
}

interface QuestionTemplate {
  category: string;
  question: string;
  why_effective: string;
}

interface Props {
  questions: string[];
  answers: string[];
  category: string;
  description: string;
  onSelectTemplate?: (index: number, question: string) => void;
}

// ============================================
// COMPONENT
// ============================================

const VerificationStrengthIndicator: React.FC<Props> = ({
  questions, answers, category, description, onSelectTemplate
}) => {
  const [analysis, setAnalysis] = useState<StrengthResult | null>(null);
  const [templates, setTemplates] = useState<QuestionTemplate[]>([]);
  const [showTemplates, setShowTemplates] = useState(false);
  const [loading, setLoading] = useState(false);
  const [expandedQuestion, setExpandedQuestion] = useState<number | null>(null);

  // Fetch templates on mount
  useEffect(() => {
    if (category) {
      verificationStrengthApi.getTemplates(category)
        .then(res => setTemplates(res.data?.data || []))
        .catch(() => {});
    }
  }, [category]);

  // Debounced analysis
  const analyzeQuestions = useCallback(async () => {
    const hasContent = questions.some(q => q.length > 3) && answers.some(a => a.length > 0);
    if (!hasContent || !category) return;

    setLoading(true);
    try {
      const res = await verificationStrengthApi.analyzeStrength({
        questions, answers, category, description
      });
      setAnalysis(res.data?.data || null);
    } catch {
      // Silently fail - this is an enhancement, not critical
    } finally {
      setLoading(false);
    }
  }, [questions, answers, category, description]);

  useEffect(() => {
    const timer = setTimeout(analyzeQuestions, 800);
    return () => clearTimeout(timer);
  }, [analyzeQuestions]);

  // â”€â”€ Strength badge colors â”€â”€
  const strengthColors = {
    WEAK: { bg: '#FEE2E2', text: '#991B1B', border: '#FECACA', icon: 'âš ï¸' },
    MODERATE: { bg: '#FEF3C7', text: '#92400E', border: '#FDE68A', icon: 'âš¡' },
    STRONG: { bg: '#D1FAE5', text: '#065F46', border: '#A7F3D0', icon: 'âœ…' },
  };

  const getScoreBarColor = (score: number) => {
    if (score >= 65) return '#10B981';
    if (score >= 35) return '#F59E0B';
    return '#EF4444';
  };

  if (!analysis && !loading) return null;

  return (
    <div style={{ marginTop: 16, borderRadius: 12, border: '1px solid #E5E7EB', overflow: 'hidden' }}>
      {/* Header */}
      <div style={{
        padding: '12px 16px',
        background: analysis ? strengthColors[analysis.overall_strength].bg : '#F9FAFB',
        borderBottom: '1px solid #E5E7EB',
        display: 'flex', alignItems: 'center', justifyContent: 'space-between'
      }}>
        <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>
          <span style={{ fontSize: 18 }}>
            {loading ? 'â³' : analysis ? strengthColors[analysis.overall_strength].icon : ''}
          </span>
          <span style={{
            fontWeight: 600, fontSize: 14,
            color: analysis ? strengthColors[analysis.overall_strength].text : '#6B7280'
          }}>
            {loading ? 'Analyzing questions...' :
             analysis ? `Verification Strength: ${analysis.overall_strength}` : ''}
          </span>
        </div>
        {analysis && (
          <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>
            <div style={{
              width: 60, height: 6, background: '#E5E7EB', borderRadius: 3, overflow: 'hidden'
            }}>
              <div style={{
                width: `${analysis.overall_score}%`, height: '100%',
                background: getScoreBarColor(analysis.overall_score),
                borderRadius: 3, transition: 'width 0.5s ease'
              }} />
            </div>
            <span style={{ fontSize: 12, color: '#6B7280', fontWeight: 600 }}>
              {analysis.overall_score}/100
            </span>
          </div>
        )}
      </div>

      {/* Per-question analysis */}
      {analysis && (
        <div style={{ padding: '8px 0' }}>
          {analysis.questions.map((qa, i) => (
            <div key={i}
              onClick={() => setExpandedQuestion(expandedQuestion === i ? null : i)}
              style={{
                padding: '8px 16px', cursor: 'pointer',
                borderBottom: i < analysis.questions.length - 1 ? '1px solid #F3F4F6' : 'none',
              }}
            >
              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
                <span style={{ fontSize: 13, color: '#374151' }}>
                  Q{i + 1}: {questions[i]?.substring(0, 40) || '(empty)'}{questions[i]?.length > 40 ? '...' : ''}
                </span>
                <span style={{
                  fontSize: 11, fontWeight: 600, padding: '2px 8px', borderRadius: 10,
                  background: strengthColors[qa.strength].bg,
                  color: strengthColors[qa.strength].text,
                  border: `1px solid ${strengthColors[qa.strength].border}`
                }}>
                  {qa.strength}
                </span>
              </div>

              {/* Expanded details */}
              {expandedQuestion === i && (
                <div style={{ marginTop: 8, paddingLeft: 8 }}>
                  {qa.issues.length > 0 && (
                    <div style={{ marginBottom: 6 }}>
                      {qa.issues.map((issue, j) => (
                        <div key={j} style={{ fontSize: 12, color: '#DC2626', marginBottom: 2 }}>
                          âš  {issue}
                        </div>
                      ))}
                    </div>
                  )}
                  {qa.suggestions.length > 0 && (
                    <div>
                      {qa.suggestions.map((sug, j) => (
                        <div key={j} style={{ fontSize: 12, color: '#059669', marginBottom: 2 }}>
                          ğŸ’¡ {sug}
                        </div>
                      ))}
                    </div>
                  )}
                </div>
              )}
            </div>
          ))}
        </div>
      )}

      {/* Redundancy warning */}
      {analysis?.redundancy_warning && (
        <div style={{
          padding: '8px 16px', background: '#FEF3C7',
          fontSize: 13, color: '#92400E', borderTop: '1px solid #FDE68A'
        }}>
          âš ï¸ Your questions are too similar to each other. Use different types of questions for better security.
        </div>
      )}

      {/* Templates toggle */}
      <div style={{ padding: '8px 16px', borderTop: '1px solid #E5E7EB' }}>
        <button
          onClick={() => setShowTemplates(!showTemplates)}
          style={{
            background: 'none', border: 'none', cursor: 'pointer',
            fontSize: 13, color: '#1E3A5F', fontWeight: 500,
            padding: 0, textDecoration: 'underline'
          }}
        >
          {showTemplates ? 'Hide' : 'Show'} suggested questions for {category.toLowerCase()} items
        </button>

        {showTemplates && templates.length > 0 && (
          <div style={{ marginTop: 8 }}>
            {templates.map((t, i) => (
              <div key={i} style={{
                padding: '8px 12px', marginBottom: 6, background: '#F0F7FF',
                borderRadius: 8, border: '1px solid #DBEAFE',
                display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start'
              }}>
                <div>
                  <div style={{ fontSize: 13, fontWeight: 500, color: '#1E3A5F' }}>
                    "{t.question}"
                  </div>
                  <div style={{ fontSize: 11, color: '#6B7280', marginTop: 2 }}>
                    {t.why_effective}
                  </div>
                </div>
                {onSelectTemplate && (
                  <button
                    onClick={(e) => {
                      e.stopPropagation();
                      // Find next empty question slot
                      const emptyIdx = questions.findIndex(q => !q || q.length < 3);
                      if (emptyIdx >= 0) onSelectTemplate(emptyIdx, t.question);
                    }}
                    style={{
                      background: '#1E3A5F', color: 'white', border: 'none',
                      borderRadius: 6, padding: '4px 10px', fontSize: 11,
                      cursor: 'pointer', whiteSpace: 'nowrap', marginLeft: 8
                    }}
                  >
                    Use this
                  </button>
                )}
              </div>
            ))}
          </div>
        )}
      </div>
    </div>
  );
};

export default VerificationStrengthIndicator;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/AdminDashboardPage.tsx
â”‚ Language: TSX | Lines: 172 | Size: 7.4 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { Link } from 'react-router-dom';
import { 
  Users, FileText, Package, Shield, AlertTriangle, 
  CheckCircle, TrendingUp, Activity, ChevronRight, Eye
} from 'lucide-react';
import { Card, LoadingSpinner, Badge } from '../components/ui';
import { adminApi, AdminStats } from '../services/api';
import { formatDate, formatDateShort, formatDateTime } from '../utils/dateUtils';

/**
 * AdminDashboardPage - FIXED VERSION
 * 
 * FIX #2: Uses proper AdminStats type that matches backend response
 * FIX #12: Only links to pages that actually exist
 * FIX: Added Fraud Dashboard link to Quick Actions
 */

const AdminDashboardPage: React.FC = () => {
  const [stats, setStats] = useState<AdminStats | null>(null);
  const [recentUsers, setRecentUsers] = useState<any[]>([]);
  const [pendingReports, setPendingReports] = useState<any[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadDashboard();
  }, []);

  const loadDashboard = async () => {
    try {
      const [statsRes, usersRes, reportsRes] = await Promise.all([
        adminApi.getStats(),
        adminApi.getUsers({ limit: 5 }),
        adminApi.getScamReports({ status: 'OPEN', limit: 5 }),
      ]);
      setStats(statsRes.data.data);
      setRecentUsers(usersRes.data.data || []);
      setPendingReports(reportsRes.data.data || []);
    } catch (error) {
      console.error('Failed to load dashboard:', error);
    } finally {
      setLoading(false);
    }
  };

  if (loading) {
    return (
      <div className="flex justify-center py-12">
        <LoadingSpinner size="lg" />
      </div>
    );
  }

  const statCards = [
    { label: 'Total Users', value: stats?.total_users || 0, icon: Users, color: 'text-blue-500', bg: 'bg-blue-100' },
    { label: 'Lost Items', value: stats?.total_lost_items || 0, icon: FileText, color: 'text-orange-500', bg: 'bg-orange-100' },
    { label: 'Found Items', value: stats?.total_found_items || 0, icon: Package, color: 'text-green-500', bg: 'bg-green-100' },
    { label: 'Total Claims', value: stats?.total_claims || 0, icon: Shield, color: 'text-purple-500', bg: 'bg-purple-100' },
    { label: 'Successful Returns', value: stats?.successful_returns || 0, icon: CheckCircle, color: 'text-trust-500', bg: 'bg-trust-100' },
    { label: 'Pending Reports', value: stats?.pending_scam_reports || 0, icon: AlertTriangle, color: 'text-red-500', bg: 'bg-red-100' },
  ];

  return (
    <div className="max-w-7xl mx-auto px-4 py-8">
      <div className="mb-8">
        <h1 className="text-2xl font-bold text-gray-900 mb-2">Admin Dashboard</h1>
        <p className="text-gray-600">Platform overview and management</p>
      </div>

      {/* Stats Grid */}
      <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-8">
        {statCards.map((stat) => (
          <Card key={stat.label} className="p-4">
            <div className={`w-10 h-10 ${stat.bg} rounded-lg flex items-center justify-center mb-3`}>
              <stat.icon className={`w-5 h-5 ${stat.color}`} />
            </div>
            <p className="text-2xl font-bold text-gray-900">{stat.value.toLocaleString()}</p>
            <p className="text-sm text-gray-500">{stat.label}</p>
          </Card>
        ))}
      </div>

      <div className="grid lg:grid-cols-2 gap-6">
        {/* Recent Users */}
        <Card className="p-6">
          <div className="flex items-center justify-between mb-4">
            <h2 className="text-lg font-semibold text-gray-900">Recent Users</h2>
            <Link to="/admin/users" className="text-sm text-primary-500 hover:text-primary-600 flex items-center">
              View All <ChevronRight className="w-4 h-4" />
            </Link>
          </div>
          <div className="space-y-3">
            {recentUsers.length === 0 ? (
              <p className="text-gray-500 text-center py-4">No users yet</p>
            ) : (
              recentUsers.map((user) => (
                <div key={user.id} className="flex items-center justify-between py-2 border-b last:border-0">
                  <div>
                    <p className="font-medium text-gray-900">{user.name}</p>
                    <p className="text-sm text-gray-500">{user.email}</p>
                  </div>
                  <div className="text-right">
                    <Badge variant={user.role === 'admin' ? 'verified' : user.role === 'coop_staff' ? 'active' : 'default'}>
                      {user.role}
                    </Badge>
                    <p className="text-xs text-gray-400 mt-1">
                      {formatDateShort(user.created_at)}
                    </p>
                  </div>
                </div>
              ))
            )}
          </div>
        </Card>

        {/* Pending Scam Reports */}
        <Card className="p-6">
          <div className="flex items-center justify-between mb-4">
            <h2 className="text-lg font-semibold text-gray-900">Pending Scam Reports</h2>
            <Link to="/admin/scam-reports" className="text-sm text-primary-500 hover:text-primary-600 flex items-center">
              View All <ChevronRight className="w-4 h-4" />
            </Link>
          </div>
          <div className="space-y-3">
            {pendingReports.length === 0 ? (
              <div className="text-center py-8">
                <CheckCircle className="w-12 h-12 text-trust-500 mx-auto mb-2" />
                <p className="text-gray-500">No pending reports</p>
              </div>
            ) : (
              pendingReports.map((report) => (
                <div key={report.id} className="p-3 bg-red-50 rounded-lg border border-red-100">
                  <div className="flex items-start justify-between">
                    <div>
                      <p className="font-medium text-gray-900">Report #{report.id}</p>
                      <p className="text-sm text-gray-600 mt-1 line-clamp-2">{report.reason}</p>
                    </div>
                    <Badge variant="danger">Open</Badge>
                  </div>
                  <p className="text-xs text-gray-400 mt-2">
                    By {report.reporter_name} â€¢ {formatDateTime(report.created_at)}
                  </p>
                </div>
              ))
            )}
          </div>
        </Card>
      </div>

      {/* Quick Actions - FIX: Added Fraud Dashboard link */}
      <Card className="p-6 mt-6">
        <h2 className="text-lg font-semibold text-gray-900 mb-4">Quick Actions</h2>
        <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
          <Link to="/admin/users" className="p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors text-center">
            <Users className="w-6 h-6 text-gray-600 mx-auto mb-2" />
            <p className="text-sm font-medium">Manage Users</p>
          </Link>
          <Link to="/admin/scam-reports" className="p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors text-center">
            <AlertTriangle className="w-6 h-6 text-gray-600 mx-auto mb-2" />
            <p className="text-sm font-medium">Scam Reports</p>
          </Link>
          <Link to="/admin/fraud" className="p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors text-center">
            <Eye className="w-6 h-6 text-gray-600 mx-auto mb-2" />
            <p className="text-sm font-medium">Fraud Detection</p>
          </Link>
        </div>
      </Card>
    </div>
  );
};

export default AdminDashboardPage;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/AdminFraudDashboard.tsx
â”‚ Language: TSX | Lines: 234 | Size: 7.6 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { fraudApi } from '../services/novelFeatureApi';

// ============================================
// TYPES
// ============================================

interface FlaggedUser {
  id: number;
  name: string;
  email: string;
  trust_score: number;
  created_at: string;
  high_risk_events: number;
  failed_verifications_7d: number;
}

// ============================================
// COMPONENT
// ============================================

const AdminFraudDashboard: React.FC = () => {
  const [users, setUsers] = useState<FlaggedUser[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');

  useEffect(() => {
    loadFlaggedUsers();
  }, []);

  const loadFlaggedUsers = async () => {
    try {
      setLoading(true);
      const res = await fraudApi.getFlaggedUsers();
      setUsers(res.data?.data || []);
    } catch (err) {
      setError('Failed to load fraud alerts');
    } finally {
      setLoading(false);
    }
  };

  const getRiskBadge = (events: number) => {
    if (events >= 5) return { label: 'CRITICAL', bg: '#FEE2E2', color: '#991B1B' };
    if (events >= 3) return { label: 'HIGH', bg: '#FFE4E6', color: '#9F1239' };
    return { label: 'MEDIUM', bg: '#FEF3C7', color: '#92400E' };
  };

  const getTrustColor = (score: number) => {
    if (score >= 5) return '#059669';
    if (score >= 0) return '#6B7280';
    if (score >= -10) return '#D97706';
    return '#DC2626';
  };

  const getAccountAge = (createdAt: string) => {
    const days = Math.floor((Date.now() - new Date(createdAt).getTime()) / 86400000);
    if (days === 0) return 'Today';
    if (days === 1) return '1 day';
    if (days < 7) return `${days} days`;
    if (days < 30) return `${Math.floor(days / 7)} weeks`;
    return `${Math.floor(days / 30)} months`;
  };

  if (loading) {
    return (
      <div style={{ padding: 40, textAlign: 'center' }}>
        <p style={{ color: '#6B7280' }}>Loading fraud alerts...</p>
      </div>
    );
  }

  return (
    <div style={{ maxWidth: 900, margin: '0 auto', padding: 16 }}>
      {/* Header */}
      <div style={{
        display: 'flex', justifyContent: 'space-between', alignItems: 'center',
        marginBottom: 20
      }}>
        <div>
          <h2 style={{ fontSize: 20, fontWeight: 700, color: '#1E3A5F', marginBottom: 4 }}>
            ğŸš¨ Fraud Detection Alerts
          </h2>
          <p style={{ fontSize: 13, color: '#6B7280' }}>
            Users flagged by the behavioral fraud engine in the last 7 days
          </p>
        </div>
        <button onClick={loadFlaggedUsers} style={{
          padding: '8px 16px', background: '#1E3A5F', color: 'white',
          border: 'none', borderRadius: 8, cursor: 'pointer', fontSize: 13
        }}>
          Refresh
        </button>
      </div>

      {error && (
        <div style={{
          padding: '12px 16px', background: '#FEE2E2', borderRadius: 8,
          color: '#991B1B', marginBottom: 16, fontSize: 13
        }}>
          {error}
        </div>
      )}

      {/* Stats summary */}
      <div style={{
        display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: 12,
        marginBottom: 20
      }}>
        <StatCard
          label="Flagged Users"
          value={users.length}
          icon="ğŸ‘¤"
          color="#1E3A5F"
        />
        <StatCard
          label="Critical Risk"
          value={users.filter(u => u.high_risk_events >= 5).length}
          icon="ğŸ”´"
          color="#DC2626"
        />
        <StatCard
          label="Failed Verifications"
          value={users.reduce((sum, u) => sum + u.failed_verifications_7d, 0)}
          icon="âŒ"
          color="#D97706"
        />
      </div>

      {/* User list */}
      {users.length === 0 ? (
        <div style={{
          padding: 40, textAlign: 'center', background: '#F0FDF4',
          borderRadius: 12, border: '1px solid #BBF7D0'
        }}>
          <div style={{ fontSize: 32, marginBottom: 8 }}>âœ…</div>
          <p style={{ color: '#065F46', fontWeight: 500 }}>No flagged users</p>
          <p style={{ color: '#6B7280', fontSize: 13 }}>The fraud detection engine has not flagged any users in the last 7 days.</p>
        </div>
      ) : (
        <div style={{
          borderRadius: 12, border: '1px solid #E5E7EB', overflow: 'hidden'
        }}>
          {/* Table header */}
          <div style={{
            display: 'grid', gridTemplateColumns: '2fr 1fr 1fr 1fr 1fr',
            padding: '10px 16px', background: '#F9FAFB',
            borderBottom: '1px solid #E5E7EB',
            fontSize: 12, fontWeight: 600, color: '#6B7280'
          }}>
            <span>User</span>
            <span>Risk Level</span>
            <span>Trust Score</span>
            <span>Failed Claims (7d)</span>
            <span>Account Age</span>
          </div>

          {/* Rows */}
          {users.map(user => {
            const risk = getRiskBadge(user.high_risk_events);
            return (
              <div key={user.id} style={{
                display: 'grid', gridTemplateColumns: '2fr 1fr 1fr 1fr 1fr',
                padding: '12px 16px', borderBottom: '1px solid #F3F4F6',
                alignItems: 'center',
                background: user.high_risk_events >= 5 ? '#FFF5F5' : 'white'
              }}>
                {/* User info */}
                <div>
                  <div style={{ fontWeight: 500, fontSize: 14, color: '#1F2937' }}>
                    {user.name}
                  </div>
                  <div style={{ fontSize: 12, color: '#6B7280' }}>
                    {user.email}
                  </div>
                </div>

                {/* Risk badge */}
                <div>
                  <span style={{
                    fontSize: 11, fontWeight: 600, padding: '3px 8px',
                    borderRadius: 8, background: risk.bg, color: risk.color
                  }}>
                    {risk.label} ({user.high_risk_events})
                  </span>
                </div>

                {/* Trust score */}
                <div style={{
                  fontWeight: 600, fontSize: 14,
                  color: getTrustColor(user.trust_score)
                }}>
                  {user.trust_score}
                </div>

                {/* Failed verifications */}
                <div style={{
                  fontWeight: 500, fontSize: 14,
                  color: user.failed_verifications_7d > 3 ? '#DC2626' : '#6B7280'
                }}>
                  {user.failed_verifications_7d}
                </div>

                {/* Account age */}
                <div style={{ fontSize: 13, color: '#6B7280' }}>
                  {getAccountAge(user.created_at)}
                </div>
              </div>
            );
          })}
        </div>
      )}
    </div>
  );
};

// ============================================
// SUB-COMPONENT: Stat Card
// ============================================

const StatCard: React.FC<{
  label: string; value: number; icon: string; color: string;
}> = ({ label, value, icon, color }) => (
  <div style={{
    padding: '16px', background: 'white', borderRadius: 12,
    border: '1px solid #E5E7EB', textAlign: 'center'
  }}>
    <div style={{ fontSize: 20, marginBottom: 4 }}>{icon}</div>
    <div style={{ fontSize: 24, fontWeight: 700, color }}>{value}</div>
    <div style={{ fontSize: 12, color: '#6B7280' }}>{label}</div>
  </div>
);

export default AdminFraudDashboard;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/AdminScamReportsPage.tsx
â”‚ Language: TSX | Lines: 320 | Size: 11.9 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { 
  AlertTriangle, CheckCircle, XCircle, MessageSquare,
  ChevronLeft, ChevronRight, Eye
} from 'lucide-react';
import { Button, Card, Badge, LoadingSpinner, Modal, Alert } from '../components/ui';
import api from '../services/api';
import { formatDate, formatDateShort, formatDateTime } from '../utils/dateUtils';
import toast from 'react-hot-toast';

interface ScamReport {
  id: number;
  reporter_id: number;
  reporter_name: string;
  reporter_email: string;
  reported_user_id: number;
  reported_name: string;
  reported_email: string;
  message_id: number | null;
  message_content: string | null;
  claim_id: number | null;
  reason: string;
  status: string;
  resolution_notes: string | null;
  created_at: string;
  resolved_at: string | null;
}

const AdminScamReportsPage: React.FC = () => {
  const [reports, setReports] = useState<ScamReport[]>([]);
  const [loading, setLoading] = useState(true);
  const [statusFilter, setStatusFilter] = useState('OPEN');
  const [page, setPage] = useState(1);
  const [totalPages, setTotalPages] = useState(1);

  const [selectedReport, setSelectedReport] = useState<ScamReport | null>(null);
  const [showResolveModal, setShowResolveModal] = useState(false);
  const [resolution, setResolution] = useState({ notes: '', action: 'dismiss' });
  const [processing, setProcessing] = useState(false);

  useEffect(() => {
    loadReports();
  }, [page, statusFilter]);

  const loadReports = async () => {
    setLoading(true);
    try {
      const params: any = { page, limit: 20 };
      if (statusFilter) params.status = statusFilter;

      const response = await api.get('/admin/scam-reports', { params });
      setReports(response.data.data || []);
      setTotalPages(response.data.pagination?.totalPages || 1);
    } catch (error) {
      toast.error('Failed to load scam reports');
    } finally {
      setLoading(false);
    }
  };

  const handleResolve = async () => {
    if (!selectedReport || !resolution.notes.trim()) return;
    setProcessing(true);
    try {
      await api.post(`/admin/scam-reports/${selectedReport.id}/resolve`, {
        resolution_notes: resolution.notes,
        action: resolution.action
      });
      toast.success('Report resolved successfully');
      setShowResolveModal(false);
      setSelectedReport(null);
      setResolution({ notes: '', action: 'dismiss' });
      loadReports();
    } catch (error) {
      toast.error('Failed to resolve report');
    } finally {
      setProcessing(false);
    }
  };

  const getStatusBadge = (status: string) => {
    switch (status) {
      case 'OPEN': return <Badge variant="danger">Open</Badge>;
      case 'INVESTIGATING': return <Badge variant="pending">Investigating</Badge>;
      case 'RESOLVED': return <Badge variant="verified">Resolved</Badge>;
      default: return <Badge variant="default">{status}</Badge>;
    }
  };

  return (
    <div className="max-w-7xl mx-auto px-4 py-8">
      <div className="mb-8">
        <h1 className="text-2xl font-bold text-gray-900 mb-2">Scam Reports</h1>
        <p className="text-gray-600">Review and resolve user scam reports</p>
      </div>

      {/* Filters */}
      <Card className="p-4 mb-6">
        <div className="flex gap-4">
          <select
            value={statusFilter}
            onChange={(e) => { setStatusFilter(e.target.value); setPage(1); }}
            className="px-3 py-2 border border-gray-300 rounded-lg text-sm"
          >
            <option value="">All Status</option>
            <option value="OPEN">Open</option>
            <option value="INVESTIGATING">Investigating</option>
            <option value="RESOLVED">Resolved</option>
          </select>
        </div>
      </Card>

      {/* Reports List */}
      {loading ? (
        <div className="flex justify-center py-12">
          <LoadingSpinner size="lg" />
        </div>
      ) : reports.length === 0 ? (
        <Card className="p-12 text-center">
          <CheckCircle className="w-16 h-16 text-trust-500 mx-auto mb-4" />
          <h3 className="text-lg font-semibold text-gray-900 mb-2">No Reports</h3>
          <p className="text-gray-500">No scam reports match your filters</p>
        </Card>
      ) : (
        <div className="space-y-4">
          {reports.map((report) => (
            <Card key={report.id} className="p-6">
              <div className="flex items-start justify-between mb-4">
                <div className="flex items-center gap-3">
                  <div className="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center">
                    <AlertTriangle className="w-5 h-5 text-red-500" />
                  </div>
                  <div>
                    <h3 className="font-semibold text-gray-900">Report #{report.id}</h3>
                    <p className="text-sm text-gray-500">
                      {formatDateTime(report.created_at)}
                    </p>
                  </div>
                </div>
                {getStatusBadge(report.status)}
              </div>

              <div className="grid md:grid-cols-2 gap-4 mb-4">
                <div className="p-3 bg-gray-50 rounded-lg">
                  <p className="text-xs text-gray-500 mb-1">Reporter</p>
                  <p className="font-medium">{report.reporter_name}</p>
                  <p className="text-sm text-gray-500">{report.reporter_email}</p>
                </div>
                <div className="p-3 bg-red-50 rounded-lg">
                  <p className="text-xs text-gray-500 mb-1">Reported User</p>
                  <p className="font-medium">{report.reported_name}</p>
                  <p className="text-sm text-gray-500">{report.reported_email}</p>
                </div>
              </div>

              <div className="mb-4">
                <p className="text-xs text-gray-500 mb-1">Reason</p>
                <p className="text-gray-900">{report.reason}</p>
              </div>

              {report.message_content && (
                <div className="mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                  <div className="flex items-center gap-2 mb-2">
                    <MessageSquare className="w-4 h-4 text-yellow-600" />
                    <p className="text-xs text-yellow-700 font-medium">Reported Message</p>
                  </div>
                  <p className="text-sm text-gray-900">"{report.message_content}"</p>
                </div>
              )}

              {report.resolution_notes && (
                <div className="mb-4 p-3 bg-trust-50 border border-trust-200 rounded-lg">
                  <p className="text-xs text-trust-700 font-medium mb-1">Resolution</p>
                  <p className="text-sm text-gray-900">{report.resolution_notes}</p>
                  {report.resolved_at && (
                    <p className="text-xs text-gray-500 mt-1">
                      Resolved on {formatDate(report.resolved_at)}
                    </p>
                  )}
                </div>
              )}

              {report.status === 'OPEN' && (
                <div className="flex gap-3">
                  <Button
                    variant="secondary"
                    size="sm"
                    onClick={() => { setSelectedReport(report); setShowResolveModal(true); }}
                  >
                    <Eye className="w-4 h-4 mr-1" />
                    Review & Resolve
                  </Button>
                </div>
              )}
            </Card>
          ))}

          {/* Pagination */}
          {totalPages > 1 && (
            <div className="flex items-center justify-between">
              <p className="text-sm text-gray-500">
                Page {page} of {totalPages}
              </p>
              <div className="flex gap-2">
                <Button
                  variant="secondary"
                  size="sm"
                  onClick={() => setPage(p => Math.max(1, p - 1))}
                  disabled={page === 1}
                >
                  <ChevronLeft className="w-4 h-4" />
                </Button>
                <Button
                  variant="secondary"
                  size="sm"
                  onClick={() => setPage(p => Math.min(totalPages, p + 1))}
                  disabled={page === totalPages}
                >
                  <ChevronRight className="w-4 h-4" />
                </Button>
              </div>
            </div>
          )}
        </div>
      )}

      {/* Resolve Modal */}
      <Modal
        isOpen={showResolveModal}
        onClose={() => { setShowResolveModal(false); setSelectedReport(null); }}
        title="Resolve Scam Report"
      >
        {selectedReport && (
          <div>
            <div className="mb-4">
              <label className="block text-sm font-medium text-gray-700 mb-2">
                Action to take
              </label>
              <div className="space-y-2">
                <label className="flex items-center gap-2 p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
                  <input
                    type="radio"
                    name="action"
                    value="dismiss"
                    checked={resolution.action === 'dismiss'}
                    onChange={(e) => setResolution({ ...resolution, action: e.target.value })}
                  />
                  <div>
                    <p className="font-medium">Dismiss Report</p>
                    <p className="text-sm text-gray-500">Report is false or unsubstantiated</p>
                  </div>
                </label>
                <label className="flex items-center gap-2 p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
                  <input
                    type="radio"
                    name="action"
                    value="warn"
                    checked={resolution.action === 'warn'}
                    onChange={(e) => setResolution({ ...resolution, action: e.target.value })}
                  />
                  <div>
                    <p className="font-medium">Warn User</p>
                    <p className="text-sm text-gray-500">Issue warning and reduce trust score</p>
                  </div>
                </label>
                <label className="flex items-center gap-2 p-3 border border-red-200 rounded-lg cursor-pointer hover:bg-red-50">
                  <input
                    type="radio"
                    name="action"
                    value="ban"
                    checked={resolution.action === 'ban'}
                    onChange={(e) => setResolution({ ...resolution, action: e.target.value })}
                  />
                  <div>
                    <p className="font-medium text-red-600">Ban User</p>
                    <p className="text-sm text-gray-500">Permanently ban the reported user</p>
                  </div>
                </label>
              </div>
            </div>

            <div className="mb-4">
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Resolution notes *
              </label>
              <textarea
                value={resolution.notes}
                onChange={(e) => setResolution({ ...resolution, notes: e.target.value })}
                rows={3}
                className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                placeholder="Describe your findings and reasoning..."
              />
            </div>

            <div className="flex gap-3">
              <Button
                variant="secondary"
                onClick={() => { setShowResolveModal(false); setSelectedReport(null); }}
                className="flex-1"
              >
                Cancel
              </Button>
              <Button
                onClick={handleResolve}
                loading={processing}
                disabled={!resolution.notes.trim()}
                className="flex-1"
              >
                Resolve Report
              </Button>
            </div>
          </div>
        )}
      </Modal>
    </div>
  );
};

export default AdminScamReportsPage;



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/AdminUsersPage.tsx
â”‚ Language: TSX | Lines: 326 | Size: 12.1 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { 
  Search, Filter, Ban, CheckCircle, Shield, 
  ChevronLeft, ChevronRight, MoreVertical, RefreshCw
} from 'lucide-react';
import { Button, Card, Badge, Input, LoadingSpinner, Modal, Alert } from '../components/ui';
import api from '../services/api';
import { formatDate, formatDateShort, formatDateTime } from '../utils/dateUtils';
import toast from 'react-hot-toast';

interface User {
  id: number;
  email: string;
  name: string;
  phone: string | null;
  role: string;
  trust_score: number;
  is_banned: boolean;
  ban_reason: string | null;
  cooperative_name: string | null;
  created_at: string;
}

const AdminUsersPage: React.FC = () => {
  const [users, setUsers] = useState<User[]>([]);
  const [loading, setLoading] = useState(true);
  const [search, setSearch] = useState('');
  const [roleFilter, setRoleFilter] = useState('');
  const [statusFilter, setStatusFilter] = useState('');
  const [page, setPage] = useState(1);
  const [totalPages, setTotalPages] = useState(1);
  
  const [selectedUser, setSelectedUser] = useState<User | null>(null);
  const [showBanModal, setShowBanModal] = useState(false);
  const [banReason, setBanReason] = useState('');
  const [processing, setProcessing] = useState(false);

  useEffect(() => {
    loadUsers();
  }, [page, roleFilter, statusFilter]);

  const loadUsers = async () => {
    setLoading(true);
    try {
      const params: any = { page, limit: 20 };
      if (search) params.search = search;
      if (roleFilter) params.role = roleFilter;
      if (statusFilter) params.status = statusFilter;

      const response = await api.get('/admin/users', { params });
      setUsers(response.data.data || []);
      setTotalPages(response.data.pagination?.totalPages || 1);
    } catch (error) {
      toast.error('Failed to load users');
    } finally {
      setLoading(false);
    }
  };

  const handleSearch = (e: React.FormEvent) => {
    e.preventDefault();
    setPage(1);
    loadUsers();
  };

  const handleBan = async () => {
    if (!selectedUser || !banReason.trim()) return;
    setProcessing(true);
    try {
      await api.post(`/admin/users/${selectedUser.id}/ban`, { reason: banReason });
      toast.success('User banned successfully');
      setShowBanModal(false);
      setBanReason('');
      setSelectedUser(null);
      loadUsers();
    } catch (error) {
      toast.error('Failed to ban user');
    } finally {
      setProcessing(false);
    }
  };

  const handleUnban = async (userId: number) => {
    try {
      await api.post(`/admin/users/${userId}/unban`);
      toast.success('User unbanned successfully');
      loadUsers();
    } catch (error) {
      toast.error('Failed to unban user');
    }
  };

  const handleRecalculateTrust = async (userId: number) => {
    try {
      const response = await api.post(`/admin/users/${userId}/recalculate-trust`);
      toast.success(`Trust score updated to ${response.data.data.new_trust_score}`);
      loadUsers();
    } catch (error) {
      toast.error('Failed to recalculate trust');
    }
  };

  const getRoleBadge = (role: string) => {
    switch (role) {
      case 'admin': return <Badge variant="verified">Admin</Badge>;
      case 'coop_staff': return <Badge variant="active">Coop Staff</Badge>;
      default: return <Badge variant="default">Citizen</Badge>;
    }
  };

  const getTrustBadge = (score: number) => {
    if (score >= 10) return <span className="text-trust-600 font-medium">+{score}</span>;
    if (score >= 0) return <span className="text-gray-600">{score}</span>;
    return <span className="text-red-600 font-medium">{score}</span>;
  };

  return (
    <div className="max-w-7xl mx-auto px-4 py-8">
      <div className="mb-8">
        <h1 className="text-2xl font-bold text-gray-900 mb-2">User Management</h1>
        <p className="text-gray-600">View and manage platform users</p>
      </div>

      {/* Filters */}
      <Card className="p-4 mb-6">
        <form onSubmit={handleSearch} className="flex flex-wrap gap-4">
          <div className="flex-1 min-w-[200px]">
            <div className="relative">
              <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400" />
              <Input
                value={search}
                onChange={(e) => setSearch(e.target.value)}
                placeholder="Search by name or email..."
                className="pl-10"
              />
            </div>
          </div>
          <select
            value={roleFilter}
            onChange={(e) => { setRoleFilter(e.target.value); setPage(1); }}
            className="px-3 py-2 border border-gray-300 rounded-lg text-sm"
          >
            <option value="">All Roles</option>
            <option value="citizen">Citizens</option>
            <option value="coop_staff">Coop Staff</option>
            <option value="admin">Admins</option>
          </select>
          <select
            value={statusFilter}
            onChange={(e) => { setStatusFilter(e.target.value); setPage(1); }}
            className="px-3 py-2 border border-gray-300 rounded-lg text-sm"
          >
            <option value="">All Status</option>
            <option value="active">Active</option>
            <option value="banned">Banned</option>
          </select>
          <Button type="submit">Search</Button>
        </form>
      </Card>

      {/* Users Table */}
      <Card className="overflow-hidden">
        {loading ? (
          <div className="flex justify-center py-12">
            <LoadingSpinner size="lg" />
          </div>
        ) : (
          <>
            <div className="overflow-x-auto">
              <table className="w-full">
                <thead className="bg-gray-50 border-b">
                  <tr>
                    <th className="px-4 py-3 text-left text-sm font-medium text-gray-500">User</th>
                    <th className="px-4 py-3 text-left text-sm font-medium text-gray-500">Role</th>
                    <th className="px-4 py-3 text-left text-sm font-medium text-gray-500">Trust</th>
                    <th className="px-4 py-3 text-left text-sm font-medium text-gray-500">Status</th>
                    <th className="px-4 py-3 text-left text-sm font-medium text-gray-500">Joined</th>
                    <th className="px-4 py-3 text-right text-sm font-medium text-gray-500">Actions</th>
                  </tr>
                </thead>
                <tbody className="divide-y">
                  {users.length === 0 ? (
                    <tr>
                      <td colSpan={6} className="px-4 py-8 text-center text-gray-500">
                        No users found
                      </td>
                    </tr>
                  ) : (
                    users.map((user) => (
                      <tr key={user.id} className="hover:bg-gray-50">
                        <td className="px-4 py-3">
                          <div>
                            <p className="font-medium text-gray-900">{user.name}</p>
                            <p className="text-sm text-gray-500">{user.email}</p>
                            {user.cooperative_name && (
                              <p className="text-xs text-primary-600">{user.cooperative_name}</p>
                            )}
                          </div>
                        </td>
                        <td className="px-4 py-3">{getRoleBadge(user.role)}</td>
                        <td className="px-4 py-3">{getTrustBadge(user.trust_score)}</td>
                        <td className="px-4 py-3">
                          {user.is_banned ? (
                            <Badge variant="danger">Banned</Badge>
                          ) : (
                            <Badge variant="verified">Active</Badge>
                          )}
                        </td>
                        <td className="px-4 py-3 text-sm text-gray-500">
                          {formatDate(user.created_at)}
                        </td>
                        <td className="px-4 py-3 text-right">
                          <div className="flex items-center justify-end gap-2">
                            <button
                              onClick={() => handleRecalculateTrust(user.id)}
                              className="p-1 text-gray-400 hover:text-gray-600"
                              title="Recalculate Trust"
                            >
                              <RefreshCw className="w-4 h-4" />
                            </button>
                            {user.is_banned ? (
                              <button
                                onClick={() => handleUnban(user.id)}
                                className="p-1 text-trust-500 hover:text-trust-600"
                                title="Unban User"
                              >
                                <CheckCircle className="w-4 h-4" />
                              </button>
                            ) : user.role !== 'admin' ? (
                              <button
                                onClick={() => { setSelectedUser(user); setShowBanModal(true); }}
                                className="p-1 text-red-400 hover:text-red-600"
                                title="Ban User"
                              >
                                <Ban className="w-4 h-4" />
                              </button>
                            ) : null}
                          </div>
                        </td>
                      </tr>
                    ))
                  )}
                </tbody>
              </table>
            </div>

            {/* Pagination */}
            {totalPages > 1 && (
              <div className="flex items-center justify-between px-4 py-3 border-t">
                <p className="text-sm text-gray-500">
                  Page {page} of {totalPages}
                </p>
                <div className="flex gap-2">
                  <Button
                    variant="secondary"
                    size="sm"
                    onClick={() => setPage(p => Math.max(1, p - 1))}
                    disabled={page === 1}
                  >
                    <ChevronLeft className="w-4 h-4" />
                  </Button>
                  <Button
                    variant="secondary"
                    size="sm"
                    onClick={() => setPage(p => Math.min(totalPages, p + 1))}
                    disabled={page === totalPages}
                  >
                    <ChevronRight className="w-4 h-4" />
                  </Button>
                </div>
              </div>
            )}
          </>
        )}
      </Card>

      {/* Ban Modal */}
      <Modal
        isOpen={showBanModal}
        onClose={() => { setShowBanModal(false); setSelectedUser(null); setBanReason(''); }}
        title="Ban User"
      >
        {selectedUser && (
          <div>
            <Alert type="warning" className="mb-4">
              You are about to ban <strong>{selectedUser.name}</strong> ({selectedUser.email}).
              This will prevent them from using the platform.
            </Alert>
            <div className="mb-4">
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Reason for ban *
              </label>
              <textarea
                value={banReason}
                onChange={(e) => setBanReason(e.target.value)}
                rows={3}
                className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                placeholder="Enter reason for banning this user..."
              />
            </div>
            <div className="flex gap-3">
              <Button
                variant="secondary"
                onClick={() => { setShowBanModal(false); setSelectedUser(null); }}
                className="flex-1"
              >
                Cancel
              </Button>
              <Button
                onClick={handleBan}
                loading={processing}
                disabled={!banReason.trim()}
                className="flex-1 bg-red-500 hover:bg-red-600"
              >
                Ban User
              </Button>
            </div>
          </div>
        )}
      </Modal>
    </div>
  );
};

export default AdminUsersPage;



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/ClaimDetailPage.tsx
â”‚ Language: TSX | Lines: 350 | Size: 13.9 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { useParams, Link, useNavigate } from 'react-router-dom';
import { 
  ArrowLeft, Shield, CheckCircle, XCircle, Clock, 
  Key, MessageSquare, AlertCircle, Copy, Check
} from 'lucide-react';
import { Button, Card, Badge, LoadingSpinner, Alert, Input, Modal } from '../components/ui';
import { claimsApi, messagesApi, disputeApi } from '../services/api';
import { HandoverOTPPanel } from '../components/HandoverOTPPanel';
import { DisputeForm } from '../components/DisputeForm';
import { SafetyWarningBanner } from '../components/SafetyWarningBanner';
import { ScamReportButton } from '../components/ScamReportButton';
import SafeHandoverLocationPicker from '../components/SafeHandoverLocationPicker';
import { Claim, Message, CATEGORY_INFO, STATUS_INFO } from '../types';
import { useAuthStore } from '../store/authStore';
import { formatDate } from '../utils/dateUtils';
import toast from 'react-hot-toast';

/**
 * ClaimDetailPage - FIXED VERSION
 * 
 * FIX #13: Now uses HandoverOTPPanel component instead of inline OTP logic
 * FIX #13: Now includes DisputeForm component
 * FIX #15: Now includes SafetyWarningBanner
 * FIX #16: Now includes ScamReportButton on messages
 */

const ClaimDetailPage: React.FC = () => {
  const { id } = useParams<{ id: string }>();
  const navigate = useNavigate();
  const { user } = useAuthStore();

  const [claim, setClaim] = useState<Claim | null>(null);
  const [loading, setLoading] = useState(true);
  const [questions, setQuestions] = useState<string[]>([]);
  const [answers, setAnswers] = useState(['', '', '']);
  const [verifying, setVerifying] = useState(false);
  const [verificationResult, setVerificationResult] = useState<{
    verified: boolean;
    correct_count: number;
    attempts_remaining: number;
  } | null>(null);

  // Dispute state
  const [existingDispute, setExistingDispute] = useState<{
    id: number;
    status: string;
    reason: string;
    created_at: string;
  } | null>(null);

  const [messages, setMessages] = useState<Message[]>([]);
  const [newMessage, setNewMessage] = useState('');
  const [sendingMessage, setSendingMessage] = useState(false);

  const isOwner = user?.id === claim?.claimant_id;

  useEffect(() => {
    loadClaim();
  }, [id]);

  useEffect(() => {
    if (claim?.status === 'PENDING' && isOwner) {
      loadQuestions();
    }
    if (claim && ['VERIFIED', 'PENDING'].includes(claim.status)) {
      loadMessages();
    }
    // Load dispute status for relevant claim states
    if (claim && ['PENDING', 'VERIFIED', 'REJECTED'].includes(claim.status)) {
      loadDispute();
    }
  }, [claim, isOwner]);

  const loadClaim = async () => {
    try {
      const response = await claimsApi.getById(parseInt(id!));
      setClaim(response.data.data);
    } catch (error) {
      toast.error('Failed to load claim');
      navigate('/dashboard');
    } finally {
      setLoading(false);
    }
  };

  const loadQuestions = async () => {
    try {
      const response = await claimsApi.getQuestions(parseInt(id!));
      setQuestions(response.data.data.questions || []);
    } catch (error: any) {
      if (error.response?.status === 429) {
        toast.error('Too many verification attempts. Please try again tomorrow.');
      }
    }
  };

  const loadMessages = async () => {
    try {
      const response = await messagesApi.getMessages(parseInt(id!));
      // Backend returns data as array directly (not paginated)
      setMessages(response.data.data || []);
    } catch (error) {
      console.error('Failed to load messages:', error);
    }
  };

  const loadDispute = async () => {
    try {
      const response = await disputeApi.get(parseInt(id!));
      if (response.data.success && response.data.data) {
        setExistingDispute(response.data.data);
      }
    } catch (error: any) {
      // 404 = no dispute, that's fine
      if (error.response?.status !== 404) {
        console.error('Failed to load dispute:', error);
      }
    }
  };

  const handleVerify = async () => {
    if (answers.some((a) => !a.trim())) {
      toast.error('Please answer all questions');
      return;
    }
    setVerifying(true);
    try {
      const response = await claimsApi.verify(parseInt(id!), answers);
      const result = response.data.data;
      setVerificationResult(result);
      if (result.verified) {
        toast.success('Verification successful! You can now proceed to handover.');
        loadClaim();
      } else {
        toast.error(`Verification failed. ${result.correct_count}/3 correct. ${result.attempts_remaining} attempts remaining.`);
      }
    } catch (error: any) {
      toast.error(error.response?.data?.message || 'Verification failed');
    } finally {
      setVerifying(false);
    }
  };

  const sendMessage = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!newMessage.trim()) return;
    setSendingMessage(true);
    try {
      await messagesApi.sendMessage(parseInt(id!), newMessage);
      setNewMessage('');
      loadMessages();
    } catch (error: any) {
      toast.error(error.response?.data?.message || 'Failed to send');
    } finally {
      setSendingMessage(false);
    }
  };

  if (loading) return <div className="flex justify-center py-12"><LoadingSpinner size="lg" /></div>;
  if (!claim) return null;

  const statusInfo = STATUS_INFO[claim.status];

  // Determine the user's role in this claim for the handover panel
  const getUserRole = (): 'owner' | 'finder' | 'coop_staff' => {
    if (user?.role === 'coop_staff') return 'coop_staff';
    if (isOwner) return 'owner';
    return 'finder';
  };

  // Get the other party info for scam reporting
  const getOtherPartyFromMessage = (msg: Message) => {
    return {
      id: msg.sender_id,
      name: msg.sender_name || 'Unknown user',
    };
  };

  return (
    <div className="max-w-4xl mx-auto px-4 py-8">
      <Link to="/dashboard" className="inline-flex items-center text-gray-600 hover:text-gray-900 mb-6">
        <ArrowLeft className="w-4 h-4 mr-2" />Back to Dashboard
      </Link>

      <Card className="p-6 mb-6">
        <div className="flex items-start justify-between mb-4">
          <Badge variant={claim.status === 'VERIFIED' || claim.status === 'RETURNED' ? 'verified' : claim.status === 'PENDING' ? 'pending' : 'expired'}>
            {statusInfo?.label || claim.status}
          </Badge>
          <span className="text-sm text-gray-500">Claim #{claim.id}</span>
        </div>
        <h1 className="text-2xl font-bold text-gray-900 mb-2">{claim.lost_item_title}</h1>
        <p className="text-gray-600">Claiming: {claim.found_item_title}</p>
      </Card>

      <div className="grid md:grid-cols-3 gap-6">
        <div className="md:col-span-2">
          {/* Verification Challenge */}
          {claim.status === 'PENDING' && isOwner && (
            <Card className="p-6 mb-6">
              <div className="flex items-center gap-3 mb-6">
                <Shield className="w-6 h-6 text-primary-500" />
                <h2 className="text-lg font-semibold">Verification Challenge</h2>
              </div>
              {questions.length > 0 ? (
                <div className="space-y-4">
                  {questions.map((q, i) => (
                    <div key={i}>
                      <label className="block text-sm font-medium mb-1">Q{i + 1}: {q}</label>
                      <Input value={answers[i]} onChange={(e) => { const a = [...answers]; a[i] = e.target.value; setAnswers(a); }} placeholder="Your answer" />
                    </div>
                  ))}
                  {verificationResult && (
                    <Alert type={verificationResult.verified ? 'success' : 'error'}>
                      {verificationResult.verified ? <CheckCircle className="w-4 h-4 inline mr-2" /> : <XCircle className="w-4 h-4 inline mr-2" />}
                      {verificationResult.verified 
                        ? 'Verification successful! You can now proceed to handover.'
                        : `${verificationResult.correct_count}/3 correct. ${verificationResult.attempts_remaining} attempts remaining.`}
                    </Alert>
                  )}
                  <Button onClick={handleVerify} loading={verifying} className="w-full">Verify Ownership</Button>
                </div>
              ) : (
                <Alert type="warning"><AlertCircle className="w-4 h-4 inline mr-2" />Cannot load questions. Limit reached?</Alert>
              )}
            </Card>
          )}

          {/* FIX #13: Use the dedicated HandoverOTPPanel component */}
          {claim.status === 'VERIFIED' && (
            <div className="mb-6">
              {/* NOVEL: Safe handover location recommendations */}
              <SafeHandoverLocationPicker
                itemArea={''}
                itemCategory={claim.category || 'OTHER'}
                onSelectLocation={(loc) => console.log('Selected handover location:', loc.name)}
              />
              <div className="mt-4" />
              <HandoverOTPPanel
                claimId={claim.id}
                claimStatus={claim.status}
                userRole={getUserRole()}
                onHandoverComplete={() => loadClaim()}
              />
            </div>
          )}

          {/* Item Returned */}
          {claim.status === 'RETURNED' && (
            <Card className="p-6 mb-6 bg-trust-50 border-trust-200 text-center">
              <CheckCircle className="w-16 h-16 text-trust-500 mx-auto mb-4" />
              <h2 className="text-xl font-bold text-trust-800">Item Returned! ğŸ‰</h2>
            </Card>
          )}

          {/* FIX #15: Safety Warning Banner */}
          {['PENDING', 'VERIFIED'].includes(claim.status) && (
            <SafetyWarningBanner variant="full" />
          )}

          {/* Messages Section */}
          {['PENDING', 'VERIFIED'].includes(claim.status) && (
            <Card className="p-6 mt-6">
              <div className="flex items-center gap-3 mb-4">
                <MessageSquare className="w-5 h-5 text-gray-500" />
                <h2 className="font-semibold">Messages</h2>
              </div>
              <div className="space-y-3 max-h-80 overflow-y-auto mb-4">
                {messages.length === 0 ? (
                  <p className="text-center text-gray-500 py-8">No messages yet</p>
                ) : messages.map((m) => (
                  <div key={m.id} className={`flex ${m.is_mine ? 'justify-end' : 'justify-start'}`}>
                    <div className={`max-w-[80%] ${m.is_mine ? '' : ''}`}>
                      <div className={`p-3 rounded-xl ${m.is_mine ? 'bg-primary-500 text-white' : 'bg-gray-100'}`}>
                        {/* FIX: Show warning on flagged messages */}
                        {m.is_flagged && m.warning && (
                          <p className={`text-xs mb-1 ${m.is_mine ? 'text-primary-200' : 'text-orange-600'}`}>
                            âš ï¸ {m.warning}
                          </p>
                        )}
                        <p className="text-sm">{m.content}</p>
                        <p className={`text-xs mt-1 ${m.is_mine ? 'text-primary-200' : 'text-gray-500'}`}>{formatDate(m.created_at, 'h:mm a')}</p>
                      </div>
                      {/* FIX #16: ScamReportButton on received messages */}
                      {!m.is_mine && (
                        <div className="mt-1 ml-1">
                          <ScamReportButton
                            claimId={claim.id}
                            messageId={m.id}
                            reportedUserId={m.sender_id}
                            reportedUserName={m.sender_name || 'Unknown'}
                            onReportSubmitted={() => toast.success('Report submitted')}
                          />
                        </div>
                      )}
                    </div>
                  </div>
                ))}
              </div>
              <form onSubmit={sendMessage} className="flex gap-2">
                <Input value={newMessage} onChange={(e) => setNewMessage(e.target.value)} placeholder="Type message..." className="flex-1" />
                <Button type="submit" loading={sendingMessage}>Send</Button>
              </form>
            </Card>
          )}

          {/* FIX #13: DisputeForm component integration */}
          {isOwner && ['PENDING', 'VERIFIED', 'REJECTED'].includes(claim.status) && (
            <div className="mt-6">
              <DisputeForm
                claimId={claim.id}
                claimStatus={claim.status}
                existingDispute={existingDispute}
                onDisputeOpened={() => loadDispute()}
              />
            </div>
          )}
        </div>

        {/* Sidebar */}
        <div>
          <Card className="p-6 mb-6">
            <h3 className="font-semibold mb-4">Progress</h3>
            <div className="space-y-4">
              {['Created', 'Verified', 'Returned'].map((s, i) => {
                const done = (i === 0) || (i === 1 && claim.status !== 'PENDING') || (i === 2 && claim.status === 'RETURNED');
                return (
                  <div key={s} className="flex items-center gap-3">
                    <div className={`w-8 h-8 rounded-full flex items-center justify-center ${done ? 'bg-trust-500 text-white' : 'bg-gray-200 text-gray-400'}`}>
                      {done ? <CheckCircle className="w-5 h-5" /> : <Clock className="w-5 h-5" />}
                    </div>
                    <span className={done ? 'font-medium' : 'text-gray-500'}>{s}</span>
                  </div>
                );
              })}
            </div>
          </Card>
          <Card className="p-6">
            <h3 className="font-semibold mb-4">Related</h3>
            <Link to={`/lost-items/${claim.lost_item_id}`} className="block text-sm text-primary-500 hover:underline mb-2">Lost Item â†’</Link>
            <Link to={`/found-items/${claim.found_item_id}`} className="block text-sm text-primary-500 hover:underline">Found Item â†’</Link>
          </Card>
        </div>
      </div>
    </div>
  );
};

export default ClaimDetailPage;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/ContactPage.tsx
â”‚ Language: TSX | Lines: 178 | Size: 9.0 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState } from 'react';
import { Link } from 'react-router-dom';
import { 
  ArrowLeft, Mail, Phone, MapPin, MessageSquare, 
  ChevronDown, ChevronUp, HelpCircle, Send
} from 'lucide-react';
import { Button, Card, Input } from '../components/ui';
import toast from 'react-hot-toast';

interface FaqItem {
  question: string;
  answer: string;
}

const faqs: FaqItem[] = [
  {
    question: 'How do I report a lost item?',
    answer: 'Log in to your account and click "Report Lost Item" from the dashboard or navigation menu. Fill in the category, description, location area, date, and set verification questions that only the true owner would know. These questions are critical for proving ownership later.'
  },
  {
    question: 'How does the matching system work?',
    answer: 'Our algorithm compares your lost item report against all found items using multiple signals: matching categories, location proximity, time correlation, and keyword overlap in descriptions. Matches are scored from 0-13 and ranked so you see the most likely matches first.'
  },
  {
    question: 'What are verification questions?',
    answer: 'When reporting a lost item, you set 3 questions and answers that only the true owner would know â€” like "What is your phone\'s lock screen wallpaper?" or "How many cards are in the wallet?". When someone claims a matching found item, they must answer these correctly to prove ownership.'
  },
  {
    question: 'How does the OTP handover work?',
    answer: 'Once a claim is verified, the item owner generates a 6-digit OTP code from the platform. When meeting the finder for the physical handover, the owner shares this code with the finder who enters it on the platform. This confirms both parties were present and the item was exchanged.'
  },
  {
    question: 'What is the trust score?',
    answer: 'Your trust score starts at 5 and changes based on your behavior. Successfully returning items, completing handovers, and being a good community member increases it. Failed verifications, scam reports against you, and policy violations decrease it. Higher trust scores unlock more features.'
  },
  {
    question: 'How long before my item report expires?',
    answer: 'Lost items with status "Active" and found items with status "Unclaimed" automatically expire after 30 days of no updates. You\'ll receive a warning at 23 days. Pending claims expire after 7 days. You can always create a new report if needed.'
  },
  {
    question: 'What if someone falsely claims my item?',
    answer: 'The verification system protects you â€” claimants must correctly answer your verification questions. If they fail, the claim is rejected. If you believe there\'s an issue with a verified claim, you can open a dispute which will be reviewed by our administrators.'
  },
  {
    question: 'Can cooperatives use the platform?',
    answer: 'Yes! Transport cooperatives are key partners. Cooperative staff can register found items turned in by drivers, and the cooperative accountability leaderboard tracks performance. This creates transparency and incentivizes good behavior across Rwanda\'s transport ecosystem.'
  },
  {
    question: 'Is my personal information safe?',
    answer: 'Yes. Passwords are hashed with bcrypt, verification answers are stored securely, and our system automatically detects and redacts sensitive information like ID numbers and phone numbers from item descriptions. Your contact info is only shared with verified claimants.'
  },
  {
    question: 'Where should I meet for item handover?',
    answer: 'The platform recommends safe handover locations such as police stations, sector offices, and cooperative offices in your area. We strongly recommend using these locations rather than private meeting spots, especially for valuable items.'
  },
];

const ContactPage: React.FC = () => {
  const [openFaq, setOpenFaq] = useState<number | null>(null);
  const [contactForm, setContactForm] = useState({ name: '', email: '', message: '' });

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    if (!contactForm.name || !contactForm.email || !contactForm.message) {
      toast.error('Please fill in all fields');
      return;
    }
    toast.success('Message sent! We\'ll get back to you soon.');
    setContactForm({ name: '', email: '', message: '' });
  };

  return (
    <div className="max-w-5xl mx-auto px-4 py-8 sm:py-12">
      <Link to="/" className="inline-flex items-center text-gray-600 hover:text-gray-900 mb-6">
        <ArrowLeft className="w-4 h-4 mr-2" />Back to Home
      </Link>

      <h1 className="text-2xl sm:text-3xl font-bold text-gray-900 mb-2">Help & Contact</h1>
      <p className="text-gray-600 mb-8">Find answers to common questions or get in touch with us</p>

      <div className="grid lg:grid-cols-3 gap-8">
        {/* FAQ Section */}
        <div className="lg:col-span-2">
          <div className="flex items-center gap-2 mb-6">
            <HelpCircle className="w-5 h-5 text-primary-500" />
            <h2 className="text-xl font-semibold text-gray-900">Frequently Asked Questions</h2>
          </div>

          <div className="space-y-3">
            {faqs.map((faq, index) => (
              <Card key={index} className="overflow-hidden">
                <button
                  onClick={() => setOpenFaq(openFaq === index ? null : index)}
                  className="w-full p-4 flex items-center justify-between text-left hover:bg-gray-50 transition-colors"
                >
                  <span className="font-medium text-gray-900 pr-4">{faq.question}</span>
                  {openFaq === index ? (
                    <ChevronUp className="w-5 h-5 text-gray-400 flex-shrink-0" />
                  ) : (
                    <ChevronDown className="w-5 h-5 text-gray-400 flex-shrink-0" />
                  )}
                </button>
                {openFaq === index && (
                  <div className="px-4 pb-4 text-gray-600 text-sm border-t border-gray-100 pt-3">
                    {faq.answer}
                  </div>
                )}
              </Card>
            ))}
          </div>
        </div>

        {/* Contact Info & Form */}
        <div>
          <Card className="p-6 mb-6">
            <h3 className="font-semibold text-gray-900 mb-4">Contact Info</h3>
            <div className="space-y-3">
              <div className="flex items-center gap-3 text-sm text-gray-600">
                <Mail className="w-4 h-4 text-primary-500" />
                <a href="mailto:support@byaboneka.rw" className="hover:text-primary-500">support@byaboneka.rw</a>
              </div>
              <div className="flex items-center gap-3 text-sm text-gray-600">
                <Phone className="w-4 h-4 text-primary-500" />
                <span>+250 788 000 000</span>
              </div>
              <div className="flex items-center gap-3 text-sm text-gray-600">
                <MapPin className="w-4 h-4 text-primary-500" />
                <span>Kigali, Rwanda</span>
              </div>
            </div>
          </Card>

          <Card className="p-6">
            <div className="flex items-center gap-2 mb-4">
              <MessageSquare className="w-5 h-5 text-primary-500" />
              <h3 className="font-semibold text-gray-900">Send Us a Message</h3>
            </div>
            <form onSubmit={handleSubmit} className="space-y-4">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Name</label>
                <Input
                  value={contactForm.name}
                  onChange={(e) => setContactForm({ ...contactForm, name: e.target.value })}
                  placeholder="Your name"
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Email</label>
                <Input
                  type="email"
                  value={contactForm.email}
                  onChange={(e) => setContactForm({ ...contactForm, email: e.target.value })}
                  placeholder="your@email.com"
                />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Message</label>
                <textarea
                  value={contactForm.message}
                  onChange={(e) => setContactForm({ ...contactForm, message: e.target.value })}
                  placeholder="How can we help?"
                  rows={4}
                  className="w-full px-3 py-2 border border-gray-200 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm resize-none"
                />
              </div>
              <Button type="submit" className="w-full">
                <Send className="w-4 h-4 mr-2" />
                Send Message
              </Button>
            </form>
          </Card>
        </div>
      </div>
    </div>
  );
};

export default ContactPage;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/CoopDashboardPage.tsx
â”‚ Language: TSX | Lines: 177 | Size: 6.0 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { Link } from 'react-router-dom';
import { 
  Package, CheckCircle, Clock, TrendingUp,
  ChevronRight, Plus, Building2
} from 'lucide-react';
import { Button, Card, Badge, LoadingSpinner, EmptyState } from '../components/ui';
import api from '../services/api';
import { CATEGORY_INFO, STATUS_INFO } from '../types';
import { formatDateShort } from '../utils/dateUtils';

interface CoopDashboardData {
  cooperative: {
    id: number;
    name: string;
    registration_number: string;
    status: string;
    contact_info: string;
  };
  stats: {
    total: number;
    unclaimed: number;
    matched: number;
    returned: number;
  };
  recent_items: any[];
}

const CoopDashboardPage: React.FC = () => {
  const [data, setData] = useState<CoopDashboardData | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadDashboard();
  }, []);

  const loadDashboard = async () => {
    try {
      const response = await api.get('/cooperative/dashboard');
      setData(response.data.data);
    } catch (error) {
      console.error('Failed to load dashboard:', error);
    } finally {
      setLoading(false);
    }
  };

  if (loading) {
    return (
      <div className="flex justify-center py-12">
        <LoadingSpinner size="lg" />
      </div>
    );
  }

  if (!data) {
    return (
      <div className="max-w-4xl mx-auto px-4 py-8">
        <Card className="p-12">
          <EmptyState
            icon={<Building2 className="w-16 h-16" />}
            title="Not Assigned to Cooperative"
            description="You are not assigned to any cooperative. Please contact an administrator."
          />
        </Card>
      </div>
    );
  }

  const statCards = [
    { label: 'Total Items', value: data.stats.total, icon: Package, color: 'text-blue-500', bg: 'bg-blue-100' },
    { label: 'Unclaimed', value: data.stats.unclaimed, icon: Clock, color: 'text-orange-500', bg: 'bg-orange-100' },
    { label: 'Matched', value: data.stats.matched, icon: TrendingUp, color: 'text-purple-500', bg: 'bg-purple-100' },
    { label: 'Returned', value: data.stats.returned, icon: CheckCircle, color: 'text-trust-500', bg: 'bg-trust-100' },
  ];

  return (
    <div className="max-w-7xl mx-auto px-4 py-8">
      {/* Header */}
      <div className="mb-8">
        <div className="flex items-center gap-3 mb-2">
          <div className="w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center">
            <Building2 className="w-6 h-6 text-primary-600" />
          </div>
          <div>
            <h1 className="text-2xl font-bold text-gray-900">{data.cooperative.name}</h1>
            <p className="text-gray-500">Reg: {data.cooperative.registration_number}</p>
          </div>
        </div>
      </div>

      {/* Stats */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
        {statCards.map((stat) => (
          <Card key={stat.label} className="p-4">
            <div className={`w-10 h-10 ${stat.bg} rounded-lg flex items-center justify-center mb-3`}>
              <stat.icon className={`w-5 h-5 ${stat.color}`} />
            </div>
            <p className="text-2xl font-bold text-gray-900">{stat.value}</p>
            <p className="text-sm text-gray-500">{stat.label}</p>
          </Card>
        ))}
      </div>

      {/* Quick Actions */}
      <Card className="p-6 mb-8">
        <h2 className="text-lg font-semibold text-gray-900 mb-4">Quick Actions</h2>
        <div className="flex flex-wrap gap-4">
          <Link to="/report-found">
            <Button>
              <Plus className="w-4 h-4 mr-2" />
              Register Found Item
            </Button>
          </Link>
          <Link to="/my-items?tab=found">
            <Button variant="secondary">
              <Package className="w-4 h-4 mr-2" />
              View All Items
            </Button>
          </Link>
        </div>
      </Card>

      {/* Recent Items */}
      <Card className="p-6">
        <div className="flex items-center justify-between mb-4">
          <h2 className="text-lg font-semibold text-gray-900">Recent Found Items</h2>
          <Link to="/my-items?tab=found" className="text-sm text-primary-500 hover:text-primary-600 flex items-center">
            View All <ChevronRight className="w-4 h-4" />
          </Link>
        </div>

        {data.recent_items.length === 0 ? (
          <EmptyState
            icon={<Package className="w-12 h-12" />}
            title="No items yet"
            description="Register found items from drivers to start"
            action={
              <Link to="/report-found">
                <Button size="sm">Register Item</Button>
              </Link>
            }
          />
        ) : (
          <div className="space-y-3">
            {data.recent_items.map((item) => (
              <Link key={item.id} to={`/found-items/${item.id}`}>
                <div className="flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 transition-colors">
                  <div className="flex items-center gap-3">
                    <div className="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center">
                      <span className="text-lg">{CATEGORY_INFO[item.category as keyof typeof CATEGORY_INFO]?.icon || 'ğŸ“¦'}</span>
                    </div>
                    <div>
                      <p className="font-medium text-gray-900">{item.title}</p>
                      <p className="text-sm text-gray-500">
                        {item.location_area} â€¢ {formatDateShort(item.found_date)}
                      </p>
                    </div>
                  </div>
                  <Badge variant={
                    item.status === 'RETURNED' ? 'verified' :
                    item.status === 'MATCHED' ? 'active' : 'pending'
                  }>
                    {STATUS_INFO[item.status]?.label || item.status}
                  </Badge>
                </div>
              </Link>
            ))}
          </div>
        )}
      </Card>
    </div>
  );
};

export default CoopDashboardPage;



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/DashboardPage.tsx
â”‚ Language: TSX | Lines: 319 | Size: 13.4 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useEffect, useState } from 'react';
import { Link } from 'react-router-dom';
import { 
  FileText, Package, MessageSquare, Shield, 
  ArrowRight, CheckCircle, Clock, AlertCircle, TrendingUp
} from 'lucide-react';
import { Card, Badge, LoadingSpinner, EmptyState, Button } from '../components/ui';
import { useAuthStore } from '../store/authStore';
import { lostItemsApi, foundItemsApi, claimsApi, messagesApi } from '../services/api';
import { LostItem, FoundItem, Claim, CATEGORY_INFO, STATUS_INFO, ItemCategory } from '../types';
import { formatDate, formatDateShort } from '../utils/dateUtils';

const DashboardPage: React.FC = () => {
  const { user } = useAuthStore();
  const [loading, setLoading] = useState(true);
  const [stats, setStats] = useState({
    lostItems: 0,
    foundItems: 0,
    activeClaims: 0,
    unreadMessages: 0
  });
  const [recentLostItems, setRecentLostItems] = useState<LostItem[]>([]);
  const [recentFoundItems, setRecentFoundItems] = useState<FoundItem[]>([]);
  const [recentClaims, setRecentClaims] = useState<Claim[]>([]);

  useEffect(() => {
    loadDashboardData();
  }, []);

  const loadDashboardData = async () => {
    try {
      const [lostRes, foundRes, claimsRes, unreadRes] = await Promise.all([
        lostItemsApi.getMine({ limit: 3 }).catch(() => ({ data: { data: [], pagination: { total: 0 } } })),
        foundItemsApi.getMine({ limit: 3 }).catch(() => ({ data: { data: [], pagination: { total: 0 } } })),
        claimsApi.getMine({ limit: 5 }).catch(() => ({ data: { data: [] } })),
        messagesApi.getUnreadCount().catch(() => ({ data: { data: { count: 0 } } }))
      ]);

      setRecentLostItems(lostRes.data.data || []);
      setRecentFoundItems(foundRes.data.data || []);
      setRecentClaims(claimsRes.data.data || []);

      // Handle both API response formats
      const unreadData = unreadRes.data.data as any;
      const unreadCount = unreadData?.count ?? unreadData?.unread_count ?? 0;

      setStats({
        lostItems: lostRes.data.pagination?.total || 0,
        foundItems: foundRes.data.pagination?.total || 0,
        activeClaims: (claimsRes.data.data || []).filter((c: Claim) => ['PENDING', 'VERIFIED'].includes(c.status)).length,
        unreadMessages: unreadCount
      });
    } catch (error) {
      console.error('Failed to load dashboard data:', error);
    } finally {
      setLoading(false);
    }
  };

  const getStatusBadge = (status: string) => {
    const info = STATUS_INFO[status] || { label: status, color: 'gray' };
    const variantMap: Record<string, 'active' | 'verified' | 'pending' | 'expired' | 'danger'> = {
      blue: 'active',
      green: 'verified',
      yellow: 'pending',
      gray: 'expired',
      red: 'danger'
    };
    return <Badge variant={variantMap[info.color] || 'default'}>{info.label}</Badge>;
  };

  const getTrustLevel = (score: number) => {
    if (score >= 10) return { level: 'High', color: 'text-trust-600', bg: 'bg-trust-50' };
    if (score >= 5) return { level: 'Medium', color: 'text-blue-600', bg: 'bg-blue-50' };
    if (score >= 0) return { level: 'New', color: 'text-gray-600', bg: 'bg-gray-50' };
    return { level: 'Low', color: 'text-red-600', bg: 'bg-red-50' };
  };

  if (loading) {
    return (
      <div className="flex items-center justify-center min-h-[60vh]">
        <LoadingSpinner size="lg" />
      </div>
    );
  }

  const trustInfo = getTrustLevel(user?.trust_score || 0);

  return (
    <div className="max-w-7xl mx-auto px-4 py-6 sm:py-8">
      {/* Welcome Header */}
      <div className="mb-6 sm:mb-8">
        <h1 className="text-2xl sm:text-3xl font-bold text-gray-900 mb-2">
          Welcome back, {user?.name?.split(' ')[0]}!
        </h1>
        <p className="text-gray-600">Here's what's happening with your items</p>
      </div>

      {/* Stats Cards */}
      <div className="grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 mb-6 sm:mb-8">
        <Card className="p-4 sm:p-6">
          <div className="flex items-center gap-3 sm:gap-4">
            <div className="w-10 h-10 sm:w-12 sm:h-12 bg-accent-100 rounded-xl flex items-center justify-center flex-shrink-0">
              <FileText className="w-5 h-5 sm:w-6 sm:h-6 text-accent-600" />
            </div>
            <div className="min-w-0">
              <p className="text-xl sm:text-2xl font-bold text-gray-900">{stats.lostItems}</p>
              <p className="text-xs sm:text-sm text-gray-500 truncate">Lost Reports</p>
            </div>
          </div>
        </Card>

        <Card className="p-4 sm:p-6">
          <div className="flex items-center gap-3 sm:gap-4">
            <div className="w-10 h-10 sm:w-12 sm:h-12 bg-trust-100 rounded-xl flex items-center justify-center flex-shrink-0">
              <Package className="w-5 h-5 sm:w-6 sm:h-6 text-trust-600" />
            </div>
            <div className="min-w-0">
              <p className="text-xl sm:text-2xl font-bold text-gray-900">{stats.foundItems}</p>
              <p className="text-xs sm:text-sm text-gray-500 truncate">Found Items</p>
            </div>
          </div>
        </Card>

        <Card className="p-4 sm:p-6">
          <div className="flex items-center gap-3 sm:gap-4">
            <div className="w-10 h-10 sm:w-12 sm:h-12 bg-yellow-100 rounded-xl flex items-center justify-center flex-shrink-0">
              <Clock className="w-5 h-5 sm:w-6 sm:h-6 text-yellow-600" />
            </div>
            <div className="min-w-0">
              <p className="text-xl sm:text-2xl font-bold text-gray-900">{stats.activeClaims}</p>
              <p className="text-xs sm:text-sm text-gray-500 truncate">Active Claims</p>
            </div>
          </div>
        </Card>

        <Card className="p-4 sm:p-6">
          <div className="flex items-center gap-3 sm:gap-4">
            <div className="w-10 h-10 sm:w-12 sm:h-12 bg-purple-100 rounded-xl flex items-center justify-center flex-shrink-0">
              <MessageSquare className="w-5 h-5 sm:w-6 sm:h-6 text-purple-600" />
            </div>
            <div className="min-w-0">
              <p className="text-xl sm:text-2xl font-bold text-gray-900">{stats.unreadMessages}</p>
              <p className="text-xs sm:text-sm text-gray-500 truncate">Unread Messages</p>
            </div>
          </div>
        </Card>
      </div>

      {/* Trust Score Card */}
      <Card className={`p-4 sm:p-6 mb-6 sm:mb-8 ${trustInfo.bg} border-0`}>
        <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
          <div className="flex items-center gap-4">
            <div className="w-14 h-14 sm:w-16 sm:h-16 bg-white rounded-2xl flex items-center justify-center shadow-sm">
              <Shield className={`w-7 h-7 sm:w-8 sm:h-8 ${trustInfo.color}`} />
            </div>
            <div>
              <div className="flex items-center gap-2">
                <h2 className="text-xl sm:text-2xl font-bold text-gray-900">
                  {user?.trust_score || 0}
                </h2>
                <Badge variant={trustInfo.level === 'High' ? 'verified' : trustInfo.level === 'Medium' ? 'active' : 'default'}>
                  {trustInfo.level} Trust
                </Badge>
              </div>
              <p className="text-gray-600 text-sm sm:text-base">Your trust score</p>
            </div>
          </div>
          <div className="text-left sm:text-right">
            <p className="text-sm text-gray-600 mb-2">Build trust by:</p>
            <ul className="text-sm space-y-1">
              <li className="flex items-center gap-1">
                <CheckCircle className="w-4 h-4 text-trust-500" /> Returning found items
              </li>
              <li className="flex items-center gap-1">
                <CheckCircle className="w-4 h-4 text-trust-500" /> Successful recoveries
              </li>
            </ul>
          </div>
        </div>
      </Card>

      {/* Quick Actions */}
      <div className="grid sm:grid-cols-2 gap-4 mb-6 sm:mb-8">
        <Link to="/report-lost">
          <Card hover className="p-4 sm:p-6 flex items-center justify-between h-full">
            <div className="flex items-center gap-3 sm:gap-4">
              <div className="w-10 h-10 sm:w-12 sm:h-12 bg-accent-100 rounded-xl flex items-center justify-center flex-shrink-0">
                <FileText className="w-5 h-5 sm:w-6 sm:h-6 text-accent-600" />
              </div>
              <div>
                <h3 className="font-semibold text-gray-900">Report Lost Item</h3>
                <p className="text-sm text-gray-500 hidden sm:block">Lost something? Report it now</p>
              </div>
            </div>
            <ArrowRight className="w-5 h-5 text-gray-400" />
          </Card>
        </Link>

        <Link to="/report-found">
          <Card hover className="p-4 sm:p-6 flex items-center justify-between h-full">
            <div className="flex items-center gap-3 sm:gap-4">
              <div className="w-10 h-10 sm:w-12 sm:h-12 bg-trust-100 rounded-xl flex items-center justify-center flex-shrink-0">
                <Package className="w-5 h-5 sm:w-6 sm:h-6 text-trust-600" />
              </div>
              <div>
                <h3 className="font-semibold text-gray-900">Report Found Item</h3>
                <p className="text-sm text-gray-500 hidden sm:block">Found something? Help return it</p>
              </div>
            </div>
            <ArrowRight className="w-5 h-5 text-gray-400" />
          </Card>
        </Link>
      </div>

      {/* Recent Activity */}
      <div className="grid lg:grid-cols-2 gap-6 sm:gap-8">
        {/* Recent Lost Items */}
        <div>
          <div className="flex items-center justify-between mb-4">
            <h2 className="text-lg font-semibold text-gray-900">Your Lost Items</h2>
            <Link to="/my-items?tab=lost" className="text-sm text-primary-500 hover:text-primary-600">
              View all
            </Link>
          </div>
          {recentLostItems.length > 0 ? (
            <div className="space-y-3">
              {recentLostItems.map((item) => (
                <Link key={item.id} to={`/lost-items/${item.id}`}>
                  <Card hover className="p-4">
                    <div className="flex items-center justify-between gap-3">
                      <div className="flex items-center gap-3 min-w-0">
                        <span className="text-2xl flex-shrink-0">
                          {CATEGORY_INFO[item.category as ItemCategory]?.icon || 'ğŸ“¦'}
                        </span>
                        <div className="min-w-0">
                          <p className="font-medium text-gray-900 truncate">{item.title}</p>
                          <p className="text-sm text-gray-500 truncate">
                            {item.location_area} â€¢ {formatDateShort(item.lost_date)}
                          </p>
                        </div>
                      </div>
                      {getStatusBadge(item.status)}
                    </div>
                  </Card>
                </Link>
              ))}
            </div>
          ) : (
            <Card className="p-8 text-center">
              <EmptyState
                icon={<FileText className="w-12 h-12" />}
                title="No lost items"
                description="Report a lost item to get started"
                action={
                  <Link to="/report-lost">
                    <Button size="sm">Report Lost Item</Button>
                  </Link>
                }
              />
            </Card>
          )}
        </div>

        {/* Recent Claims */}
        <div>
          <div className="flex items-center justify-between mb-4">
            <h2 className="text-lg font-semibold text-gray-900">Your Claims</h2>
            <Link to="/my-items?tab=claims" className="text-sm text-primary-500 hover:text-primary-600">
              View all
            </Link>
          </div>
          {recentClaims.length > 0 ? (
            <div className="space-y-3">
              {recentClaims.map((claim) => (
                <Link key={claim.id} to={`/claims/${claim.id}`}>
                  <Card hover className="p-4">
                    <div className="flex items-center justify-between gap-3">
                      <div className="flex items-center gap-3 min-w-0">
                        <span className="text-2xl flex-shrink-0">
                          {CATEGORY_INFO[claim.category as ItemCategory]?.icon || 'ğŸ“¦'}
                        </span>
                        <div className="min-w-0">
                          <p className="font-medium text-gray-900 truncate">
                            {claim.lost_item_title || claim.found_item_title || `Claim #${claim.id}`}
                          </p>
                          <p className="text-sm text-gray-500">
                            {formatDateShort(claim.created_at)}
                          </p>
                        </div>
                      </div>
                      {getStatusBadge(claim.status)}
                    </div>
                  </Card>
                </Link>
              ))}
            </div>
          ) : (
            <Card className="p-8 text-center">
              <EmptyState
                icon={<CheckCircle className="w-12 h-12" />}
                title="No claims"
                description="Find a matching item to make a claim"
                action={
                  <Link to="/search">
                    <Button size="sm">Search Items</Button>
                  </Link>
                }
              />
            </Card>
          )}
        </div>
      </div>
    </div>
  );
};

export default DashboardPage;



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/EditFoundItemPage.tsx
â”‚ Language: TSX | Lines: 273 | Size: 9.7 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { useParams, useNavigate } from 'react-router-dom';
import {
  ArrowLeft, Save, MapPin, Calendar,
  Smartphone, CreditCard, Wallet, Briefcase, Key, Package
} from 'lucide-react';
import { Button, Card, Input, Textarea, LoadingSpinner, Alert } from '../components/ui';
import { foundItemsApi } from '../services/api';
import { FoundItem, ItemCategory, CATEGORY_INFO, RWANDA_LOCATIONS } from '../types';
import { useAuthStore } from '../store/authStore';
import toast from 'react-hot-toast';

const CATEGORY_ICONS: Record<ItemCategory, React.ReactNode> = {
  [ItemCategory.PHONE]: <Smartphone className="w-6 h-6" />,
  [ItemCategory.ID]: <CreditCard className="w-6 h-6" />,
  [ItemCategory.WALLET]: <Wallet className="w-6 h-6" />,
  [ItemCategory.BAG]: <Briefcase className="w-6 h-6" />,
  [ItemCategory.KEYS]: <Key className="w-6 h-6" />,
  [ItemCategory.OTHER]: <Package className="w-6 h-6" />,
};

const EditFoundItemPage: React.FC = () => {
  const { id } = useParams<{ id: string }>();
  const navigate = useNavigate();
  const { user } = useAuthStore();

  const [item, setItem] = useState<FoundItem | null>(null);
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  const [errors, setErrors] = useState<Record<string, string>>({});

  const [formData, setFormData] = useState({
    title: '',
    description: '',
    location_area: '',
    location_hint: '',
  });

  useEffect(() => {
    loadItem();
  }, [id]);

  const loadItem = async () => {
    try {
      const response = await foundItemsApi.getById(parseInt(id!));
      const data = response.data.data;

      // Only allow owner to edit
      if (data.user_id !== user?.id) {
        toast.error('You can only edit your own items');
        navigate(`/found-items/${id}`);
        return;
      }

      setItem(data);
      setFormData({
        title: data.title || '',
        description: data.description || '',
        location_area: data.location_area || '',
        location_hint: data.location_hint || '',
      });
    } catch (error) {
      toast.error('Failed to load item');
      navigate('/my-items?tab=found');
    } finally {
      setLoading(false);
    }
  };

  const validate = (): boolean => {
    const newErrors: Record<string, string> = {};
    if (!formData.title || formData.title.length < 3) {
      newErrors.title = 'Title must be at least 3 characters';
    }
    if (!formData.description || formData.description.length < 10) {
      newErrors.description = 'Description must be at least 10 characters';
    }
    if (!formData.location_area) {
      newErrors.location_area = 'Please select a location';
    }
    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!validate()) return;

    setSaving(true);
    try {
      await foundItemsApi.update(parseInt(id!), {
        title: formData.title,
        description: formData.description,
        location_area: formData.location_area,
        location_hint: formData.location_hint || undefined,
      });
      toast.success('Item updated successfully');
      navigate(`/found-items/${id}`);
    } catch (error: any) {
      toast.error(error.response?.data?.message || 'Failed to update item');
    } finally {
      setSaving(false);
    }
  };

  if (loading) {
    return (
      <div className="flex justify-center py-12">
        <LoadingSpinner size="lg" />
      </div>
    );
  }

  if (!item) {
    return (
      <div className="max-w-2xl mx-auto px-4 py-12 text-center">
        <h1 className="text-2xl font-bold text-gray-900 mb-4">Item Not Found</h1>
        <Button onClick={() => navigate('/my-items?tab=found')}>Back to My Items</Button>
      </div>
    );
  }

  const categoryInfo = CATEGORY_INFO[item.category as ItemCategory];

  return (
    <div className="max-w-2xl mx-auto px-4 py-8">
      {/* Back Link */}
      <button
        onClick={() => navigate(`/found-items/${id}`)}
        className="inline-flex items-center text-gray-600 hover:text-gray-900 mb-6"
      >
        <ArrowLeft className="w-4 h-4 mr-2" />
        Back to Item
      </button>

      <div className="mb-8">
        <h1 className="text-2xl font-bold text-gray-900 mb-2">Edit Found Item</h1>
        <p className="text-gray-600">Update the details of your found item report</p>
      </div>

      {item.status !== 'AVAILABLE' && (
        <Alert type="warning" className="mb-6">
          This item is currently <strong>{item.status.toLowerCase()}</strong>. Some fields may not be editable.
        </Alert>
      )}

      <form onSubmit={handleSubmit}>
        <Card className="p-6 mb-6">
          {/* Category (read-only) */}
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-2">Category</label>
            <div className="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
              <span className="text-gray-500">
                {CATEGORY_ICONS[item.category as ItemCategory]}
              </span>
              <span className="font-medium text-gray-700">{categoryInfo?.label || item.category}</span>
              <span className="text-xs text-gray-400 ml-auto">Cannot be changed</span>
            </div>
          </div>

          {/* Title */}
          <div className="mb-6">
            <Input
              label="Title *"
              value={formData.title}
              onChange={(e) => setFormData({ ...formData, title: e.target.value })}
              placeholder="e.g., Black phone found at bus station"
              error={errors.title}
            />
          </div>

          {/* Description */}
          <div className="mb-6">
            <Textarea
              label="Description *"
              value={formData.description}
              onChange={(e) => setFormData({ ...formData, description: e.target.value })}
              placeholder="Describe the found item in detail..."
              rows={4}
              error={errors.description}
            />
          </div>

          {/* Location */}
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-1">
              <MapPin className="w-4 h-4 inline mr-1" />
              Location Area *
            </label>
            <select
              value={formData.location_area}
              onChange={(e) => setFormData({ ...formData, location_area: e.target.value })}
              className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ${
                errors.location_area ? 'border-red-500' : 'border-gray-300'
              }`}
            >
              <option value="">Select location</option>
              {RWANDA_LOCATIONS.map((loc) => (
                <option key={loc} value={loc}>{loc}</option>
              ))}
            </select>
            {errors.location_area && (
              <p className="mt-1 text-sm text-red-500">{errors.location_area}</p>
            )}
          </div>

          {/* Location Hint */}
          <div className="mb-6">
            <Textarea
              label="Specific Location (Optional)"
              value={formData.location_hint}
              onChange={(e) => setFormData({ ...formData, location_hint: e.target.value })}
              placeholder="e.g., Under seat 23 on bus KM-456-A, near the market entrance..."
              rows={2}
            />
          </div>

          {/* Date (read-only) */}
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-1">
              <Calendar className="w-4 h-4 inline mr-1" />
              Date Found
            </label>
            <input
              type="date"
              value={item.found_date?.split('T')[0] || ''}
              disabled
              className="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500"
            />
            <p className="text-xs text-gray-400 mt-1">Date cannot be changed after submission</p>
          </div>

          {/* Images (read-only info) */}
          {item.image_urls && item.image_urls.length > 0 && (
            <div className="mb-6">
              <label className="block text-sm font-medium text-gray-700 mb-2">Current Photos</label>
              <div className="grid grid-cols-4 gap-3">
                {item.image_urls.map((url, index) => (
                  <div key={index} className="aspect-square rounded-lg overflow-hidden bg-gray-100">
                    <img
                      src={url}
                      alt={`Photo ${index + 1}`}
                      className="w-full h-full object-cover"
                      onError={(e) => {
                        (e.target as HTMLImageElement).style.display = 'none';
                      }}
                    />
                  </div>
                ))}
              </div>
              <p className="text-xs text-gray-400 mt-1">
                To update photos, please delete and re-report the item
              </p>
            </div>
          )}
        </Card>

        {/* Actions */}
        <div className="flex justify-between">
          <Button type="button" variant="secondary" onClick={() => navigate(`/found-items/${id}`)}>
            Cancel
          </Button>
          <Button type="submit" loading={saving}>
            <Save className="w-4 h-4 mr-2" />
            Save Changes
          </Button>
        </div>
      </form>
    </div>
  );
};

export default EditFoundItemPage;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/EditLostItemPage.tsx
â”‚ Language: TSX | Lines: 249 | Size: 8.6 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { useParams, useNavigate } from 'react-router-dom';
import {
  ArrowLeft, Save, MapPin, Calendar,
  Smartphone, CreditCard, Wallet, Briefcase, Key, Package
} from 'lucide-react';
import { Button, Card, Input, Textarea, LoadingSpinner, Alert } from '../components/ui';
import { lostItemsApi } from '../services/api';
import { LostItem, ItemCategory, CATEGORY_INFO, RWANDA_LOCATIONS } from '../types';
import { useAuthStore } from '../store/authStore';
import toast from 'react-hot-toast';

const CATEGORY_ICONS: Record<ItemCategory, React.ReactNode> = {
  [ItemCategory.PHONE]: <Smartphone className="w-6 h-6" />,
  [ItemCategory.ID]: <CreditCard className="w-6 h-6" />,
  [ItemCategory.WALLET]: <Wallet className="w-6 h-6" />,
  [ItemCategory.BAG]: <Briefcase className="w-6 h-6" />,
  [ItemCategory.KEYS]: <Key className="w-6 h-6" />,
  [ItemCategory.OTHER]: <Package className="w-6 h-6" />,
};

const EditLostItemPage: React.FC = () => {
  const { id } = useParams<{ id: string }>();
  const navigate = useNavigate();
  const { user } = useAuthStore();

  const [item, setItem] = useState<LostItem | null>(null);
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  const [errors, setErrors] = useState<Record<string, string>>({});

  const [formData, setFormData] = useState({
    title: '',
    description: '',
    location_area: '',
    location_hint: '',
  });

  useEffect(() => {
    loadItem();
  }, [id]);

  const loadItem = async () => {
    try {
      const response = await lostItemsApi.getById(parseInt(id!));
      const data = response.data.data;

      // Only allow owner to edit
      if (data.user_id !== user?.id) {
        toast.error('You can only edit your own items');
        navigate(`/lost-items/${id}`);
        return;
      }

      setItem(data);
      setFormData({
        title: data.title || '',
        description: data.description || '',
        location_area: data.location_area || '',
        location_hint: data.location_hint || '',
      });
    } catch (error) {
      toast.error('Failed to load item');
      navigate('/my-items');
    } finally {
      setLoading(false);
    }
  };

  const validate = (): boolean => {
    const newErrors: Record<string, string> = {};
    if (!formData.title || formData.title.length < 3) {
      newErrors.title = 'Title must be at least 3 characters';
    }
    if (!formData.description || formData.description.length < 10) {
      newErrors.description = 'Description must be at least 10 characters';
    }
    if (!formData.location_area) {
      newErrors.location_area = 'Please select a location';
    }
    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!validate()) return;

    setSaving(true);
    try {
      await lostItemsApi.update(parseInt(id!), {
        title: formData.title,
        description: formData.description,
        location_area: formData.location_area,
        location_hint: formData.location_hint || undefined,
      });
      toast.success('Item updated successfully');
      navigate(`/lost-items/${id}`);
    } catch (error: any) {
      toast.error(error.response?.data?.message || 'Failed to update item');
    } finally {
      setSaving(false);
    }
  };

  if (loading) {
    return (
      <div className="flex justify-center py-12">
        <LoadingSpinner size="lg" />
      </div>
    );
  }

  if (!item) {
    return (
      <div className="max-w-2xl mx-auto px-4 py-12 text-center">
        <h1 className="text-2xl font-bold text-gray-900 mb-4">Item Not Found</h1>
        <Button onClick={() => navigate('/my-items')}>Back to My Items</Button>
      </div>
    );
  }

  const categoryInfo = CATEGORY_INFO[item.category as ItemCategory];

  return (
    <div className="max-w-2xl mx-auto px-4 py-8">
      {/* Back Link */}
      <button
        onClick={() => navigate(`/lost-items/${id}`)}
        className="inline-flex items-center text-gray-600 hover:text-gray-900 mb-6"
      >
        <ArrowLeft className="w-4 h-4 mr-2" />
        Back to Item
      </button>

      <div className="mb-8">
        <h1 className="text-2xl font-bold text-gray-900 mb-2">Edit Lost Item</h1>
        <p className="text-gray-600">Update the details of your lost item report</p>
      </div>

      {item.status !== 'ACTIVE' && (
        <Alert type="warning" className="mb-6">
          This item is currently <strong>{item.status.toLowerCase()}</strong>. Some fields may not be editable.
        </Alert>
      )}

      <form onSubmit={handleSubmit}>
        <Card className="p-6 mb-6">
          {/* Category (read-only) */}
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-2">Category</label>
            <div className="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
              <span className="text-gray-500">
                {CATEGORY_ICONS[item.category as ItemCategory]}
              </span>
              <span className="font-medium text-gray-700">{categoryInfo?.label || item.category}</span>
              <span className="text-xs text-gray-400 ml-auto">Cannot be changed</span>
            </div>
          </div>

          {/* Title */}
          <div className="mb-6">
            <Input
              label="Title *"
              value={formData.title}
              onChange={(e) => setFormData({ ...formData, title: e.target.value })}
              placeholder="e.g., Black iPhone 13 Pro with blue case"
              error={errors.title}
            />
          </div>

          {/* Description */}
          <div className="mb-6">
            <Textarea
              label="Description *"
              value={formData.description}
              onChange={(e) => setFormData({ ...formData, description: e.target.value })}
              placeholder="Describe your item in detail..."
              rows={4}
              error={errors.description}
            />
          </div>

          {/* Location */}
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-1">
              <MapPin className="w-4 h-4 inline mr-1" />
              Location Area *
            </label>
            <select
              value={formData.location_area}
              onChange={(e) => setFormData({ ...formData, location_area: e.target.value })}
              className={`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 ${
                errors.location_area ? 'border-red-500' : 'border-gray-300'
              }`}
            >
              <option value="">Select location</option>
              {RWANDA_LOCATIONS.map((loc) => (
                <option key={loc} value={loc}>{loc}</option>
              ))}
            </select>
            {errors.location_area && (
              <p className="mt-1 text-sm text-red-500">{errors.location_area}</p>
            )}
          </div>

          {/* Location Hint */}
          <div className="mb-6">
            <Textarea
              label="Location Details (Optional)"
              value={formData.location_hint}
              onChange={(e) => setFormData({ ...formData, location_hint: e.target.value })}
              placeholder="e.g., Near the main bus station, inside a moto taxi..."
              rows={2}
            />
          </div>

          {/* Date (read-only) */}
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-1">
              <Calendar className="w-4 h-4 inline mr-1" />
              Date Lost
            </label>
            <input
              type="date"
              value={item.lost_date?.split('T')[0] || ''}
              disabled
              className="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500"
            />
            <p className="text-xs text-gray-400 mt-1">Date cannot be changed after submission</p>
          </div>
        </Card>

        {/* Actions */}
        <div className="flex justify-between">
          <Button type="button" variant="secondary" onClick={() => navigate(`/lost-items/${id}`)}>
            Cancel
          </Button>
          <Button type="submit" loading={saving}>
            <Save className="w-4 h-4 mr-2" />
            Save Changes
          </Button>
        </div>
      </form>
    </div>
  );
};

export default EditLostItemPage;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/ForgotPasswordPage.tsx
â”‚ Language: TSX | Lines: 101 | Size: 3.4 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState } from 'react';
import { Link } from 'react-router-dom';
import { Mail, ArrowLeft, CheckCircle } from 'lucide-react';
import { Button, Card, Input, Alert } from '../components/ui';
import { authApi } from '../services/api';
import toast from 'react-hot-toast';

const ForgotPasswordPage: React.FC = () => {
  const [email, setEmail] = useState('');
  const [loading, setLoading] = useState(false);
  const [sent, setSent] = useState(false);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!email.trim()) {
      toast.error('Please enter your email');
      return;
    }

    setLoading(true);
    try {
      await authApi.forgotPassword(email);
      setSent(true);
    } catch (error: any) {
      // Don't reveal if email exists or not for security
      setSent(true);
    } finally {
      setLoading(false);
    }
  };

  if (sent) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gray-50 px-4">
        <Card className="w-full max-w-md p-8 text-center">
          <div className="w-16 h-16 bg-trust-100 rounded-full flex items-center justify-center mx-auto mb-6">
            <CheckCircle className="w-8 h-8 text-trust-500" />
          </div>
          <h1 className="text-2xl font-bold text-gray-900 mb-2">Check Your Email</h1>
          <p className="text-gray-600 mb-6">
            If an account exists for <strong>{email}</strong>, you will receive a password reset link shortly.
          </p>
          <Alert type="info" className="mb-6 text-left text-sm">
            The link will expire in 1 hour. Check your spam folder if you don't see it.
          </Alert>
          <Link to="/login">
            <Button variant="secondary" className="w-full">
              <ArrowLeft className="w-4 h-4 mr-2" />
              Back to Login
            </Button>
          </Link>
        </Card>
      </div>
    );
  }

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-50 px-4">
      <Card className="w-full max-w-md p-8">
        <div className="text-center mb-8">
          <div className="w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <Mail className="w-8 h-8 text-primary-500" />
          </div>
          <h1 className="text-2xl font-bold text-gray-900 mb-2">Forgot Password?</h1>
          <p className="text-gray-600">
            Enter your email address and we'll send you a link to reset your password.
          </p>
        </div>

        <form onSubmit={handleSubmit} className="space-y-6">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              Email Address
            </label>
            <Input
              type="email"
              value={email}
              onChange={(e) => setEmail(e.target.value)}
              placeholder="you@example.com"
              required
            />
          </div>

          <Button type="submit" loading={loading} className="w-full">
            Send Reset Link
          </Button>
        </form>

        <div className="mt-6 text-center">
          <Link to="/login" className="text-sm text-primary-500 hover:text-primary-600">
            <ArrowLeft className="w-4 h-4 inline mr-1" />
            Back to Login
          </Link>
        </div>
      </Card>
    </div>
  );
};

export default ForgotPasswordPage;



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/FoundItemDetailPage.tsx
â”‚ Language: TSX | Lines: 406 | Size: 16.1 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { useParams, Link, useNavigate } from 'react-router-dom';
import { 
  MapPin, Calendar, User, ArrowLeft, Edit, Trash2, Building,
  ChevronLeft, ChevronRight, Shield, Clock
} from 'lucide-react';
import { Button, Card, Badge, LoadingSpinner, Alert, Modal } from '../components/ui';
import { foundItemsApi } from '../services/api';
import { FoundItem, LostItem, CATEGORY_INFO, STATUS_INFO } from '../types';
import { useAuthStore } from '../store/authStore';
import { formatDate, formatDateShort, formatDateLong, formatDateTime } from '../utils/dateUtils';
import toast from 'react-hot-toast';

interface MatchResult {
  lost_item: LostItem;
  score: number;
  explanation: string[];
}

// Helper function to map match scores to valid badge variants
const getMatchScoreBadgeVariant = (score: number): "verified" | "pending" | "default" => {
  if (score >= 8) return "verified"; // High confidence
  if (score >= 5) return "pending"; // Medium confidence
  return "default"; // Low confidence
};

const FoundItemDetailPage: React.FC = () => {
  const { id } = useParams<{ id: string }>();
  const navigate = useNavigate();
  const { user } = useAuthStore();

  const [item, setItem] = useState<FoundItem | null>(null);
  const [loading, setLoading] = useState(true);
  const [currentImageIndex, setCurrentImageIndex] = useState(0);
  const [showDeleteModal, setShowDeleteModal] = useState(false);
  const [deleting, setDeleting] = useState(false);

  // Matches state
  const [matches, setMatches] = useState<MatchResult[]>([]);
  const [matchesLoading, setMatchesLoading] = useState(false);

  const isFinder = user?.id === item?.finder_id;

  useEffect(() => {
    loadItem();
  }, [id]);

  const loadItem = async () => {
    try {
      const response = await foundItemsApi.getById(parseInt(id!));
      setItem(response.data.data);
    } catch (error) {
      toast.error('Failed to load item');
      navigate('/search?type=found');
    } finally {
      setLoading(false);
    }
  };

  const loadMatches = async () => {
    if (!id) return;
    setMatchesLoading(true);
    try {
      const response = await foundItemsApi.getMatches(parseInt(id));
      setMatches(response.data.data || []);
    } catch (error) {
      console.error('Failed to load matches:', error);
    } finally {
      setMatchesLoading(false);
    }
  };

  const handleDelete = async () => {
    setDeleting(true);
    try {
      await foundItemsApi.delete(parseInt(id!));
      toast.success('Item deleted successfully');
      navigate('/my-items');
    } catch (error: any) {
      toast.error(error.response?.data?.message || 'Failed to delete item');
    } finally {
      setDeleting(false);
      setShowDeleteModal(false);
    }
  };

  const nextImage = () => {
    if (item?.image_urls) {
      setCurrentImageIndex((prev) => (prev + 1) % item.image_urls.length);
    }
  };

  const prevImage = () => {
    if (item?.image_urls) {
      setCurrentImageIndex((prev) => (prev - 1 + item.image_urls.length) % item.image_urls.length);
    }
  };

  if (loading) {
    return (
      <div className="flex justify-center py-12">
        <LoadingSpinner size="lg" />
      </div>
    );
  }

  if (!item) {
    return (
      <div className="max-w-2xl mx-auto px-4 py-12 text-center">
        <h1 className="text-2xl font-bold text-gray-900 mb-4">Item Not Found</h1>
        <Link to="/search">
          <Button>Back to Search</Button>
        </Link>
      </div>
    );
  }

  const statusInfo = STATUS_INFO[item.status];
  const categoryInfo = CATEGORY_INFO[item.category];
  const apiBase = import.meta.env.VITE_API_URL?.replace('/api/v1', '') || 'http://localhost:4000';

  return (
    <div className="max-w-4xl mx-auto px-4 py-8">
      {/* Back Link */}
      <Link 
        to="/search?type=found" 
        className="inline-flex items-center text-gray-600 hover:text-gray-900 mb-6"
      >
        <ArrowLeft className="w-4 h-4 mr-2" />
        Back to Search
      </Link>

      <div className="grid md:grid-cols-3 gap-8">
        {/* Main Content */}
        <div className="md:col-span-2">
          {/* Image Gallery */}
          {item.image_urls && item.image_urls.length > 0 && (
            <Card className="mb-6 overflow-hidden">
              <div className="relative aspect-video bg-gray-100">
                <img
                  src={`${apiBase}${item.image_urls[currentImageIndex]}`}
                  alt={item.title}
                  className="w-full h-full object-contain"
                  onError={(e) => {
                    (e.target as HTMLImageElement).src = '/placeholder.png';
                  }}
                />
                
                {item.image_urls.length > 1 && (
                  <>
                    <button
                      onClick={prevImage}
                      className="absolute left-2 top-1/2 -translate-y-1/2 p-2 bg-black/50 text-white rounded-full hover:bg-black/70"
                    >
                      <ChevronLeft className="w-6 h-6" />
                    </button>
                    <button
                      onClick={nextImage}
                      className="absolute right-2 top-1/2 -translate-y-1/2 p-2 bg-black/50 text-white rounded-full hover:bg-black/70"
                    >
                      <ChevronRight className="w-6 h-6" />
                    </button>
                    
                    <div className="absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2">
                      {item.image_urls.map((_, index) => (
                        <button
                          key={index}
                          onClick={() => setCurrentImageIndex(index)}
                          className={`w-2 h-2 rounded-full transition-colors ${
                            index === currentImageIndex ? 'bg-white' : 'bg-white/50'
                          }`}
                        />
                      ))}
                    </div>
                  </>
                )}
              </div>

              {/* Thumbnails */}
              {item.image_urls.length > 1 && (
                <div className="p-4 flex gap-2 overflow-x-auto">
                  {item.image_urls.map((url, index) => (
                    <button
                      key={index}
                      onClick={() => setCurrentImageIndex(index)}
                      className={`w-16 h-16 rounded-lg overflow-hidden flex-shrink-0 border-2 transition-colors ${
                        index === currentImageIndex ? 'border-primary-500' : 'border-transparent'
                      }`}
                    >
                      <img
                        src={`${apiBase}${url}`}
                        alt=""
                        className="w-full h-full object-cover"
                      />
                    </button>
                  ))}
                </div>
              )}
            </Card>
          )}

          <Card className="p-6">
            {/* Header */}
            <div className="flex items-start justify-between mb-4">
              <div>
                <Badge variant={statusInfo?.color === 'blue' ? 'active' : statusInfo?.color === 'green' ? 'verified' : 'expired'}>
                  {statusInfo?.label || item.status}
                </Badge>
                <span className="ml-2 text-sm text-gray-500">{categoryInfo?.label}</span>
              </div>
              
              {isFinder && item.status === 'UNCLAIMED' && (
                <div className="flex gap-2">
                  <Button variant="ghost" size="sm" onClick={() => navigate(`/found-items/${id}/edit`)}>
                    <Edit className="w-4 h-4" />
                  </Button>
                  <Button variant="ghost" size="sm" onClick={() => setShowDeleteModal(true)}>
                    <Trash2 className="w-4 h-4 text-red-500" />
                  </Button>
                </div>
              )}
            </div>

            {/* Title */}
            <h1 className="text-2xl font-bold text-gray-900 mb-4">{item.title}</h1>

            {/* Details */}
            <div className="flex flex-wrap gap-4 text-sm text-gray-600 mb-6">
              <span className="flex items-center gap-1">
                <MapPin className="w-4 h-4" />
                {item.location_area}
              </span>
              <span className="flex items-center gap-1">
                <Calendar className="w-4 h-4" />
                Found on {formatDateLong(item.found_date)}
              </span>
              <span className="flex items-center gap-1">
                <User className="w-4 h-4" />
                {item.finder_name || 'Anonymous'}
              </span>
            </div>

            {/* Cooperative Badge */}
            {item.source === 'COOPERATIVE' && item.cooperative_name && (
              <Alert type="info" className="mb-6">
                <Building className="w-4 h-4 inline mr-2" />
                This item is held at <strong>{item.cooperative_name}</strong>
              </Alert>
            )}

            {/* Description */}
            <div className="mb-6">
              <h3 className="font-semibold text-gray-900 mb-2">Description</h3>
              <p className="text-gray-600 whitespace-pre-wrap">{item.description}</p>
            </div>

            {item.location_hint && (
              <div className="mb-6">
                <h3 className="font-semibold text-gray-900 mb-2">Where it was found</h3>
                <p className="text-gray-600">{item.location_hint}</p>
              </div>
            )}

            {/* Privacy Notice for Sensitive Items */}
            {(item.category === 'ID' || item.category === 'WALLET') && (
              <Alert type="warning" className="mt-6">
                <Shield className="w-4 h-4 inline mr-2" />
                <strong>Privacy Protected:</strong> Full details and images are only shown to 
                verified owners. Claim this item and complete verification to access all information.
              </Alert>
            )}

            {/* Potential Matching Lost Items - visible to the finder */}
            {isFinder && (
              <div className="mt-6">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="font-semibold text-gray-900">Potential Matching Lost Items</h3>
                  <Button variant="ghost" size="sm" onClick={loadMatches} disabled={matchesLoading}>
                    {matchesLoading ? 'Searching...' : matches.length > 0 ? 'Refresh' : 'Find Matches'}
                  </Button>
                </div>
                {matchesLoading ? (
                  <LoadingSpinner size="sm" />
                ) : matches.length === 0 ? (
                  <div className="text-center py-4">
                    <p className="text-gray-500 mb-2">No matches found yet</p>
                    <p className="text-sm text-gray-400">Click "Find Matches" to search for lost items that might belong to this finder.</p>
                  </div>
                ) : (
                  <div className="space-y-3">
                    {matches.map((match) => (
                      <Card key={match.lost_item?.id || Math.random()} className="p-4 border border-gray-200 hover:border-primary-300 transition-colors">
                        <div className="flex justify-between items-start">
                          <div className="flex-1">
                            <Link to={`/lost-items/${match.lost_item?.id}`} className="font-medium text-gray-900 hover:text-primary-600">
                              {match.lost_item?.title || 'Untitled'}
                            </Link>
                            <p className="text-sm text-gray-500 mt-1">{match.lost_item?.description?.slice(0, 100)}...</p>
                            <div className="flex flex-wrap gap-1 mt-2">
                              {match.explanation?.map((reason, i) => (
                                <Badge key={i} variant="info" className="text-xs">{reason}</Badge>
                              ))}
                            </div>
                          </div>
                          <Badge variant={getMatchScoreBadgeVariant(match.score)}>
                            {match.score}/13
                          </Badge>
                        </div>
                      </Card>
                    ))}
                  </div>
                )}
              </div>
            )}
          </Card>
        </div>

        {/* Sidebar */}
        <div>
          {/* Claim Instructions */}
          <Card className="p-6 mb-6">
            <h3 className="font-semibold text-gray-900 mb-4">Is this yours?</h3>
            
            <p className="text-sm text-gray-600 mb-4">
              If this looks like your lost item, you'll need to:
            </p>

            <ol className="text-sm text-gray-600 space-y-2 mb-6">
              <li className="flex items-start gap-2">
                <span className="w-5 h-5 bg-primary-100 text-primary-600 rounded-full flex items-center justify-center text-xs font-medium flex-shrink-0">1</span>
                Report your lost item first
              </li>
              <li className="flex items-start gap-2">
                <span className="w-5 h-5 bg-primary-100 text-primary-600 rounded-full flex items-center justify-center text-xs font-medium flex-shrink-0">2</span>
                Create a claim linking to this found item
              </li>
              <li className="flex items-start gap-2">
                <span className="w-5 h-5 bg-primary-100 text-primary-600 rounded-full flex items-center justify-center text-xs font-medium flex-shrink-0">3</span>
                Answer verification questions
              </li>
              <li className="flex items-start gap-2">
                <span className="w-5 h-5 bg-primary-100 text-primary-600 rounded-full flex items-center justify-center text-xs font-medium flex-shrink-0">4</span>
                Coordinate pickup with OTP code
              </li>
            </ol>

            <Link to="/report-lost">
              <Button className="w-full">
                Report Lost Item
              </Button>
            </Link>
          </Card>

          {/* Status */}
          <Card className="p-6 mb-6">
            <h3 className="font-semibold text-gray-900 mb-4">Status</h3>
            
            <div className="space-y-3">
              <div className="flex items-center gap-3">
                <div className={`w-3 h-3 rounded-full ${item.status === 'UNCLAIMED' ? 'bg-blue-500' : 'bg-gray-300'}`} />
                <span className={item.status === 'UNCLAIMED' ? 'font-medium' : 'text-gray-500'}>Unclaimed</span>
              </div>
              <div className="flex items-center gap-3">
                <div className={`w-3 h-3 rounded-full ${item.status === 'MATCHED' ? 'bg-yellow-500' : 'bg-gray-300'}`} />
                <span className={item.status === 'MATCHED' ? 'font-medium' : 'text-gray-500'}>Matched</span>
              </div>
              <div className="flex items-center gap-3">
                <div className={`w-3 h-3 rounded-full ${item.status === 'RETURNED' ? 'bg-green-500' : 'bg-gray-300'}`} />
                <span className={item.status === 'RETURNED' ? 'font-medium' : 'text-gray-500'}>Returned</span>
              </div>
            </div>
          </Card>

          {/* Posted Date */}
          <Card className="p-6">
            <p className="text-sm text-gray-500">
              <Clock className="w-4 h-4 inline mr-1" />
              Posted {formatDateLong(item.created_at)}
            </p>
          </Card>
        </div>
      </div>

      {/* Delete Confirmation Modal */}
      <Modal
        isOpen={showDeleteModal}
        onClose={() => setShowDeleteModal(false)}
        title="Delete Found Item"
      >
        <p className="text-gray-600 mb-6">
          Are you sure you want to delete this found item report? This action cannot be undone.
        </p>
        <div className="flex justify-end gap-3">
          <Button variant="secondary" onClick={() => setShowDeleteModal(false)}>
            Cancel
          </Button>
          <Button variant="danger" onClick={handleDelete} loading={deleting}>
            Delete
          </Button>
        </div>
      </Modal>
    </div>
  );
};

export default FoundItemDetailPage;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/HomePage.tsx
â”‚ Language: TSX | Lines: 263 | Size: 13.5 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { Link, useNavigate } from 'react-router-dom';
import { 
  Search, Shield, MapPin, CheckCircle, ArrowRight, Users, 
  Package, FileText, Building2, TrendingUp, Clock, Star
} from 'lucide-react';
import { Button, Card, Badge } from '../components/ui';
import { useAuthStore } from '../store/authStore';
import { foundItemsApi, lostItemsApi } from '../services/api';
import { FoundItem, LostItem, CATEGORY_INFO, ItemCategory } from '../types';
import { formatDateShort } from '../utils/dateUtils';

const HomePage: React.FC = () => {
  const { isAuthenticated } = useAuthStore();
  const navigate = useNavigate();
  const [recentFound, setRecentFound] = useState<FoundItem[]>([]);
  const [recentLost, setRecentLost] = useState<LostItem[]>([]);
  const [stats, setStats] = useState({ found: 0, lost: 0, returned: 0 });
  const [searchQuery, setSearchQuery] = useState('');

  useEffect(() => {
    loadData();
  }, []);

  const loadData = async () => {
    try {
      const [foundRes, lostRes] = await Promise.all([
        foundItemsApi.getAll({ limit: 4 }).catch(() => ({ data: { data: [], pagination: { total: 0 } } })),
        lostItemsApi.getAll({ limit: 4 }).catch(() => ({ data: { data: [], pagination: { total: 0 } } })),
      ]);
      setRecentFound(foundRes.data.data || []);
      setRecentLost(lostRes.data.data || []);
      setStats({
        found: foundRes.data.pagination?.total || 0,
        lost: lostRes.data.pagination?.total || 0,
        returned: Math.floor((foundRes.data.pagination?.total || 0) * 0.7),
      });
    } catch (error) {
      console.error('Failed to load data:', error);
    }
  };

  // FIX: Search bar now passes the keyword to /search page
  const handleSearch = (e: React.FormEvent) => {
    e.preventDefault();
    const params = new URLSearchParams();
    params.set('type', 'found');
    if (searchQuery.trim()) {
      params.set('keyword', searchQuery.trim());
    }
    navigate(`/search?${params.toString()}`);
  };

  return (
    <div className="min-h-screen">
      {/* Hero Section */}
      <section className="relative bg-gradient-to-br from-primary-600 via-primary-700 to-primary-800 overflow-hidden">
        <div className="absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMC4wNSI+PGNpcmNsZSBjeD0iMzAiIGN5PSIzMCIgcj0iNCIvPjwvZz48L2c+PC9zdmc+')] opacity-50" />
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 sm:py-20 lg:py-28 relative">
          <div className="text-center max-w-3xl mx-auto">
            <Badge variant="verified" size="lg" className="mb-4 sm:mb-6">
              <Star className="w-4 h-4 mr-1" /> Trusted by 10,000+ Rwandans
            </Badge>
            <h1 className="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-4 sm:mb-6 leading-tight">
              Lost Something?{' '}
              <span className="text-accent-400">We'll Help You Find It</span>
            </h1>
            <p className="text-base sm:text-lg lg:text-xl text-primary-100 mb-6 sm:mb-8 px-4">
              Rwanda's first trust-aware lost and found platform. Report lost items, find what others have found, and recover your belongings safely.
            </p>
            <div className="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center px-4">
              <Link to="/report-lost">
                <Button size="lg" variant="accent" fullWidth className="sm:w-auto">
                  <FileText className="w-5 h-5" />
                  Report Lost Item
                </Button>
              </Link>
              <Link to="/search">
                <Button size="lg" variant="secondary" fullWidth className="sm:w-auto bg-white/10 border-white/30 text-white hover:bg-white/20">
                  <Search className="w-5 h-5" />
                  Search Found Items
                </Button>
              </Link>
            </div>
          </div>

          {/* Stats */}
          <div className="mt-12 sm:mt-16 grid grid-cols-3 gap-4 sm:gap-8 max-w-2xl mx-auto">
            {[
              { value: stats.lost + stats.found, label: 'Items Reported' },
              { value: stats.returned, label: 'Items Returned' },
              { value: '146+', label: 'Partner Coops' },
            ].map((stat, i) => (
              <div key={i} className="text-center">
                <p className="text-2xl sm:text-3xl lg:text-4xl font-bold text-white">
                  {typeof stat.value === 'number' ? stat.value.toLocaleString() : stat.value}
                </p>
                <p className="text-xs sm:text-sm text-primary-200 mt-1">{stat.label}</p>
              </div>
            ))}
          </div>
        </div>
      </section>

      {/* Quick Search Bar - FIX: Now actually submits search query */}
      <section className="bg-white border-b sticky top-16 z-30 shadow-sm">
        <div className="max-w-7xl mx-auto px-4 py-4">
          <form onSubmit={handleSearch} className="flex gap-2 sm:gap-4">
            <div className="flex-1 relative">
              <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
              <input
                type="text"
                value={searchQuery}
                onChange={(e) => setSearchQuery(e.target.value)}
                placeholder="Search for lost or found items..."
                className="w-full pl-10 pr-4 py-2.5 sm:py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm sm:text-base"
              />
            </div>
            <Button type="submit" size="md" className="hidden sm:flex">Search</Button>
            <Button type="submit" size="md" className="sm:hidden px-3"><Search className="w-5 h-5" /></Button>
          </form>
        </div>
      </section>

      {/* Features */}
      <section className="py-12 sm:py-16 lg:py-20 bg-gray-50">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="text-center mb-10 sm:mb-12">
            <h2 className="text-2xl sm:text-3xl font-bold text-gray-900 mb-3">Why Choose Byaboneka+?</h2>
            <p className="text-gray-600 max-w-2xl mx-auto">Built specifically for Rwanda's transport ecosystem with trust and security at its core</p>
          </div>
          <div className="grid sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6">
            {[
              { icon: <Search className="w-7 h-7" />, title: 'Smart Matching', desc: 'AI matches lost & found items by location, time, and description', color: 'bg-blue-500' },
              { icon: <Shield className="w-7 h-7" />, title: 'Secure Verification', desc: 'Multi-question verification ensures rightful ownership', color: 'bg-green-500' },
              { icon: <Building2 className="w-7 h-7" />, title: 'Cooperative Network', desc: '146+ transport cooperatives across Rwanda', color: 'bg-purple-500' },
              { icon: <TrendingUp className="w-7 h-7" />, title: 'Trust System', desc: 'Build reputation through honest transactions', color: 'bg-orange-500' },
            ].map((feature, i) => (
              <Card key={i} className="p-6 text-center hover:shadow-lg transition-shadow">
                <div className={`w-14 h-14 ${feature.color} rounded-2xl flex items-center justify-center text-white mx-auto mb-4`}>
                  {feature.icon}
                </div>
                <h3 className="font-semibold text-gray-900 mb-2">{feature.title}</h3>
                <p className="text-sm text-gray-600">{feature.desc}</p>
              </Card>
            ))}
          </div>
        </div>
      </section>

      {/* How It Works */}
      <section className="py-12 sm:py-16 lg:py-20">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="text-center mb-10 sm:mb-12">
            <h2 className="text-2xl sm:text-3xl font-bold text-gray-900 mb-3">How It Works</h2>
            <p className="text-gray-600">Simple 4-step process to recover your lost items</p>
          </div>
          <div className="grid sm:grid-cols-2 lg:grid-cols-4 gap-6 sm:gap-8">
            {[
              { step: '01', title: 'Report', desc: 'Describe your lost/found item with details', icon: FileText },
              { step: '02', title: 'Match', desc: 'Our system finds potential matches', icon: Search },
              { step: '03', title: 'Verify', desc: 'Answer questions to prove ownership', icon: Shield },
              { step: '04', title: 'Return', desc: 'Complete handover with OTP code', icon: CheckCircle },
            ].map((item, i) => (
              <div key={i} className="relative">
                <div className="text-center">
                  <div className="w-16 h-16 bg-primary-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
                    <item.icon className="w-8 h-8 text-primary-600" />
                  </div>
                  <span className="text-4xl font-bold text-primary-100">{item.step}</span>
                  <h3 className="font-semibold text-gray-900 mt-2 mb-1">{item.title}</h3>
                  <p className="text-sm text-gray-600">{item.desc}</p>
                </div>
                {i < 3 && (
                  <div className="hidden lg:block absolute top-8 left-[60%] w-[80%]">
                    <div className="border-t-2 border-dashed border-gray-200" />
                  </div>
                )}
              </div>
            ))}
          </div>
          <div className="text-center mt-8">
            <Link to="/how-it-works">
              <Button variant="outline" rightIcon={<ArrowRight className="w-4 h-4" />}>
                Learn More
              </Button>
            </Link>
          </div>
        </div>
      </section>

      {/* Recent Items */}
      <section className="py-12 sm:py-16 lg:py-20 bg-gray-50">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex flex-col sm:flex-row sm:items-center justify-between mb-8 gap-4">
            <div>
              <h2 className="text-2xl sm:text-3xl font-bold text-gray-900 mb-1">Recently Reported</h2>
              <p className="text-gray-600">Latest items that need to find their owners</p>
            </div>
            <Link to="/search">
              <Button variant="outline" rightIcon={<ArrowRight className="w-4 h-4" />}>
                View All Items
              </Button>
            </Link>
          </div>
          <div className="grid sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6">
            {[...recentFound, ...recentLost].slice(0, 4).map((item, i) => {
              const isFound = 'finder_id' in item;
              return (
                <Link key={`${isFound ? 'f' : 'l'}-${item.id}`} to={`/${isFound ? 'found' : 'lost'}-items/${item.id}`}>
                  <Card hover className="overflow-hidden h-full">
                    <div className="aspect-video bg-gray-100 flex items-center justify-center relative">
                      {isFound && (item as FoundItem).image_urls?.length > 0 ? (
                        <img src={(item as FoundItem).image_urls[0]} alt={item.title} className="w-full h-full object-cover" />
                      ) : (
                        <span className="text-4xl">{CATEGORY_INFO[item.category as ItemCategory]?.icon || 'ğŸ“¦'}</span>
                      )}
                      <Badge variant={isFound ? 'verified' : 'pending'} className="absolute top-2 left-2">
                        {isFound ? 'Found' : 'Lost'}
                      </Badge>
                    </div>
                    <div className="p-4">
                      <h3 className="font-semibold text-gray-900 mb-1 line-clamp-1">{item.title}</h3>
                      <p className="text-sm text-gray-500 flex items-center gap-1 mb-2">
                        <MapPin className="w-4 h-4" /> {item.location_area}
                      </p>
                      <p className="text-xs text-gray-400 flex items-center gap-1">
                        <Clock className="w-3 h-3" /> {formatDateShort(isFound ? (item as FoundItem).found_date : (item as LostItem).lost_date)}
                      </p>
                    </div>
                  </Card>
                </Link>
              );
            })}
          </div>
        </div>
      </section>

      {/* CTA */}
      <section className="py-12 sm:py-16 lg:py-20 bg-gradient-to-r from-primary-600 to-primary-700">
        <div className="max-w-4xl mx-auto px-4 text-center">
          <h2 className="text-2xl sm:text-3xl lg:text-4xl font-bold text-white mb-4">Ready to Get Started?</h2>
          <p className="text-primary-100 mb-8 text-base sm:text-lg">Join thousands of Rwandans using Byaboneka+ to reunite with their belongings</p>
          <div className="flex flex-col sm:flex-row gap-4 justify-center">
            {isAuthenticated ? (
              <>
                <Link to="/dashboard"><Button size="lg" variant="accent">Go to Dashboard</Button></Link>
                <Link to="/report-lost"><Button size="lg" variant="secondary" className="bg-white/10 border-white/30 text-white hover:bg-white/20">Report Lost Item</Button></Link>
              </>
            ) : (
              <>
                <Link to="/register"><Button size="lg" variant="accent">Create Free Account</Button></Link>
                <Link to="/login"><Button size="lg" variant="secondary" className="bg-white/10 border-white/30 text-white hover:bg-white/20">Sign In</Button></Link>
              </>
            )}
          </div>
        </div>
      </section>
    </div>
  );
};

export default HomePage;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/LoginPage.tsx
â”‚ Language: TSX | Lines: 141 | Size: 5.3 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState } from 'react';
import { Link, useNavigate, useLocation } from 'react-router-dom';
import { Mail, Lock, Eye, EyeOff } from 'lucide-react';
import { Button, Input, Alert } from '../components/ui';
import { authApi } from '../services/api';
import { useAuthStore } from '../store/authStore';
import toast from 'react-hot-toast';

const LoginPage: React.FC = () => {
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [showPassword, setShowPassword] = useState(false);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');

  const navigate = useNavigate();
  const location = useLocation();
  const { login } = useAuthStore();

  const from = (location.state as { from?: { pathname: string } })?.from?.pathname || '/dashboard';

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setError('');
    setLoading(true);

    try {
      const response = await authApi.login({ email, password });
      const { user, tokens } = response.data.data;
      
      login(user, tokens.accessToken, tokens.refreshToken);
      toast.success(`Welcome back, ${user.name}!`);
      navigate(from, { replace: true });
    } catch (err: any) {
      const message = err.response?.data?.message || 'Login failed. Please try again.';
      setError(message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="min-h-[calc(100vh-4rem)] flex items-center justify-center py-12 px-4">
      <div className="w-full max-w-md">
        <div className="text-center mb-8">
          <Link to="/" className="inline-flex items-center space-x-2 mb-6">
            <div className="w-12 h-12 bg-primary-500 rounded-xl flex items-center justify-center">
              <span className="text-white font-bold text-2xl">B+</span>
            </div>
          </Link>
          <h1 className="text-2xl font-bold text-gray-900">Welcome back</h1>
          <p className="text-gray-600 mt-2">Sign in to your Byaboneka+ account</p>
        </div>

        <div className="bg-white rounded-2xl shadow-sm border border-gray-100 p-8">
          {error && (
            <Alert type="error" className="mb-6">
              {error}
            </Alert>
          )}

          <form onSubmit={handleSubmit} className="space-y-5">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Email
              </label>
              <div className="relative">
                <Mail className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
                <input
                  type="email"
                  value={email}
                  onChange={(e) => setEmail(e.target.value)}
                  className="input pl-10"
                  placeholder="you@example.com"
                  required
                />
              </div>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Password
              </label>
              <div className="relative">
                <Lock className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
                <input
                  type={showPassword ? 'text' : 'password'}
                  value={password}
                  onChange={(e) => setPassword(e.target.value)}
                  className="input pl-10 pr-10"
                  placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                  required
                />
                <button
                  type="button"
                  onClick={() => setShowPassword(!showPassword)}
                  className="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600"
                >
                  {showPassword ? <EyeOff className="w-5 h-5" /> : <Eye className="w-5 h-5" />}
                </button>
              </div>
            </div>

            <div className="flex items-center justify-between">
              <label className="flex items-center">
                <input type="checkbox" className="rounded border-gray-300 text-primary-500 focus:ring-primary-500" />
                <span className="ml-2 text-sm text-gray-600">Remember me</span>
              </label>
              <Link to="/forgot-password" className="text-sm text-primary-500 hover:text-primary-600">
                Forgot password?
              </Link>
            </div>

            <Button type="submit" loading={loading} className="w-full" size="lg">
              Sign in
            </Button>
          </form>

          <p className="mt-6 text-center text-sm text-gray-600">
            Don't have an account?{' '}
            <Link to="/register" className="text-primary-500 hover:text-primary-600 font-medium">
              Sign up
            </Link>
          </p>
        </div>

        {/* Demo Accounts */}
        <div className="mt-6 bg-blue-50 rounded-xl p-4 border border-blue-200">
          <p className="text-sm font-medium text-blue-800 mb-2">Demo Accounts:</p>
          <div className="text-xs text-blue-700 space-y-1">
            <p>Admin: admin@byaboneka.rw / Admin@123</p>
            <p>Citizen: emmanuel.k@gmail.com / User@123</p>
          </div>
        </div>
      </div>
    </div>
  );
};

export default LoginPage;



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/LostItemDetailPage.tsx
â”‚ Language: TSX | Lines: 365 | Size: 13.5 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { useParams, Link, useNavigate } from 'react-router-dom';
import { 
  MapPin, Calendar, User, ArrowLeft, Edit, Trash2,
  Sparkles, ExternalLink, Shield, Clock, CheckCircle
} from 'lucide-react';
import { Button, Card, Badge, LoadingSpinner, Alert, Modal } from '../components/ui';
import { lostItemsApi, claimsApi } from '../services/api';
import { LostItem, Match, CATEGORY_INFO, STATUS_INFO } from '../types';
import { useAuthStore } from '../store/authStore';
import { formatDate, formatDateShort, formatDateLong, formatDateTime } from '../utils/dateUtils';
import toast from 'react-hot-toast';

const LostItemDetailPage: React.FC = () => {
  const { id } = useParams<{ id: string }>();
  const navigate = useNavigate();
  const { user, isAuthenticated } = useAuthStore();

  const [item, setItem] = useState<LostItem | null>(null);
  const [matches, setMatches] = useState<Match[]>([]);
  const [loading, setLoading] = useState(true);
  const [matchesLoading, setMatchesLoading] = useState(false);
  const [claimLoading, setClaimLoading] = useState<number | null>(null);
  const [showDeleteModal, setShowDeleteModal] = useState(false);
  const [deleting, setDeleting] = useState(false);

  const isOwner = user?.id === item?.user_id;

  useEffect(() => {
    loadItem();
  }, [id]);

  useEffect(() => {
    if (item && isOwner) {
      loadMatches();
    }
  }, [item, isOwner]);

  const loadItem = async () => {
    try {
      const response = await lostItemsApi.getById(parseInt(id!));
      setItem(response.data.data);
    } catch (error) {
      toast.error('Failed to load item');
      navigate('/search?type=lost');
    } finally {
      setLoading(false);
    }
  };

  const loadMatches = async () => {
    setMatchesLoading(true);
    try {
      const response = await lostItemsApi.getMatches(parseInt(id!));
      setMatches(response.data.data || []);
    } catch (error) {
      console.error('Failed to load matches:', error);
    } finally {
      setMatchesLoading(false);
    }
  };

  const handleClaim = async (foundItemId: number) => {
    if (!isAuthenticated) {
      toast.error('Please login to claim items');
      navigate('/login');
      return;
    }

    setClaimLoading(foundItemId);
    try {
      const response = await claimsApi.create({
        lost_item_id: parseInt(id!),
        found_item_id: foundItemId,
      });
      
      toast.success('Claim created! Please complete verification.');
      navigate(`/claims/${response.data.data.id}`);
    } catch (error: any) {
      const message = error.response?.data?.message || 'Failed to create claim';
      toast.error(message);
    } finally {
      setClaimLoading(null);
    }
  };

  const handleDelete = async () => {
    setDeleting(true);
    try {
      await lostItemsApi.delete(parseInt(id!));
      toast.success('Item deleted successfully');
      navigate('/my-items');
    } catch (error: any) {
      toast.error(error.response?.data?.message || 'Failed to delete item');
    } finally {
      setDeleting(false);
      setShowDeleteModal(false);
    }
  };

  if (loading) {
    return (
      <div className="flex justify-center py-12">
        <LoadingSpinner size="lg" />
      </div>
    );
  }

  if (!item) {
    return (
      <div className="max-w-2xl mx-auto px-4 py-12 text-center">
        <h1 className="text-2xl font-bold text-gray-900 mb-4">Item Not Found</h1>
        <Link to="/search">
          <Button>Back to Search</Button>
        </Link>
      </div>
    );
  }

  const statusInfo = STATUS_INFO[item.status];
  const categoryInfo = CATEGORY_INFO[item.category];

  return (
    <div className="max-w-4xl mx-auto px-4 py-8">
      {/* Back Link */}
      <Link 
        to="/search?type=lost" 
        className="inline-flex items-center text-gray-600 hover:text-gray-900 mb-6"
      >
        <ArrowLeft className="w-4 h-4 mr-2" />
        Back to Search
      </Link>

      <div className="grid md:grid-cols-3 gap-8">
        {/* Main Content */}
        <div className="md:col-span-2">
          <Card className="p-6 mb-6">
            {/* Header */}
            <div className="flex items-start justify-between mb-4">
              <div>
                <Badge variant={statusInfo?.color === 'blue' ? 'active' : statusInfo?.color === 'green' ? 'verified' : 'expired'}>
                  {statusInfo?.label || item.status}
                </Badge>
                <span className="ml-2 text-sm text-gray-500">{categoryInfo?.label}</span>
              </div>
              
              {isOwner && item.status === 'ACTIVE' && (
                <div className="flex gap-2">
                  <Button variant="ghost" size="sm" onClick={() => navigate(`/lost-items/${id}/edit`)}>
                    <Edit className="w-4 h-4" />
                  </Button>
                  <Button variant="ghost" size="sm" onClick={() => setShowDeleteModal(true)}>
                    <Trash2 className="w-4 h-4 text-red-500" />
                  </Button>
                </div>
              )}
            </div>

            {/* Title */}
            <h1 className="text-2xl font-bold text-gray-900 mb-4">{item.title}</h1>

            {/* Details */}
            <div className="flex flex-wrap gap-4 text-sm text-gray-600 mb-6">
              <span className="flex items-center gap-1">
                <MapPin className="w-4 h-4" />
                {item.location_area}
              </span>
              <span className="flex items-center gap-1">
                <Calendar className="w-4 h-4" />
                Lost on {formatDateLong(item.lost_date)}
              </span>
              <span className="flex items-center gap-1">
                <User className="w-4 h-4" />
                {item.user_name || 'Anonymous'}
              </span>
            </div>

            {/* Description */}
            <div className="mb-6">
              <h3 className="font-semibold text-gray-900 mb-2">Description</h3>
              <p className="text-gray-600 whitespace-pre-wrap">{item.description}</p>
            </div>

            {item.location_hint && (
              <div className="mb-6">
                <h3 className="font-semibold text-gray-900 mb-2">Location Details</h3>
                <p className="text-gray-600">{item.location_hint}</p>
              </div>
            )}

            {/* Verification Questions (Owner Only) */}
            {isOwner && item.verification_questions && (
              <div className="mt-6 pt-6 border-t border-gray-100">
                <h3 className="font-semibold text-gray-900 mb-3 flex items-center gap-2">
                  <Shield className="w-5 h-5 text-trust-500" />
                  Your Verification Questions
                </h3>
                <ul className="space-y-2">
                  {item.verification_questions.map((q, i) => (
                    <li key={i} className="text-sm text-gray-600 bg-gray-50 p-3 rounded-lg">
                      <strong>Q{i + 1}:</strong> {q}
                    </li>
                  ))}
                </ul>
                <p className="text-xs text-gray-500 mt-2">
                  Only you can see these questions. Claimants must answer correctly to prove ownership.
                </p>
              </div>
            )}
          </Card>

          {/* Matches Section (Owner Only) */}
          {isOwner && (
            <Card className="p-6">
              <div className="flex items-center justify-between mb-4">
                <h2 className="text-lg font-semibold text-gray-900 flex items-center gap-2">
                  <Sparkles className="w-5 h-5 text-accent-500" />
                  Potential Matches
                </h2>
                <Button variant="ghost" size="sm" onClick={loadMatches} disabled={matchesLoading}>
                  Refresh
                </Button>
              </div>

              {matchesLoading ? (
                <LoadingSpinner />
              ) : matches.length === 0 ? (
                <div className="text-center py-8">
                  <p className="text-gray-500 mb-2">No matches found yet</p>
                  <p className="text-sm text-gray-400">
                    We'll notify you when someone reports a similar found item
                  </p>
                </div>
              ) : (
                <div className="space-y-4">
                  {matches.map((match) => (
                    <div 
                      key={match.found_item?.id}
                      className="border border-gray-200 rounded-xl p-4 hover:border-primary-200 transition-colors"
                    >
                      <div className="flex items-start justify-between gap-4">
                        <div className="flex-1">
                          <div className="flex items-center gap-2 mb-2">
                            <h3 className="font-medium text-gray-900">
                              {match.found_item?.title}
                            </h3>
                            <Badge variant="verified">
                              Score: {match.score}
                            </Badge>
                          </div>
                          
                          <p className="text-sm text-gray-600 line-clamp-2 mb-2">
                            {match.found_item?.description}
                          </p>

                          <div className="flex items-center gap-3 text-xs text-gray-500">
                            <span className="flex items-center gap-1">
                              <MapPin className="w-3 h-3" />
                              {match.found_item?.location_area}
                            </span>
                            <span className="flex items-center gap-1">
                              <Calendar className="w-3 h-3" />
                              {formatDateShort(match.found_item?.found_date || '')}
                            </span>
                          </div>

                          {/* Match Explanation */}
                          <div className="mt-3 flex flex-wrap gap-1">
                            {match.explanation.slice(0, 4).map((exp, i) => (
                              <span 
                                key={i}
                                className="text-xs px-2 py-0.5 bg-trust-50 text-trust-700 rounded"
                              >
                                {exp}
                              </span>
                            ))}
                          </div>
                        </div>

                        <div className="flex flex-col gap-2">
                          <Link to={`/found-items/${match.found_item?.id}`}>
                            <Button variant="ghost" size="sm">
                              <ExternalLink className="w-4 h-4" />
                            </Button>
                          </Link>
                          <Button 
                            size="sm"
                            onClick={() => handleClaim(match.found_item!.id)}
                            loading={claimLoading === match.found_item?.id}
                          >
                            Claim
                          </Button>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              )}
            </Card>
          )}
        </div>

        {/* Sidebar */}
        <div>
          {/* Status Card */}
          <Card className="p-6 mb-6">
            <h3 className="font-semibold text-gray-900 mb-4">Status</h3>
            
            <div className="space-y-3">
              <div className="flex items-center gap-3">
                <div className={`w-3 h-3 rounded-full ${item.status === 'ACTIVE' ? 'bg-blue-500' : 'bg-gray-300'}`} />
                <span className={item.status === 'ACTIVE' ? 'font-medium' : 'text-gray-500'}>Active</span>
              </div>
              <div className="flex items-center gap-3">
                <div className={`w-3 h-3 rounded-full ${item.status === 'CLAIMED' ? 'bg-yellow-500' : 'bg-gray-300'}`} />
                <span className={item.status === 'CLAIMED' ? 'font-medium' : 'text-gray-500'}>Claimed</span>
              </div>
              <div className="flex items-center gap-3">
                <div className={`w-3 h-3 rounded-full ${item.status === 'RETURNED' ? 'bg-green-500' : 'bg-gray-300'}`} />
                <span className={item.status === 'RETURNED' ? 'font-medium' : 'text-gray-500'}>Returned</span>
              </div>
            </div>

            {item.status === 'RETURNED' && (
              <Alert type="success" className="mt-4">
                <CheckCircle className="w-4 h-4 inline mr-2" />
                This item has been recovered!
              </Alert>
            )}
          </Card>

          {/* Posted Date */}
          <Card className="p-6">
            <p className="text-sm text-gray-500">
              <Clock className="w-4 h-4 inline mr-1" />
              Posted {formatDateLong(item.created_at)}
            </p>
          </Card>
        </div>
      </div>

      {/* Delete Confirmation Modal */}
      <Modal
        isOpen={showDeleteModal}
        onClose={() => setShowDeleteModal(false)}
        title="Delete Lost Item"
      >
        <p className="text-gray-600 mb-6">
          Are you sure you want to delete this lost item report? This action cannot be undone.
        </p>
        <div className="flex justify-end gap-3">
          <Button variant="secondary" onClick={() => setShowDeleteModal(false)}>
            Cancel
          </Button>
          <Button variant="danger" onClick={handleDelete} loading={deleting}>
            Delete
          </Button>
        </div>
      </Modal>
    </div>
  );
};

export default LostItemDetailPage;



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/MessagesPage.tsx
â”‚ Language: TSX | Lines: 113 | Size: 4.2 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { Link } from 'react-router-dom';
import { MessageSquare, ChevronRight, Inbox } from 'lucide-react';
import { Card, Badge, LoadingSpinner, EmptyState } from '../components/ui';
import { messagesApi } from '../services/api';
import { MessageThread, STATUS_INFO } from '../types';
import { formatRelative } from '../utils/dateUtils';

const MessagesPage: React.FC = () => {
  const [threads, setThreads] = useState<MessageThread[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadThreads();
  }, []);

  const loadThreads = async () => {
    try {
      const response = await messagesApi.getThreads();
      setThreads(response.data.data || []);
    } catch (error) {
      console.error('Failed to load threads:', error);
    } finally {
      setLoading(false);
    }
  };

  if (loading) {
    return (
      <div className="flex justify-center py-12">
        <LoadingSpinner size="lg" />
      </div>
    );
  }

  return (
    <div className="max-w-3xl mx-auto px-4 py-8">
      <div className="mb-8">
        <h1 className="text-2xl font-bold text-gray-900 mb-2">Messages</h1>
        <p className="text-gray-600">Communicate with finders and owners about claims</p>
      </div>

      {threads.length === 0 ? (
        <Card className="p-12">
          <EmptyState
            icon={<Inbox className="w-16 h-16" />}
            title="No messages yet"
            description="When you create or receive claims, you can message the other party here"
          />
        </Card>
      ) : (
        <div className="space-y-3">
          {threads.map((thread) => (
            <Link key={thread.claim_id} to={`/claims/${thread.claim_id}`}>
              <Card hover className="p-4">
                <div className="flex items-center justify-between">
                  <div className="flex items-center gap-4 flex-1 min-w-0">
                    <div className="w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0">
                      <MessageSquare className="w-6 h-6 text-primary-600" />
                    </div>
                    
                    <div className="min-w-0 flex-1">
                      <div className="flex items-center gap-2 mb-1">
                        <h3 className="font-medium text-gray-900 truncate">
                          {thread.item_title}
                        </h3>
                        {thread.unread_count > 0 && (
                          <span className="px-2 py-0.5 bg-accent-500 text-white text-xs font-medium rounded-full">
                            {thread.unread_count}
                          </span>
                        )}
                      </div>
                      
                      <div className="flex items-center gap-2 text-sm">
                        <Badge variant={
                          thread.claim_status === 'VERIFIED' ? 'verified' :
                          thread.claim_status === 'PENDING' ? 'pending' : 'expired'
                        }>
                          {STATUS_INFO[thread.claim_status]?.label || thread.claim_status}
                        </Badge>
                        <span className="text-gray-500">
                          {thread.my_role === 'owner' ? 'You are the owner' : 'You found this'}
                        </span>
                      </div>

                      {thread.last_message && (
                        <p className="text-sm text-gray-600 truncate mt-2">
                          {thread.last_message}
                        </p>
                      )}
                    </div>
                  </div>

                  <div className="flex items-center gap-3 ml-4 flex-shrink-0">
                    {thread.last_message_at && (
                      <span className="text-xs text-gray-500">
                        {formatRelative(thread.last_message_at)}
                      </span>
                    )}
                    <ChevronRight className="w-5 h-5 text-gray-400" />
                  </div>
                </div>
              </Card>
            </Link>
          ))}
        </div>
      )}
    </div>
  );
};

export default MessagesPage;



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/MyItemsPage.tsx
â”‚ Language: TSX | Lines: 306 | Size: 14.0 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { Link, useSearchParams } from 'react-router-dom';
import { 
  FileText, Package, CheckCircle, Clock, Plus, Edit2, Trash2, 
  Eye, MapPin, Calendar, AlertCircle, RefreshCw
} from 'lucide-react';
import { Card, Badge, Button, LoadingSpinner, EmptyState, Tabs, ConfirmModal, Alert } from '../components/ui';
import { lostItemsApi, foundItemsApi, claimsApi } from '../services/api';
import { LostItem, FoundItem, Claim, CATEGORY_INFO, STATUS_INFO, ItemCategory } from '../types';
import { formatDate, formatDateShort } from '../utils/dateUtils';
import toast from 'react-hot-toast';

const MyItemsPage: React.FC = () => {
  const [searchParams, setSearchParams] = useSearchParams();
  const [activeTab, setActiveTab] = useState(searchParams.get('tab') || 'lost');
  const [lostItems, setLostItems] = useState<LostItem[]>([]);
  const [foundItems, setFoundItems] = useState<FoundItem[]>([]);
  const [claims, setClaims] = useState<Claim[]>([]);
  const [loading, setLoading] = useState(true);
  const [deleteModal, setDeleteModal] = useState<{ isOpen: boolean; type: 'lost' | 'found'; id: number | null }>({
    isOpen: false, type: 'lost', id: null
  });
  const [deleting, setDeleting] = useState(false);

  useEffect(() => {
    loadData();
  }, []);

  const loadData = async () => {
    setLoading(true);
    try {
      const [lostRes, foundRes, claimsRes] = await Promise.all([
        lostItemsApi.getMine().catch(() => ({ data: { data: [] } })),
        foundItemsApi.getMine().catch(() => ({ data: { data: [] } })),
        claimsApi.getMine().catch(() => ({ data: { data: [] } })),
      ]);
      setLostItems(lostRes.data.data || []);
      setFoundItems(foundRes.data.data || []);
      setClaims(claimsRes.data.data || []);
    } catch (error) {
      console.error('Failed to load items:', error);
      toast.error('Failed to load your items');
    } finally {
      setLoading(false);
    }
  };

  const handleTabChange = (tab: string) => {
    setActiveTab(tab);
    setSearchParams({ tab });
  };

  const handleDelete = async () => {
    if (!deleteModal.id) return;
    setDeleting(true);
    try {
      if (deleteModal.type === 'lost') {
        await lostItemsApi.delete(deleteModal.id);
        setLostItems(prev => prev.filter(item => item.id !== deleteModal.id));
        toast.success('Lost item deleted successfully');
      } else {
        await foundItemsApi.delete(deleteModal.id);
        setFoundItems(prev => prev.filter(item => item.id !== deleteModal.id));
        toast.success('Found item deleted successfully');
      }
      setDeleteModal({ isOpen: false, type: 'lost', id: null });
    } catch (error: any) {
      toast.error(error.response?.data?.message || 'Failed to delete item');
    } finally {
      setDeleting(false);
    }
  };

  const getStatusBadge = (status: string) => {
    const info = STATUS_INFO[status] || { label: status, color: 'gray' };
    const variantMap: Record<string, 'active' | 'verified' | 'pending' | 'expired' | 'danger'> = {
      blue: 'active', green: 'verified', yellow: 'pending', gray: 'expired', red: 'danger'
    };
    return <Badge variant={variantMap[info.color] || 'default'} dot>{info.label}</Badge>;
  };

  const tabs = [
    { id: 'lost', label: 'Lost Items', icon: <FileText className="w-4 h-4" />, count: lostItems.length },
    { id: 'found', label: 'Found Items', icon: <Package className="w-4 h-4" />, count: foundItems.length },
    { id: 'claims', label: 'My Claims', icon: <CheckCircle className="w-4 h-4" />, count: claims.length },
  ];

  if (loading) {
    return (
      <div className="flex items-center justify-center min-h-[60vh]">
        <LoadingSpinner size="lg" />
      </div>
    );
  }

  return (
    <div className="max-w-7xl mx-auto px-4 py-6 sm:py-8">
      <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6">
        <div>
          <h1 className="text-2xl sm:text-3xl font-bold text-gray-900 mb-1">My Items</h1>
          <p className="text-gray-600">Manage your lost and found reports</p>
        </div>
        <div className="flex gap-2">
          <Link to="/report-lost">
            <Button variant="outline" size="sm" leftIcon={<Plus className="w-4 h-4" />}>Report Lost</Button>
          </Link>
          <Link to="/report-found">
            <Button size="sm" leftIcon={<Plus className="w-4 h-4" />}>Report Found</Button>
          </Link>
        </div>
      </div>

      <Tabs tabs={tabs} activeTab={activeTab} onChange={handleTabChange} className="mb-6" />

      {/* Lost Items Tab */}
      {activeTab === 'lost' && (
        <div>
          {lostItems.length === 0 ? (
            <Card padding="lg">
              <EmptyState
                icon={<FileText className="w-16 h-16" />}
                title="No lost items"
                description="Haven't lost anything? Great! If you do, report it here."
                action={<Link to="/report-lost"><Button>Report Lost Item</Button></Link>}
              />
            </Card>
          ) : (
            <div className="space-y-4">
              {lostItems.map((item) => (
                <Card key={item.id} className="p-4 sm:p-6">
                  <div className="flex flex-col sm:flex-row sm:items-start justify-between gap-4">
                    <div className="flex gap-4">
                      <div className="w-12 h-12 sm:w-16 sm:h-16 bg-gray-100 rounded-xl flex items-center justify-center flex-shrink-0">
                        <span className="text-2xl sm:text-3xl">{CATEGORY_INFO[item.category as ItemCategory]?.icon || 'ğŸ“¦'}</span>
                      </div>
                      <div className="min-w-0 flex-1">
                        <div className="flex flex-wrap items-center gap-2 mb-1">
                          <h3 className="font-semibold text-gray-900">{item.title}</h3>
                          {getStatusBadge(item.status)}
                        </div>
                        <p className="text-sm text-gray-600 line-clamp-2 mb-2">{item.description}</p>
                        <div className="flex flex-wrap items-center gap-3 text-sm text-gray-500">
                          <span className="flex items-center gap-1"><MapPin className="w-4 h-4" /> {item.location_area}</span>
                          <span className="flex items-center gap-1"><Calendar className="w-4 h-4" /> {formatDateShort(item.lost_date)}</span>
                          {item.match_count !== undefined && item.match_count > 0 && (
                            <Badge variant="info">{item.match_count} potential matches</Badge>
                          )}
                        </div>
                      </div>
                    </div>
                    <div className="flex sm:flex-col gap-2 sm:items-end">
                      <Link to={`/lost-items/${item.id}`} className="flex-1 sm:flex-none">
                        <Button variant="secondary" size="sm" fullWidth leftIcon={<Eye className="w-4 h-4" />}>View</Button>
                      </Link>
                      <Link to={`/lost-items/${item.id}/edit`} className="flex-1 sm:flex-none">
                        <Button variant="ghost" size="sm" fullWidth leftIcon={<Edit2 className="w-4 h-4" />}>Edit</Button>
                      </Link>
                      <Button 
                        variant="ghost" 
                        size="sm" 
                        className="text-red-600 hover:bg-red-50 flex-1 sm:flex-none"
                        leftIcon={<Trash2 className="w-4 h-4" />}
                        onClick={() => setDeleteModal({ isOpen: true, type: 'lost', id: item.id })}
                      >
                        Delete
                      </Button>
                    </div>
                  </div>
                </Card>
              ))}
            </div>
          )}
        </div>
      )}

      {/* Found Items Tab */}
      {activeTab === 'found' && (
        <div>
          {foundItems.length === 0 ? (
            <Card padding="lg">
              <EmptyState
                icon={<Package className="w-16 h-16" />}
                title="No found items"
                description="Found something? Help return it to its owner!"
                action={<Link to="/report-found"><Button>Report Found Item</Button></Link>}
              />
            </Card>
          ) : (
            <div className="space-y-4">
              {foundItems.map((item) => (
                <Card key={item.id} className="p-4 sm:p-6">
                  <div className="flex flex-col sm:flex-row sm:items-start justify-between gap-4">
                    <div className="flex gap-4">
                      <div className="w-12 h-12 sm:w-16 sm:h-16 bg-gray-100 rounded-xl flex items-center justify-center flex-shrink-0 overflow-hidden">
                        {item.image_urls && item.image_urls.length > 0 ? (
                          <img src={item.image_urls[0]} alt={item.title} className="w-full h-full object-cover" />
                        ) : (
                          <span className="text-2xl sm:text-3xl">{CATEGORY_INFO[item.category as ItemCategory]?.icon || 'ğŸ“¦'}</span>
                        )}
                      </div>
                      <div className="min-w-0 flex-1">
                        <div className="flex flex-wrap items-center gap-2 mb-1">
                          <h3 className="font-semibold text-gray-900">{item.title}</h3>
                          {getStatusBadge(item.status)}
                          {item.source === 'COOPERATIVE' && <Badge variant="info">Cooperative</Badge>}
                        </div>
                        <p className="text-sm text-gray-600 line-clamp-2 mb-2">{item.description}</p>
                        <div className="flex flex-wrap items-center gap-3 text-sm text-gray-500">
                          <span className="flex items-center gap-1"><MapPin className="w-4 h-4" /> {item.location_area}</span>
                          <span className="flex items-center gap-1"><Calendar className="w-4 h-4" /> {formatDateShort(item.found_date)}</span>
                        </div>
                      </div>
                    </div>
                    <div className="flex sm:flex-col gap-2 sm:items-end">
                      <Link to={`/found-items/${item.id}`} className="flex-1 sm:flex-none">
                        <Button variant="secondary" size="sm" fullWidth leftIcon={<Eye className="w-4 h-4" />}>View</Button>
                      </Link>
                      <Link to={`/found-items/${item.id}/edit`} className="flex-1 sm:flex-none">
                        <Button variant="ghost" size="sm" fullWidth leftIcon={<Edit2 className="w-4 h-4" />}>Edit</Button>
                      </Link>
                      <Button 
                        variant="ghost" 
                        size="sm" 
                        className="text-red-600 hover:bg-red-50 flex-1 sm:flex-none"
                        leftIcon={<Trash2 className="w-4 h-4" />}
                        onClick={() => setDeleteModal({ isOpen: true, type: 'found', id: item.id })}
                      >
                        Delete
                      </Button>
                    </div>
                  </div>
                </Card>
              ))}
            </div>
          )}
        </div>
      )}

      {/* Claims Tab */}
      {activeTab === 'claims' && (
        <div>
          {claims.length === 0 ? (
            <Card padding="lg">
              <EmptyState
                icon={<CheckCircle className="w-16 h-16" />}
                title="No claims yet"
                description="When you find a potential match, create a claim to verify ownership"
                action={<Link to="/search"><Button>Search Items</Button></Link>}
              />
            </Card>
          ) : (
            <div className="space-y-4">
              {claims.map((claim) => (
                <Link key={claim.id} to={`/claims/${claim.id}`}>
                  <Card hover className="p-4 sm:p-6">
                    <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
                      <div className="flex items-center gap-4">
                        <div className="w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center flex-shrink-0">
                          <span className="text-2xl">{CATEGORY_INFO[claim.category as ItemCategory]?.icon || 'ğŸ“¦'}</span>
                        </div>
                        <div>
                          <h3 className="font-semibold text-gray-900">{claim.lost_item_title || claim.found_item_title || `Claim #${claim.id}`}</h3>
                          <p className="text-sm text-gray-500">Created {formatDate(claim.created_at)}</p>
                        </div>
                      </div>
                      <div className="flex items-center gap-3">
                        {getStatusBadge(claim.status)}
                        {claim.status === 'VERIFIED' && !claim.otp_verified && (
                          <Badge variant="pending">Awaiting Handover</Badge>
                        )}
                      </div>
                    </div>
                    {claim.status === 'PENDING' && (
                      <Alert type="info" className="mt-4">
                        <div className="flex items-center gap-2">
                          <Clock className="w-4 h-4" />
                          <span>Verification needed - Answer the owner's questions to prove this is your item</span>
                        </div>
                      </Alert>
                    )}
                  </Card>
                </Link>
              ))}
            </div>
          )}
        </div>
      )}

      {/* Delete Confirmation Modal */}
      <ConfirmModal
        isOpen={deleteModal.isOpen}
        onClose={() => setDeleteModal({ isOpen: false, type: 'lost', id: null })}
        onConfirm={handleDelete}
        title="Delete Item?"
        message={`Are you sure you want to delete this ${deleteModal.type} item? This action cannot be undone.`}
        confirmText="Delete"
        cancelText="Cancel"
        variant="danger"
        loading={deleting}
      />
    </div>
  );
};

export default MyItemsPage;



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/PrivacyPolicyPage.tsx
â”‚ Language: TSX | Lines: 91 | Size: 4.4 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React from 'react';
import { Link } from 'react-router-dom';
import { ArrowLeft, Shield } from 'lucide-react';
import { Card } from '../components/ui';

const PrivacyPolicyPage: React.FC = () => {
  return (
    <div className="max-w-3xl mx-auto px-4 py-8 sm:py-12">
      <Link to="/" className="inline-flex items-center text-gray-600 hover:text-gray-900 mb-6">
        <ArrowLeft className="w-4 h-4 mr-2" />Back to Home
      </Link>

      <div className="flex items-center gap-3 mb-8">
        <div className="w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center">
          <Shield className="w-6 h-6 text-primary-600" />
        </div>
        <div>
          <h1 className="text-2xl sm:text-3xl font-bold text-gray-900">Privacy Policy</h1>
          <p className="text-sm text-gray-500">Last updated: February 2026</p>
        </div>
      </div>

      <Card className="p-6 sm:p-8 prose prose-gray max-w-none">
        <h2 className="text-lg font-semibold text-gray-900 mt-0">1. Information We Collect</h2>
        <p className="text-gray-600">
          Byaboneka+ collects information necessary to operate the lost and found platform effectively. 
          This includes your name, email address, phone number (optional), and any item descriptions 
          you provide when reporting lost or found items.
        </p>

        <h2 className="text-lg font-semibold text-gray-900">2. How We Use Your Information</h2>
        <p className="text-gray-600">Your information is used to:</p>
        <ul className="text-gray-600 list-disc pl-5 space-y-1">
          <li>Create and manage your account</li>
          <li>Facilitate lost and found item matching</li>
          <li>Enable secure communication between owners and finders</li>
          <li>Generate and verify handover OTP codes</li>
          <li>Calculate trust scores based on platform activity</li>
          <li>Detect and prevent fraudulent activity</li>
          <li>Send notifications about item matches and claims</li>
        </ul>

        <h2 className="text-lg font-semibold text-gray-900">3. Sensitive Information Protection</h2>
        <p className="text-gray-600">
          Byaboneka+ automatically detects and redacts sensitive information such as national ID numbers, 
          phone numbers, and financial details from item descriptions. This protects your privacy even 
          when descriptions are publicly visible. Verification answers are stored in hashed form and 
          cannot be read by platform administrators.
        </p>

        <h2 className="text-lg font-semibold text-gray-900">4. Data Sharing</h2>
        <p className="text-gray-600">
          We do not sell or share your personal information with third parties. Item descriptions are 
          visible to other users for matching purposes. Your contact details are only shared with 
          verified claimants after successful ownership verification.
        </p>

        <h2 className="text-lg font-semibold text-gray-900">5. Data Security</h2>
        <p className="text-gray-600">
          We implement industry-standard security measures including JWT authentication, 
          bcrypt password hashing, rate limiting, and SQL injection prevention. All API 
          communications are encrypted via HTTPS.
        </p>

        <h2 className="text-lg font-semibold text-gray-900">6. Data Retention</h2>
        <p className="text-gray-600">
          Item reports are automatically expired after 30 days of inactivity. Pending claims 
          expire after 7 days. You may delete your reports at any time. Account data is 
          retained as long as your account is active.
        </p>

        <h2 className="text-lg font-semibold text-gray-900">7. Your Rights</h2>
        <p className="text-gray-600">
          You have the right to access, update, or delete your personal information through 
          your account settings. You may also request a complete data export by contacting 
          our support team.
        </p>

        <h2 className="text-lg font-semibold text-gray-900">8. Contact</h2>
        <p className="text-gray-600">
          For privacy-related inquiries, please contact us at{' '}
          <a href="mailto:privacy@byaboneka.rw" className="text-primary-500 hover:underline">
            privacy@byaboneka.rw
          </a>
        </p>
      </Card>
    </div>
  );
};

export default PrivacyPolicyPage;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/RegisterPage.tsx
â”‚ Language: TSX | Lines: 257 | Size: 9.6 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState } from 'react';
import { Link, useNavigate } from 'react-router-dom';
import { Mail, Lock, User, Phone, Eye, EyeOff } from 'lucide-react';
import { Button, Alert } from '../components/ui';
import { authApi } from '../services/api';
import { useAuthStore } from '../store/authStore';
import toast from 'react-hot-toast';

const RegisterPage: React.FC = () => {
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    phone: '',
    password: '',
    confirmPassword: ''
  });
  const [showPassword, setShowPassword] = useState(false);
  const [loading, setLoading] = useState(false);
  const [errors, setErrors] = useState<Record<string, string>>({});

  const navigate = useNavigate();
  const { login } = useAuthStore();

  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    setFormData({ ...formData, [e.target.name]: e.target.value });
    if (errors[e.target.name]) {
      setErrors({ ...errors, [e.target.name]: '' });
    }
  };

  const validate = () => {
    const newErrors: Record<string, string> = {};

    if (!formData.name || formData.name.length < 2) {
      newErrors.name = 'Name must be at least 2 characters';
    }

    if (!formData.email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(formData.email)) {
      newErrors.email = 'Please enter a valid email';
    }

    if (formData.phone && !/^\+?250\d{9}$/.test(formData.phone.replace(/\s/g, ''))) {
      newErrors.phone = 'Please enter a valid Rwandan phone number';
    }

    if (!formData.password || formData.password.length < 8) {
      newErrors.password = 'Password must be at least 8 characters';
    } else if (!/[A-Z]/.test(formData.password)) {
      newErrors.password = 'Password must contain an uppercase letter';
    } else if (!/[a-z]/.test(formData.password)) {
      newErrors.password = 'Password must contain a lowercase letter';
    } else if (!/[0-9]/.test(formData.password)) {
      newErrors.password = 'Password must contain a number';
    }

    if (formData.password !== formData.confirmPassword) {
      newErrors.confirmPassword = 'Passwords do not match';
    }

    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    if (!validate()) return;

    setLoading(true);

    try {
      const response = await authApi.register({
        name: formData.name,
        email: formData.email,
        password: formData.password,
        phone: formData.phone || undefined
      });
      
      const { user, tokens } = response.data.data;
      login(user, tokens.accessToken, tokens.refreshToken);
      
      toast.success('Account created successfully!');
      navigate('/dashboard');
    } catch (err: any) {
      const message = err.response?.data?.message || 'Registration failed. Please try again.';
      if (err.response?.data?.errors) {
        const apiErrors: Record<string, string> = {};
        err.response.data.errors.forEach((e: { field: string; message: string }) => {
          apiErrors[e.field] = e.message;
        });
        setErrors(apiErrors);
      } else {
        setErrors({ form: message });
      }
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="min-h-[calc(100vh-4rem)] flex items-center justify-center py-12 px-4">
      <div className="w-full max-w-md">
        <div className="text-center mb-8">
          <Link to="/" className="inline-flex items-center space-x-2 mb-6">
            <div className="w-12 h-12 bg-primary-500 rounded-xl flex items-center justify-center">
              <span className="text-white font-bold text-2xl">B+</span>
            </div>
          </Link>
          <h1 className="text-2xl font-bold text-gray-900">Create your account</h1>
          <p className="text-gray-600 mt-2">Join Byaboneka+ and recover lost items</p>
        </div>

        <div className="bg-white rounded-2xl shadow-sm border border-gray-100 p-8">
          {errors.form && (
            <Alert type="error" className="mb-6">
              {errors.form}
            </Alert>
          )}

          <form onSubmit={handleSubmit} className="space-y-5">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Full Name *
              </label>
              <div className="relative">
                <User className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
                <input
                  type="text"
                  name="name"
                  value={formData.name}
                  onChange={handleChange}
                  className={`input pl-10 ${errors.name ? 'border-red-500' : ''}`}
                  placeholder="Jean Baptiste"
                  required
                />
              </div>
              {errors.name && <p className="mt-1 text-sm text-red-500">{errors.name}</p>}
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Email *
              </label>
              <div className="relative">
                <Mail className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
                <input
                  type="email"
                  name="email"
                  value={formData.email}
                  onChange={handleChange}
                  className={`input pl-10 ${errors.email ? 'border-red-500' : ''}`}
                  placeholder="you@example.com"
                  required
                />
              </div>
              {errors.email && <p className="mt-1 text-sm text-red-500">{errors.email}</p>}
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Phone Number (Optional)
              </label>
              <div className="relative">
                <Phone className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
                <input
                  type="tel"
                  name="phone"
                  value={formData.phone}
                  onChange={handleChange}
                  className={`input pl-10 ${errors.phone ? 'border-red-500' : ''}`}
                  placeholder="+250788123456"
                />
              </div>
              {errors.phone && <p className="mt-1 text-sm text-red-500">{errors.phone}</p>}
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Password *
              </label>
              <div className="relative">
                <Lock className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
                <input
                  type={showPassword ? 'text' : 'password'}
                  name="password"
                  value={formData.password}
                  onChange={handleChange}
                  className={`input pl-10 pr-10 ${errors.password ? 'border-red-500' : ''}`}
                  placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                  required
                />
                <button
                  type="button"
                  onClick={() => setShowPassword(!showPassword)}
                  className="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600"
                >
                  {showPassword ? <EyeOff className="w-5 h-5" /> : <Eye className="w-5 h-5" />}
                </button>
              </div>
              {errors.password && <p className="mt-1 text-sm text-red-500">{errors.password}</p>}
              <p className="mt-1 text-xs text-gray-500">
                Min 8 characters with uppercase, lowercase, and number
              </p>
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">
                Confirm Password *
              </label>
              <div className="relative">
                <Lock className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
                <input
                  type={showPassword ? 'text' : 'password'}
                  name="confirmPassword"
                  value={formData.confirmPassword}
                  onChange={handleChange}
                  className={`input pl-10 ${errors.confirmPassword ? 'border-red-500' : ''}`}
                  placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                  required
                />
              </div>
              {errors.confirmPassword && <p className="mt-1 text-sm text-red-500">{errors.confirmPassword}</p>}
            </div>

            <div className="flex items-start">
              <input 
                type="checkbox" 
                required
                className="mt-1 rounded border-gray-300 text-primary-500 focus:ring-primary-500" 
              />
              <span className="ml-2 text-sm text-gray-600">
                I agree to the{' '}
                <Link to="/terms" className="text-primary-500 hover:text-primary-600">Terms of Service</Link>
                {' '}and{' '}
                <Link to="/privacy" className="text-primary-500 hover:text-primary-600">Privacy Policy</Link>
              </span>
            </div>

            <Button type="submit" loading={loading} className="w-full" size="lg">
              Create Account
            </Button>
          </form>

          <p className="mt-6 text-center text-sm text-gray-600">
            Already have an account?{' '}
            <Link to="/login" className="text-primary-500 hover:text-primary-600 font-medium">
              Sign in
            </Link>
          </p>
        </div>
      </div>
    </div>
  );
};

export default RegisterPage;



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/ReportFoundPage.tsx
â”‚ Language: TSX | Lines: 382 | Size: 14.4 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useRef } from 'react';
import { useNavigate } from 'react-router-dom';
import { 
  Camera, Upload, X, MapPin, Calendar, Check,
  Smartphone, CreditCard, Wallet, Briefcase, Key, Package,
  Building, AlertCircle
} from 'lucide-react';
import { Button, Card, Input, Textarea, Alert } from '../components/ui';
import { foundItemsApi, duplicateApi } from '../services/api';
import { DuplicateWarning } from '../components/DuplicateWarning';
import { ItemCategory, CATEGORY_INFO, RWANDA_LOCATIONS } from '../types';
import { useAuthStore } from '../store/authStore';
import toast from 'react-hot-toast';

const CATEGORY_ICONS: Record<ItemCategory, React.ReactNode> = {
  [ItemCategory.PHONE]: <Smartphone className="w-8 h-8" />,
  [ItemCategory.ID]: <CreditCard className="w-8 h-8" />,
  [ItemCategory.WALLET]: <Wallet className="w-8 h-8" />,
  [ItemCategory.BAG]: <Briefcase className="w-8 h-8" />,
  [ItemCategory.KEYS]: <Key className="w-8 h-8" />,
  [ItemCategory.OTHER]: <Package className="w-8 h-8" />,
};

interface FormData {
  category: ItemCategory | '';
  title: string;
  description: string;
  location_area: string;
  location_hint: string;
  found_date: string;
}

const ReportFoundPage: React.FC = () => {
  const navigate = useNavigate();
  const { user } = useAuthStore();
  const fileInputRef = useRef<HTMLInputElement>(null);

  const [loading, setLoading] = useState(false);
  const [uploadingImages, setUploadingImages] = useState(false);
  const [images, setImages] = useState<File[]>([]);
  const [imagesPreviews, setImagesPreviews] = useState<string[]>([]);
  const [errors, setErrors] = useState<Record<string, string>>({});
  const [duplicateCandidates, setDuplicateCandidates] = useState<any[]>([]);
  const [showDuplicateWarning, setShowDuplicateWarning] = useState(false);

  const [formData, setFormData] = useState<FormData>({
    category: '',
    title: '',
    description: '',
    location_area: '',
    location_hint: '',
    found_date: new Date().toISOString().split('T')[0],
  });

  const isCoopStaff = user?.role === 'coop_staff';

  const handleImageSelect = (e: React.ChangeEvent<HTMLInputElement>) => {
    const files = e.target.files;
    if (!files) return;

    const newFiles = Array.from(files).slice(0, 5 - images.length);
    
    // Validate file types and sizes
    for (const file of newFiles) {
      if (!['image/jpeg', 'image/png', 'image/webp'].includes(file.type)) {
        toast.error('Only JPEG, PNG, and WebP images are allowed');
        return;
      }
      if (file.size > 5 * 1024 * 1024) {
        toast.error('Image size must be less than 5MB');
        return;
      }
    }

    // Create previews
    const previews = newFiles.map((file) => URL.createObjectURL(file));
    
    setImages([...images, ...newFiles]);
    setImagesPreviews([...imagesPreviews, ...previews]);
  };

  const removeImage = (index: number) => {
    URL.revokeObjectURL(imagesPreviews[index]);
    setImages(images.filter((_, i) => i !== index));
    setImagesPreviews(imagesPreviews.filter((_, i) => i !== index));
  };

  const validate = (): boolean => {
    const newErrors: Record<string, string> = {};

    if (!formData.category) newErrors.category = 'Please select a category';
    if (!formData.title || formData.title.length < 3) newErrors.title = 'Title must be at least 3 characters';
    if (!formData.description || formData.description.length < 10) {
      newErrors.description = 'Description must be at least 10 characters';
    }
    if (!formData.location_area) newErrors.location_area = 'Please select a location';
    if (!formData.found_date) newErrors.found_date = 'Please enter the date you found the item';
    if (images.length === 0) newErrors.images = 'Please upload at least one image';

    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!validate()) return;

    // Check for duplicates first (if not already confirmed)
    if (!showDuplicateWarning && duplicateCandidates.length === 0) {
      try {
        const dupRes = await duplicateApi.checkFound({
          category: formData.category,
          title: formData.title,
          description: formData.description,
          location_area: formData.location_area,
          found_date: formData.found_date,
        });
        if (dupRes.data.data?.has_potential_duplicates && dupRes.data.data.candidates.length > 0) {
          setDuplicateCandidates(dupRes.data.data.candidates);
          setShowDuplicateWarning(true);
          return;
        }
      } catch (error) {
        // If duplicate check fails, proceed anyway
        console.warn('Duplicate check failed:', error);
      }
    }

    await submitFoundItem();
  };

  const submitFoundItem = async () => {
    setShowDuplicateWarning(false);
    setLoading(true);
    try {
      // Create the found item first
      const createData = {
        category: formData.category,
        title: formData.title,
        description: formData.description,
        location_area: formData.location_area,
        location_hint: formData.location_hint || undefined,
        found_date: formData.found_date,
        cooperative_id: isCoopStaff && user?.cooperative_id ? user.cooperative_id : undefined,
      };

      const response = await foundItemsApi.create(createData);
      const itemId = response.data.data.id;

      // Upload images
      if (images.length > 0) {
        setUploadingImages(true);
        const fileList = new DataTransfer();
        images.forEach((file) => fileList.items.add(file));
        await foundItemsApi.uploadImages(itemId, fileList.files);
      }

      toast.success('Found item reported successfully!');
      navigate(`/found-items/${itemId}`);
    } catch (error: any) {
      const message = error.response?.data?.message || 'Failed to submit report';
      toast.error(message);
    } finally {
      setLoading(false);
      setUploadingImages(false);
    }
  };

  return (
    <>
      {showDuplicateWarning && (
        <DuplicateWarning
          candidates={duplicateCandidates}
          itemType="found"
          onContinue={() => submitFoundItem()}
          onViewDuplicate={(id, type) => navigate(`/${type === 'lost' ? 'lost-items' : 'found-items'}/${id}`)}
          onCancel={() => { setShowDuplicateWarning(false); setDuplicateCandidates([]); }}
        />
      )}
    <div className="max-w-2xl mx-auto px-4 py-8">
      {/* Header */}
      <div className="mb-8">
        <h1 className="text-2xl font-bold text-gray-900 mb-2">Report Found Item</h1>
        <p className="text-gray-600">
          Thank you for helping reunite someone with their belongings!
        </p>
      </div>

      {isCoopStaff && (
        <Alert type="info" className="mb-6">
          <Building className="w-4 h-4 inline mr-2" />
          You're reporting as a <strong>Cooperative Staff</strong>. This item will be associated 
          with your cooperative and held for secure pickup.
        </Alert>
      )}

      <form onSubmit={handleSubmit}>
        <Card className="p-6 mb-6">
          <h2 className="text-lg font-semibold text-gray-900 mb-6">Item Details</h2>

          {/* Category Selection */}
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-3">Category *</label>
            <div className="grid grid-cols-3 gap-3">
              {Object.entries(CATEGORY_INFO).map(([key, info]) => (
                <button
                  key={key}
                  type="button"
                  onClick={() => setFormData({ ...formData, category: key as ItemCategory })}
                  className={`p-4 rounded-xl border-2 transition-all ${
                    formData.category === key
                      ? 'border-trust-500 bg-trust-50'
                      : 'border-gray-200 hover:border-gray-300'
                  }`}
                >
                  <div className={`mx-auto mb-2 ${formData.category === key ? 'text-trust-500' : 'text-gray-400'}`}>
                    {CATEGORY_ICONS[key as ItemCategory]}
                  </div>
                  <p className={`text-sm font-medium ${formData.category === key ? 'text-trust-500' : 'text-gray-600'}`}>
                    {info.label}
                  </p>
                </button>
              ))}
            </div>
            {errors.category && <p className="mt-2 text-sm text-red-500">{errors.category}</p>}
          </div>

          {/* Title */}
          <div className="mb-6">
            <Input
              label="Title *"
              value={formData.title}
              onChange={(e) => setFormData({ ...formData, title: e.target.value })}
              placeholder="e.g., Black phone found at bus station"
              error={errors.title}
            />
          </div>

          {/* Description */}
          <div className="mb-6">
            <Textarea
              label="Description *"
              value={formData.description}
              onChange={(e) => setFormData({ ...formData, description: e.target.value })}
              placeholder="Describe what you found. Include visible details but NOT sensitive information like ID numbers..."
              rows={4}
              error={errors.description}
            />
            {(formData.category === 'ID' || formData.category === 'WALLET') && (
              <p className="mt-2 text-sm text-yellow-600">
                <AlertCircle className="w-4 h-4 inline mr-1" />
                Do NOT include personal information like ID numbers, names, or card details
              </p>
            )}
          </div>
        </Card>

        <Card className="p-6 mb-6">
          <h2 className="text-lg font-semibold text-gray-900 mb-6">Location & Date</h2>

          {/* Location */}
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-1">
              <MapPin className="w-4 h-4 inline mr-1" />
              Where did you find it? *
            </label>
            <select
              value={formData.location_area}
              onChange={(e) => setFormData({ ...formData, location_area: e.target.value })}
              className={`input ${errors.location_area ? 'border-red-500' : ''}`}
            >
              <option value="">Select location</option>
              {RWANDA_LOCATIONS.map((loc) => (
                <option key={loc} value={loc}>{loc}</option>
              ))}
            </select>
            {errors.location_area && <p className="mt-1 text-sm text-red-500">{errors.location_area}</p>}
          </div>

          {/* Location Hint */}
          <div className="mb-6">
            <Textarea
              label="Specific Location (Optional)"
              value={formData.location_hint}
              onChange={(e) => setFormData({ ...formData, location_hint: e.target.value })}
              placeholder="e.g., Under seat 23 on bus KM-456-A, near the market entrance..."
              rows={2}
            />
          </div>

          {/* Date */}
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-1">
              <Calendar className="w-4 h-4 inline mr-1" />
              When did you find it? *
            </label>
            <input
              type="date"
              value={formData.found_date}
              onChange={(e) => setFormData({ ...formData, found_date: e.target.value })}
              max={new Date().toISOString().split('T')[0]}
              className={`input ${errors.found_date ? 'border-red-500' : ''}`}
            />
            {errors.found_date && <p className="mt-1 text-sm text-red-500">{errors.found_date}</p>}
          </div>
        </Card>

        <Card className="p-6 mb-6">
          <h2 className="text-lg font-semibold text-gray-900 mb-4">
            <Camera className="w-5 h-5 inline mr-2" />
            Photos *
          </h2>
          <p className="text-sm text-gray-600 mb-4">
            Upload clear photos of the item. This helps owners identify their belongings.
          </p>

          {/* Image Upload Area */}
          <div className="grid grid-cols-3 gap-4 mb-4">
            {imagesPreviews.map((preview, index) => (
              <div key={index} className="relative aspect-square rounded-lg overflow-hidden bg-gray-100">
                <img src={preview} alt="" className="w-full h-full object-cover" />
                <button
                  type="button"
                  onClick={() => removeImage(index)}
                  className="absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600"
                >
                  <X className="w-4 h-4" />
                </button>
              </div>
            ))}

            {images.length < 5 && (
              <button
                type="button"
                onClick={() => fileInputRef.current?.click()}
                className="aspect-square rounded-lg border-2 border-dashed border-gray-300 hover:border-primary-400 flex flex-col items-center justify-center transition-colors"
              >
                <Upload className="w-8 h-8 text-gray-400 mb-2" />
                <span className="text-sm text-gray-500">Add Photo</span>
              </button>
            )}
          </div>

          <input
            ref={fileInputRef}
            type="file"
            accept="image/jpeg,image/png,image/webp"
            multiple
            onChange={handleImageSelect}
            className="hidden"
          />

          {errors.images && <p className="text-sm text-red-500">{errors.images}</p>}
          <p className="text-xs text-gray-500 mt-2">
            Max 5 images, 5MB each. JPEG, PNG, or WebP format.
          </p>
        </Card>

        {/* Important Notice */}
        <Alert type="warning" className="mb-6">
          <strong>Important:</strong> Never demand payment before verification. Byaboneka+ uses 
          secure verification to confirm ownership. Attempting to extort money is against our 
          policies and may result in account suspension.
        </Alert>

        {/* Submit Button */}
        <div className="flex justify-end gap-4">
          <Button type="button" variant="secondary" onClick={() => navigate(-1)}>
            Cancel
          </Button>
          <Button type="submit" loading={loading || uploadingImages}>
            <Check className="w-4 h-4 mr-2" />
            {uploadingImages ? 'Uploading Images...' : 'Submit Report'}
          </Button>
        </div>
      </form>
    </div>
    </>
  );
};

export default ReportFoundPage;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/ReportLostPage.tsx
â”‚ Language: TSX | Lines: 432 | Size: 16.3 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { 
  ArrowLeft, ArrowRight, Check, Smartphone, CreditCard, 
  Wallet, Briefcase, Key, Package, MapPin, Calendar,
  HelpCircle, Shield, AlertCircle
} from 'lucide-react';
import { Button, Card, Input, Textarea, Select, Alert } from '../components/ui';
import { lostItemsApi, duplicateApi } from '../services/api';
import { DuplicateWarning } from '../components/DuplicateWarning';
import { ItemCategory, CATEGORY_INFO, RWANDA_LOCATIONS, QUESTION_TEMPLATES, VerificationQuestion } from '../types';
import toast from 'react-hot-toast';
import VerificationStrengthIndicator from '../components/VerificationStrengthIndicator';

const CATEGORY_OPTIONS = Object.entries(CATEGORY_INFO).map(([value, info]) => ({
  value,
  label: info.label,
}));

const LOCATION_OPTIONS = RWANDA_LOCATIONS.map((loc) => ({ value: loc, label: loc }));

const CATEGORY_ICONS: Record<ItemCategory, React.ReactNode> = {
  [ItemCategory.PHONE]: <Smartphone className="w-8 h-8" />,
  [ItemCategory.ID]: <CreditCard className="w-8 h-8" />,
  [ItemCategory.WALLET]: <Wallet className="w-8 h-8" />,
  [ItemCategory.BAG]: <Briefcase className="w-8 h-8" />,
  [ItemCategory.KEYS]: <Key className="w-8 h-8" />,
  [ItemCategory.OTHER]: <Package className="w-8 h-8" />,
};

interface FormData {
  category: ItemCategory | '';
  title: string;
  description: string;
  location_area: string;
  location_hint: string;
  lost_date: string;
  verification_questions: VerificationQuestion[];
}

const ReportLostPage: React.FC = () => {
  const navigate = useNavigate();
  const [step, setStep] = useState(1);
  const [loading, setLoading] = useState(false);
  const [errors, setErrors] = useState<Record<string, string>>({});
  const [duplicateCandidates, setDuplicateCandidates] = useState<any[]>([]);
  const [showDuplicateWarning, setShowDuplicateWarning] = useState(false);

  const [formData, setFormData] = useState<FormData>({
    category: '',
    title: '',
    description: '',
    location_area: '',
    location_hint: '',
    lost_date: new Date().toISOString().split('T')[0],
    verification_questions: [
      { question: '', answer: '' },
      { question: '', answer: '' },
      { question: '', answer: '' },
    ],
  });

  const validateStep = (currentStep: number): boolean => {
    const newErrors: Record<string, string> = {};

    if (currentStep === 1) {
      if (!formData.category) newErrors.category = 'Please select a category';
      if (!formData.title || formData.title.length < 3) newErrors.title = 'Title must be at least 3 characters';
      if (!formData.description || formData.description.length < 10) {
        newErrors.description = 'Description must be at least 10 characters';
      }
    }

    if (currentStep === 2) {
      if (!formData.location_area) newErrors.location_area = 'Please select a location';
      if (!formData.lost_date) newErrors.lost_date = 'Please enter the date you lost the item';
    }

    if (currentStep === 3) {
      formData.verification_questions.forEach((q, i) => {
        if (!q.question || q.question.length < 5) {
          newErrors[`question_${i}`] = 'Question must be at least 5 characters';
        }
        if (!q.answer || q.answer.length < 1) {
          newErrors[`answer_${i}`] = 'Answer is required';
        }
      });
    }

    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleNext = () => {
    if (validateStep(step)) {
      setStep(step + 1);
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
  };

  const handleBack = () => {
    setStep(step - 1);
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const handleSubmit = async () => {
    if (!validateStep(3)) return;

    // Check for duplicates first
    if (!showDuplicateWarning && duplicateCandidates.length === 0) {
      try {
        const dupRes = await duplicateApi.checkLost({
          category: formData.category,
          title: formData.title,
          description: formData.description,
          location_area: formData.location_area,
          lost_date: formData.lost_date,
        });
        if (dupRes.data.data?.has_potential_duplicates && dupRes.data.data.candidates.length > 0) {
          setDuplicateCandidates(dupRes.data.data.candidates);
          setShowDuplicateWarning(true);
          return;
        }
      } catch (error) {
        console.warn('Duplicate check failed:', error);
      }
    }

    await submitLostItem();
  };

  const submitLostItem = async () => {
    setShowDuplicateWarning(false);
    setLoading(true);
    try {
      const response = await lostItemsApi.create({
        ...formData,
        verification_questions: formData.verification_questions.map((q) => ({
          question: q.question,
          answer: q.answer,
        })),
      });

      toast.success('Lost item reported successfully!');
      navigate(`/lost-items/${response.data.data.id}`);
    } catch (error: any) {
      const message = error.response?.data?.message || 'Failed to submit report';
      toast.error(message);
    } finally {
      setLoading(false);
    }
  };

  const updateQuestion = (index: number, field: 'question' | 'answer', value: string) => {
    const updated = [...formData.verification_questions];
    updated[index] = { ...updated[index], [field]: value };
    setFormData({ ...formData, verification_questions: updated });
  };

  const suggestedQuestions = formData.category 
    ? QUESTION_TEMPLATES[formData.category as ItemCategory] || []
    : [];

  return (
    <>
      {showDuplicateWarning && (
        <DuplicateWarning
          candidates={duplicateCandidates}
          itemType="lost"
          onContinue={() => submitLostItem()}
          onViewDuplicate={(id, type) => navigate(`/${type === 'lost' ? 'lost-items' : 'found-items'}/${id}`)}
          onCancel={() => { setShowDuplicateWarning(false); setDuplicateCandidates([]); }}
        />
      )}
    <div className="max-w-2xl mx-auto px-4 py-8">
      {/* Header */}
      <div className="mb-8">
        <h1 className="text-2xl font-bold text-gray-900 mb-2">Report Lost Item</h1>
        <p className="text-gray-600">
          Provide details about your lost item to help us match it with found items
        </p>
      </div>

      {/* Progress Steps */}
      <div className="flex items-center justify-between mb-8">
        {[1, 2, 3].map((s) => (
          <React.Fragment key={s}>
            <div className="flex items-center">
              <div
                className={`w-10 h-10 rounded-full flex items-center justify-center font-semibold transition-colors ${
                  s < step
                    ? 'bg-trust-500 text-white'
                    : s === step
                    ? 'bg-primary-500 text-white'
                    : 'bg-gray-200 text-gray-500'
                }`}
              >
                {s < step ? <Check className="w-5 h-5" /> : s}
              </div>
              <span className={`ml-2 text-sm font-medium ${s === step ? 'text-primary-500' : 'text-gray-500'}`}>
                {s === 1 ? 'Item Details' : s === 2 ? 'Location & Date' : 'Verification'}
              </span>
            </div>
            {s < 3 && <div className={`flex-1 h-1 mx-4 rounded ${s < step ? 'bg-trust-500' : 'bg-gray-200'}`} />}
          </React.Fragment>
        ))}
      </div>

      {/* Step 1: Item Details */}
      {step === 1 && (
        <Card className="p-6 animate-fade-in">
          <h2 className="text-lg font-semibold text-gray-900 mb-6">What did you lose?</h2>

          {/* Category Selection */}
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-3">Category *</label>
            <div className="grid grid-cols-3 gap-3">
              {Object.entries(CATEGORY_INFO).map(([key, info]) => (
                <button
                  key={key}
                  type="button"
                  onClick={() => setFormData({ ...formData, category: key as ItemCategory })}
                  className={`p-4 rounded-xl border-2 transition-all ${
                    formData.category === key
                      ? 'border-primary-500 bg-primary-50'
                      : 'border-gray-200 hover:border-gray-300'
                  }`}
                >
                  <div className={`mx-auto mb-2 ${formData.category === key ? 'text-primary-500' : 'text-gray-400'}`}>
                    {CATEGORY_ICONS[key as ItemCategory]}
                  </div>
                  <p className={`text-sm font-medium ${formData.category === key ? 'text-primary-500' : 'text-gray-600'}`}>
                    {info.label}
                  </p>
                </button>
              ))}
            </div>
            {errors.category && <p className="mt-2 text-sm text-red-500">{errors.category}</p>}
          </div>

          {/* Title */}
          <div className="mb-6">
            <Input
              label="Title *"
              value={formData.title}
              onChange={(e) => setFormData({ ...formData, title: e.target.value })}
              placeholder="e.g., Black iPhone 13 Pro with blue case"
              error={errors.title}
              helperText="Be specific - include color, brand, model"
            />
          </div>

          {/* Description */}
          <div className="mb-6">
            <Textarea
              label="Description *"
              value={formData.description}
              onChange={(e) => setFormData({ ...formData, description: e.target.value })}
              placeholder="Describe your item in detail. Include any unique marks, scratches, stickers, or identifiers..."
              rows={4}
              error={errors.description}
            />
          </div>

          <div className="flex justify-end">
            <Button onClick={handleNext}>
              Next: Location & Date
              <ArrowRight className="w-4 h-4 ml-2" />
            </Button>
          </div>
        </Card>
      )}

      {/* Step 2: Location & Date */}
      {step === 2 && (
        <Card className="p-6 animate-fade-in">
          <h2 className="text-lg font-semibold text-gray-900 mb-6">Where and when did you lose it?</h2>

          {/* Location */}
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-1">
              <MapPin className="w-4 h-4 inline mr-1" />
              Location Area *
            </label>
            <select
              value={formData.location_area}
              onChange={(e) => setFormData({ ...formData, location_area: e.target.value })}
              className={`input ${errors.location_area ? 'border-red-500' : ''}`}
            >
              <option value="">Select location</option>
              {RWANDA_LOCATIONS.map((loc) => (
                <option key={loc} value={loc}>{loc}</option>
              ))}
            </select>
            {errors.location_area && <p className="mt-1 text-sm text-red-500">{errors.location_area}</p>}
          </div>

          {/* Location Hint */}
          <div className="mb-6">
            <Textarea
              label="Location Details (Optional)"
              value={formData.location_hint}
              onChange={(e) => setFormData({ ...formData, location_hint: e.target.value })}
              placeholder="e.g., Near the main bus station, inside a moto taxi..."
              rows={2}
            />
          </div>

          {/* Date */}
          <div className="mb-6">
            <label className="block text-sm font-medium text-gray-700 mb-1">
              <Calendar className="w-4 h-4 inline mr-1" />
              Date Lost *
            </label>
            <input
              type="date"
              value={formData.lost_date}
              onChange={(e) => setFormData({ ...formData, lost_date: e.target.value })}
              max={new Date().toISOString().split('T')[0]}
              className={`input ${errors.lost_date ? 'border-red-500' : ''}`}
            />
            {errors.lost_date && <p className="mt-1 text-sm text-red-500">{errors.lost_date}</p>}
          </div>

          <div className="flex justify-between">
            <Button variant="secondary" onClick={handleBack}>
              <ArrowLeft className="w-4 h-4 mr-2" />
              Back
            </Button>
            <Button onClick={handleNext}>
              Next: Verification Questions
              <ArrowRight className="w-4 h-4 ml-2" />
            </Button>
          </div>
        </Card>
      )}

      {/* Step 3: Verification Questions */}
      {step === 3 && (
        <Card className="p-6 animate-fade-in">
          <div className="flex items-start gap-3 mb-6">
            <Shield className="w-6 h-6 text-trust-500 flex-shrink-0 mt-1" />
            <div>
              <h2 className="text-lg font-semibold text-gray-900">Set Verification Questions</h2>
              <p className="text-sm text-gray-600 mt-1">
                Create 3 questions that only the true owner would know. These prevent fraudulent claims.
              </p>
            </div>
          </div>

          <Alert type="info" className="mb-6">
            <strong>Tips:</strong> Ask about unique details like scratches, personal photos, app layouts, 
            or things that wouldn't be visible to someone who found your item.
          </Alert>

          {formData.verification_questions.map((q, index) => (
            <div key={index} className="mb-6 p-4 bg-gray-50 rounded-xl">
              <div className="flex items-center gap-2 mb-3">
                <span className="w-6 h-6 bg-primary-500 text-white rounded-full flex items-center justify-center text-sm font-medium">
                  {index + 1}
                </span>
                <span className="font-medium text-gray-700">Question {index + 1}</span>
              </div>

              <div className="mb-3">
                <Input
                  value={q.question}
                  onChange={(e) => updateQuestion(index, 'question', e.target.value)}
                  placeholder="Enter your verification question..."
                  error={errors[`question_${index}`]}
                />
                {suggestedQuestions.length > 0 && !q.question && (
                  <div className="mt-2">
                    <p className="text-xs text-gray-500 mb-1">Suggestions:</p>
                    <div className="flex flex-wrap gap-1">
                      {suggestedQuestions.slice(0, 3).map((suggestion, si) => (
                        <button
                          key={si}
                          type="button"
                          onClick={() => updateQuestion(index, 'question', suggestion)}
                          className="text-xs px-2 py-1 bg-white border border-gray-200 rounded hover:border-primary-300 hover:bg-primary-50"
                        >
                          {suggestion.substring(0, 40)}...
                        </button>
                      ))}
                    </div>
                  </div>
                )}
              </div>

              <Input
                value={q.answer}
                onChange={(e) => updateQuestion(index, 'answer', e.target.value)}
                placeholder="Your answer (only you should know this)"
                error={errors[`answer_${index}`]}
              />
            </div>
          ))}

          {/* NOVEL: Verification Strength Analyzer */}
          <VerificationStrengthIndicator
            questions={formData.verification_questions.map(q => q.question)}
            answers={formData.verification_questions.map(q => q.answer)}
            category={formData.category}
            description={formData.description}
            onSelectTemplate={(index, question) => updateQuestion(index, 'question', question)}
          />

          <Alert type="warning" className="mb-6">
            <AlertCircle className="w-4 h-4 inline mr-2" />
            <strong>Remember your answers!</strong> You'll need them to verify ownership if someone 
            claims to have found your item. Answers are not case-sensitive.
          </Alert>

          <div className="flex justify-between">
            <Button variant="secondary" onClick={handleBack}>
              <ArrowLeft className="w-4 h-4 mr-2" />
              Back
            </Button>
            <Button onClick={handleSubmit} loading={loading}>
              <Check className="w-4 h-4 mr-2" />
              Submit Report
            </Button>
          </div>
        </Card>
      )}
    </div>
    </>
  );
};

export default ReportLostPage;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/ResetPasswordPage.tsx
â”‚ Language: TSX | Lines: 170 | Size: 5.4 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState } from 'react';
import { Link, useSearchParams, useNavigate } from 'react-router-dom';
import { Lock, CheckCircle, XCircle, ArrowLeft } from 'lucide-react';
import { Button, Card, Input, Alert } from '../components/ui';
import { authApi } from '../services/api';
import toast from 'react-hot-toast';

const ResetPasswordPage: React.FC = () => {
  const [searchParams] = useSearchParams();
  const navigate = useNavigate();
  const token = searchParams.get('token');

  const [password, setPassword] = useState('');
  const [confirmPassword, setConfirmPassword] = useState('');
  const [loading, setLoading] = useState(false);
  const [success, setSuccess] = useState(false);
  const [error, setError] = useState('');

  const validatePassword = () => {
    if (password.length < 8) {
      return 'Password must be at least 8 characters';
    }
    if (!/[A-Z]/.test(password)) {
      return 'Password must contain an uppercase letter';
    }
    if (!/[a-z]/.test(password)) {
      return 'Password must contain a lowercase letter';
    }
    if (!/[0-9]/.test(password)) {
      return 'Password must contain a number';
    }
    if (password !== confirmPassword) {
      return 'Passwords do not match';
    }
    return null;
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    const validationError = validatePassword();
    if (validationError) {
      setError(validationError);
      return;
    }

    if (!token) {
      setError('Invalid or missing reset token');
      return;
    }

    setLoading(true);
    setError('');

    try {
      await authApi.resetPassword(token, password);
      setSuccess(true);
      toast.success('Password reset successfully!');
    } catch (err: any) {
      setError(err.response?.data?.message || 'Failed to reset password. The link may have expired.');
    } finally {
      setLoading(false);
    }
  };

  if (!token) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gray-50 px-4">
        <Card className="w-full max-w-md p-8 text-center">
          <div className="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6">
            <XCircle className="w-8 h-8 text-red-500" />
          </div>
          <h1 className="text-2xl font-bold text-gray-900 mb-2">Invalid Link</h1>
          <p className="text-gray-600 mb-6">
            This password reset link is invalid or has expired.
          </p>
          <Link to="/forgot-password">
            <Button className="w-full">Request New Link</Button>
          </Link>
        </Card>
      </div>
    );
  }

  if (success) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gray-50 px-4">
        <Card className="w-full max-w-md p-8 text-center">
          <div className="w-16 h-16 bg-trust-100 rounded-full flex items-center justify-center mx-auto mb-6">
            <CheckCircle className="w-8 h-8 text-trust-500" />
          </div>
          <h1 className="text-2xl font-bold text-gray-900 mb-2">Password Reset!</h1>
          <p className="text-gray-600 mb-6">
            Your password has been successfully reset. You can now log in with your new password.
          </p>
          <Link to="/login">
            <Button className="w-full">Go to Login</Button>
          </Link>
        </Card>
      </div>
    );
  }

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-50 px-4">
      <Card className="w-full max-w-md p-8">
        <div className="text-center mb-8">
          <div className="w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <Lock className="w-8 h-8 text-primary-500" />
          </div>
          <h1 className="text-2xl font-bold text-gray-900 mb-2">Reset Password</h1>
          <p className="text-gray-600">
            Enter your new password below.
          </p>
        </div>

        {error && (
          <Alert type="error" className="mb-6">
            {error}
          </Alert>
        )}

        <form onSubmit={handleSubmit} className="space-y-6">
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              New Password
            </label>
            <Input
              type="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
              required
            />
            <p className="text-xs text-gray-500 mt-1">
              Min 8 characters with uppercase, lowercase, and number
            </p>
          </div>

          <div>
            <label className="block text-sm font-medium text-gray-700 mb-1">
              Confirm Password
            </label>
            <Input
              type="password"
              value={confirmPassword}
              onChange={(e) => setConfirmPassword(e.target.value)}
              placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
              required
            />
          </div>

          <Button type="submit" loading={loading} className="w-full">
            Reset Password
          </Button>
        </form>

        <div className="mt-6 text-center">
          <Link to="/login" className="text-sm text-primary-500 hover:text-primary-600">
            <ArrowLeft className="w-4 h-4 inline mr-1" />
            Back to Login
          </Link>
        </div>
      </Card>
    </div>
  );
};

export default ResetPasswordPage;



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/SearchPage.tsx
â”‚ Language: TSX | Lines: 428 | Size: 16.6 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { Link, useSearchParams } from 'react-router-dom';
import { 
  Search, Filter, MapPin, Calendar, Smartphone, CreditCard, 
  Wallet, Briefcase, Key, Package, X, RefreshCw
} from 'lucide-react';
import { Button, Card, Badge, LoadingSpinner, EmptyState } from '../components/ui';
import { foundItemsApi, lostItemsApi } from '../services/api';
import { FoundItem, LostItem, ItemCategory, CATEGORY_INFO, RWANDA_LOCATIONS } from '../types';
import { format, isValid, parseISO } from 'date-fns';

// Safe date formatter
const formatDateShort = (dateString: string | null | undefined): string => {
  if (!dateString) return 'N/A';
  try {
    const date = typeof dateString === 'string' ? parseISO(dateString) : new Date(dateString);
    if (!isValid(date)) return 'N/A';
    return format(date, 'MMM d');
  } catch {
    return 'N/A';
  }
};

const SearchPage: React.FC = () => {
  const [searchParams, setSearchParams] = useSearchParams();
  const [activeTab, setActiveTab] = useState<'found' | 'lost'>(
    (searchParams.get('type') as 'found' | 'lost') || 'found'
  );
  const [items, setItems] = useState<(FoundItem | LostItem)[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [showFilters, setShowFilters] = useState(false);
  const [pagination, setPagination] = useState({ page: 1, total: 0, totalPages: 1 });

  // Filter states
  const [filters, setFilters] = useState({
    keyword: searchParams.get('keyword') || '',
    category: searchParams.get('category') || '',
    location_area: searchParams.get('location') || '',
    date_from: searchParams.get('date_from') || '',
    date_to: searchParams.get('date_to') || '',
  });

  useEffect(() => {
    loadItems();
  }, [activeTab, searchParams]);

  const loadItems = async () => {
    setLoading(true);
    setError(null);
    try {
      const params: Record<string, string> = {};
      if (filters.keyword) params.keyword = filters.keyword;
      if (filters.category) params.category = filters.category;
      if (filters.location_area) params.location_area = filters.location_area;
      if (filters.date_from) params.date_from = filters.date_from;
      if (filters.date_to) params.date_to = filters.date_to;
      params.page = searchParams.get('page') || '1';
      params.limit = '12';

      const response = activeTab === 'found'
        ? await foundItemsApi.getAll(params)
        : await lostItemsApi.getAll(params);

      setItems(response.data.data || []);
      setPagination(response.data.pagination || { page: 1, total: 0, totalPages: 1 });
    } catch (err: any) {
      console.error('Failed to load items:', err);
      setError('Failed to load items. Please try again.');
      setItems([]);
    } finally {
      setLoading(false);
    }
  };

  const handleSearch = (e: React.FormEvent) => {
    e.preventDefault();
    const params = new URLSearchParams();
    params.set('type', activeTab);
    if (filters.keyword) params.set('keyword', filters.keyword);
    if (filters.category) params.set('category', filters.category);
    if (filters.location_area) params.set('location', filters.location_area);
    if (filters.date_from) params.set('date_from', filters.date_from);
    if (filters.date_to) params.set('date_to', filters.date_to);
    setSearchParams(params);
  };

  const handleTabChange = (tab: 'found' | 'lost') => {
    setActiveTab(tab);
    const params = new URLSearchParams(searchParams);
    params.set('type', tab);
    params.delete('page');
    setSearchParams(params);
  };

  const clearFilters = () => {
    setFilters({
      keyword: '',
      category: '',
      location_area: '',
      date_from: '',
      date_to: '',
    });
    setSearchParams({ type: activeTab });
  };

  const handlePageChange = (page: number) => {
    const params = new URLSearchParams(searchParams);
    params.set('page', page.toString());
    setSearchParams(params);
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const hasActiveFilters = filters.keyword || filters.category || filters.location_area || filters.date_from || filters.date_to;

  const getItemDate = (item: FoundItem | LostItem): string => {
    if (activeTab === 'found') {
      return (item as FoundItem).found_date || '';
    }
    return (item as LostItem).lost_date || '';
  };

  return (
    <div className="max-w-7xl mx-auto px-4 py-6 sm:py-8">
      {/* Header */}
      <div className="mb-6 sm:mb-8">
        <h1 className="text-2xl sm:text-3xl font-bold text-gray-900 mb-2">Search Items</h1>
        <p className="text-gray-600">Find lost or found items reported in Rwanda</p>
      </div>

      {/* Tabs */}
      <div className="flex border-b border-gray-200 mb-6">
        <button
          onClick={() => handleTabChange('found')}
          className={`flex-1 sm:flex-none px-4 sm:px-6 py-3 text-sm font-medium border-b-2 transition-colors ${
            activeTab === 'found'
              ? 'border-primary-500 text-primary-600'
              : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
          }`}
        >
          Found Items
        </button>
        <button
          onClick={() => handleTabChange('lost')}
          className={`flex-1 sm:flex-none px-4 sm:px-6 py-3 text-sm font-medium border-b-2 transition-colors ${
            activeTab === 'lost'
              ? 'border-primary-500 text-primary-600'
              : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
          }`}
        >
          Lost Items
        </button>
      </div>

      {/* Search Bar */}
      <Card className="p-4 mb-6">
        <form onSubmit={handleSearch}>
          <div className="flex flex-col sm:flex-row gap-3">
            <div className="flex-1 relative">
              <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
              <input
                type="text"
                value={filters.keyword}
                onChange={(e) => setFilters({ ...filters, keyword: e.target.value })}
                placeholder="Search by keyword..."
                className="w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
              />
            </div>
            <div className="flex gap-2">
              <Button type="submit" className="flex-1 sm:flex-none">
                <Search className="w-4 h-4 mr-2" />
                Search
              </Button>
              <Button
                type="button"
                variant="secondary"
                onClick={() => setShowFilters(!showFilters)}
                className="relative"
              >
                <Filter className="w-4 h-4 sm:mr-2" />
                <span className="hidden sm:inline">Filters</span>
                {hasActiveFilters && (
                  <span className="absolute -top-1 -right-1 w-3 h-3 bg-primary-500 rounded-full" />
                )}
              </Button>
            </div>
          </div>

          {/* Filters Panel */}
          {showFilters && (
            <div className="mt-4 pt-4 border-t border-gray-200 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Category</label>
                <select
                  value={filters.category}
                  onChange={(e) => setFilters({ ...filters, category: e.target.value })}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"
                >
                  <option value="">All Categories</option>
                  {Object.entries(CATEGORY_INFO).map(([key, info]) => (
                    <option key={key} value={key}>
                      {info.label}
                    </option>
                  ))}
                </select>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Location</label>
                <select
                  value={filters.location_area}
                  onChange={(e) => setFilters({ ...filters, location_area: e.target.value })}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"
                >
                  <option value="">All Locations</option>
                  {RWANDA_LOCATIONS.map((loc) => (
                    <option key={loc} value={loc}>{loc}</option>
                  ))}
                </select>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Date From</label>
                <input
                  type="date"
                  value={filters.date_from}
                  onChange={(e) => setFilters({ ...filters, date_from: e.target.value })}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"
                />
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">Date To</label>
                <input
                  type="date"
                  value={filters.date_to}
                  onChange={(e) => setFilters({ ...filters, date_to: e.target.value })}
                  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"
                />
              </div>

              {hasActiveFilters && (
                <div className="sm:col-span-2 lg:col-span-4 flex justify-end">
                  <Button type="button" variant="secondary" size="sm" onClick={clearFilters}>
                    <X className="w-4 h-4 mr-1" />
                    Clear Filters
                  </Button>
                </div>
              )}
            </div>
          )}
        </form>
      </Card>

      {/* Results */}
      {loading ? (
        <div className="flex justify-center py-12">
          <LoadingSpinner size="lg" />
        </div>
      ) : error ? (
        <Card className="p-12 text-center">
          <p className="text-red-500 mb-4">{error}</p>
          <Button onClick={loadItems}>
            <RefreshCw className="w-4 h-4 mr-2" />
            Try Again
          </Button>
        </Card>
      ) : items.length === 0 ? (
        <EmptyState
          icon={<Search className="w-16 h-16" />}
          title="No items found"
          description={hasActiveFilters 
            ? "Try adjusting your filters or search terms" 
            : `No ${activeTab} items have been reported yet`
          }
          action={
            hasActiveFilters ? (
              <Button variant="secondary" onClick={clearFilters}>
                Clear Filters
              </Button>
            ) : (
              <Link to={activeTab === 'found' ? '/report-found' : '/report-lost'}>
                <Button>Report an Item</Button>
              </Link>
            )
          }
        />
      ) : (
        <>
          {/* Results Count */}
          <div className="flex items-center justify-between mb-4">
            <p className="text-gray-600">
              Showing <span className="font-medium">{items.length}</span> of{' '}
              <span className="font-medium">{pagination.total}</span> items
            </p>
          </div>

          {/* Items Grid */}
          <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6">
            {items.map((item) => (
              <Link
                key={item.id}
                to={`/${activeTab === 'found' ? 'found' : 'lost'}-items/${item.id}`}
                className="block"
              >
                <Card className="h-full hover:shadow-lg transition-shadow overflow-hidden">
                  {/* Image */}
                  <div className="aspect-video bg-gray-100 relative">
                    {activeTab === 'found' && (item as FoundItem).image_urls && (item as FoundItem).image_urls.length > 0 ? (
                      <img
                        src={(item as FoundItem).image_urls[0]}
                        alt={item.title}
                        className="w-full h-full object-cover"
                        onError={(e) => {
                          (e.target as HTMLImageElement).style.display = 'none';
                        }}
                      />
                    ) : (
                      <div className="w-full h-full flex items-center justify-center">
                        <span className="text-4xl">
                          {CATEGORY_INFO[item.category as ItemCategory]?.icon || 'ğŸ“¦'}
                        </span>
                      </div>
                    )}
                    <div className="absolute top-2 left-2">
                      <Badge variant={activeTab === 'found' ? 'verified' : 'pending'}>
                        {activeTab === 'found' ? 'Found' : 'Lost'}
                      </Badge>
                    </div>
                  </div>

                  {/* Content */}
                  <div className="p-4">
                    <div className="flex items-start justify-between gap-2 mb-2">
                      <h3 className="font-semibold text-gray-900 line-clamp-1 flex-1">
                        {item.title}
                      </h3>
                      <span className={`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium flex-shrink-0 ${
                        CATEGORY_INFO[item.category as ItemCategory]?.color || 'bg-gray-100 text-gray-800'
                      }`}>
                        {CATEGORY_INFO[item.category as ItemCategory]?.label || item.category}
                      </span>
                    </div>
                    
                    <p className="text-sm text-gray-600 mb-3 line-clamp-2">
                      {item.description}
                    </p>
                    
                    <div className="flex flex-wrap items-center gap-3 text-sm text-gray-500">
                      <span className="flex items-center gap-1">
                        <MapPin className="w-4 h-4 flex-shrink-0" />
                        <span className="truncate">{item.location_area}</span>
                      </span>
                      <span className="flex items-center gap-1">
                        <Calendar className="w-4 h-4 flex-shrink-0" />
                        {formatDateShort(getItemDate(item))}
                      </span>
                    </div>

                    {activeTab === 'found' && (item as FoundItem).source === 'COOPERATIVE' && (
                      <div className="mt-3 pt-3 border-t border-gray-100">
                        <span className="text-xs text-trust-600 font-medium">
                          ğŸšŒ Held at cooperative
                        </span>
                      </div>
                    )}
                  </div>
                </Card>
              </Link>
            ))}
          </div>

          {/* Pagination */}
          {pagination.totalPages > 1 && (
            <div className="flex justify-center gap-2 mt-8 flex-wrap">
              <Button
                variant="secondary"
                size="sm"
                onClick={() => handlePageChange(pagination.page - 1)}
                disabled={pagination.page === 1}
              >
                Previous
              </Button>
              
              {Array.from({ length: Math.min(pagination.totalPages, 5) }, (_, i) => {
                let pageNum: number;
                if (pagination.totalPages <= 5) {
                  pageNum = i + 1;
                } else if (pagination.page <= 3) {
                  pageNum = i + 1;
                } else if (pagination.page >= pagination.totalPages - 2) {
                  pageNum = pagination.totalPages - 4 + i;
                } else {
                  pageNum = pagination.page - 2 + i;
                }
                return (
                  <button
                    key={pageNum}
                    onClick={() => handlePageChange(pageNum)}
                    className={`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${
                      pagination.page === pageNum
                        ? 'bg-primary-500 text-white'
                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                    }`}
                  >
                    {pageNum}
                  </button>
                );
              })}

              <Button
                variant="secondary"
                size="sm"
                onClick={() => handlePageChange(pagination.page + 1)}
                disabled={pagination.page === pagination.totalPages}
              >
                Next
              </Button>
            </div>
          )}
        </>
      )}
    </div>
  );
};

export default SearchPage;



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/SettingsPage.tsx
â”‚ Language: TSX | Lines: 312 | Size: 11.3 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useState, useEffect } from 'react';
import { User, Mail, Phone, Shield, Save, Key, Bell } from 'lucide-react';
import { Button, Card, Input, Alert, Badge } from '../components/ui';
import { authApi } from '../services/api';
import { useAuthStore } from '../store/authStore';
import toast from 'react-hot-toast';

const SettingsPage: React.FC = () => {
  const { user, setUser } = useAuthStore();
  const [activeTab, setActiveTab] = useState('profile');
  
  const [profile, setProfile] = useState({
    name: user?.name || '',
    phone: user?.phone || '',
  });
  const [profileLoading, setProfileLoading] = useState(false);

  const [passwords, setPasswords] = useState({
    current: '',
    new: '',
    confirm: '',
  });
  const [passwordLoading, setPasswordLoading] = useState(false);

  useEffect(() => {
    if (user) {
      setProfile({ name: user.name, phone: user.phone || '' });
    }
  }, [user]);

  const handleProfileUpdate = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!profile.name.trim()) {
      toast.error('Name is required');
      return;
    }

    setProfileLoading(true);
    try {
      const response = await authApi.updateProfile({
        name: profile.name,
        phone: profile.phone || undefined,
      });
      setUser(response.data.data);
      toast.success('Profile updated successfully');
    } catch (error: any) {
      toast.error(error.response?.data?.message || 'Failed to update profile');
    } finally {
      setProfileLoading(false);
    }
  };

  const handlePasswordChange = async (e: React.FormEvent) => {
    e.preventDefault();
    
    if (!passwords.current) {
      toast.error('Current password is required');
      return;
    }
    if (passwords.new.length < 8) {
      toast.error('New password must be at least 8 characters');
      return;
    }
    if (passwords.new !== passwords.confirm) {
      toast.error('Passwords do not match');
      return;
    }

    setPasswordLoading(true);
    try {
      await authApi.changePassword({
        currentPassword: passwords.current,
        newPassword: passwords.new,
      });
      toast.success('Password changed successfully. Please log in again.');
      setPasswords({ current: '', new: '', confirm: '' });
      // Optionally log out user after password change
      // logout();
      // navigate('/login');
    } catch (error: any) {
      toast.error(error.response?.data?.message || 'Failed to change password');
    } finally {
      setPasswordLoading(false);
    }
  };

  const getTrustLevel = (score: number) => {
    if (score >= 10) return { level: 'High', color: 'verified' };
    if (score >= 5) return { level: 'Medium', color: 'active' };
    if (score >= 0) return { level: 'New', color: 'pending' };
    return { level: 'Low', color: 'danger' };
  };

  const trustInfo = getTrustLevel(user?.trust_score || 0);

  const tabs = [
    { id: 'profile', label: 'Profile', icon: User },
    { id: 'security', label: 'Security', icon: Shield },
  ];

  return (
    <div className="max-w-4xl mx-auto px-4 py-8">
      <div className="mb-8">
        <h1 className="text-2xl font-bold text-gray-900 mb-2">Settings</h1>
        <p className="text-gray-600">Manage your account settings and preferences</p>
      </div>

      <div className="grid md:grid-cols-4 gap-6">
        {/* Sidebar */}
        <div className="md:col-span-1">
          <Card className="p-4">
            <nav className="space-y-1">
              {tabs.map((tab) => (
                <button
                  key={tab.id}
                  onClick={() => setActiveTab(tab.id)}
                  className={`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-colors ${
                    activeTab === tab.id
                      ? 'bg-primary-50 text-primary-600'
                      : 'text-gray-600 hover:bg-gray-50'
                  }`}
                >
                  <tab.icon className="w-5 h-5" />
                  {tab.label}
                </button>
              ))}
            </nav>
          </Card>

          {/* Trust Score Card */}
          <Card className="p-4 mt-4">
            <h3 className="text-sm font-medium text-gray-500 mb-2">Trust Score</h3>
            <div className="flex items-center gap-3">
              <div className="text-3xl font-bold text-gray-900">
                {user?.trust_score || 0}
              </div>
              <Badge variant={trustInfo.color as any}>
                {trustInfo.level}
              </Badge>
            </div>
            <p className="text-xs text-gray-500 mt-2">
              Your trust score increases with successful returns and decreases with failed verifications.
            </p>
          </Card>
        </div>

        {/* Main Content */}
        <div className="md:col-span-3">
          {activeTab === 'profile' && (
            <Card className="p-6">
              <h2 className="text-lg font-semibold text-gray-900 mb-6">Profile Information</h2>
              
              <form onSubmit={handleProfileUpdate} className="space-y-6">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    Email Address
                  </label>
                  <div className="flex items-center gap-2">
                    <Input
                      type="email"
                      value={user?.email || ''}
                      disabled
                      className="flex-1 bg-gray-50"
                    />
                    <Badge variant={user?.email_verified ? 'verified' : 'pending'}>
                      {user?.email_verified ? 'Verified' : 'Unverified'}
                    </Badge>
                  </div>
                  <p className="text-xs text-gray-500 mt-1">
                    Email cannot be changed
                  </p>
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    Full Name *
                  </label>
                  <Input
                    value={profile.name}
                    onChange={(e) => setProfile({ ...profile, name: e.target.value })}
                    placeholder="Your full name"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    Phone Number
                  </label>
                  <Input
                    type="tel"
                    value={profile.phone}
                    onChange={(e) => setProfile({ ...profile, phone: e.target.value })}
                    placeholder="+250 7XX XXX XXX"
                  />
                  <p className="text-xs text-gray-500 mt-1">
                    Phone number is optional but recommended for account recovery
                  </p>
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    Role
                  </label>
                  <Input
                    value={user?.role === 'admin' ? 'Administrator' : 
                           user?.role === 'coop_staff' ? 'Cooperative Staff' : 'Citizen'}
                    disabled
                    className="bg-gray-50"
                  />
                </div>

                <Button type="submit" loading={profileLoading}>
                  <Save className="w-4 h-4 mr-2" />
                  Save Changes
                </Button>
              </form>
            </Card>
          )}

          {activeTab === 'security' && (
            <div className="space-y-6">
              <Card className="p-6">
                <h2 className="text-lg font-semibold text-gray-900 mb-6">Change Password</h2>
                
                <form onSubmit={handlePasswordChange} className="space-y-6">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">
                      Current Password
                    </label>
                    <Input
                      type="password"
                      value={passwords.current}
                      onChange={(e) => setPasswords({ ...passwords, current: e.target.value })}
                      placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                    />
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">
                      New Password
                    </label>
                    <Input
                      type="password"
                      value={passwords.new}
                      onChange={(e) => setPasswords({ ...passwords, new: e.target.value })}
                      placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                    />
                    <p className="text-xs text-gray-500 mt-1">
                      Min 8 characters with uppercase, lowercase, and number
                    </p>
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">
                      Confirm New Password
                    </label>
                    <Input
                      type="password"
                      value={passwords.confirm}
                      onChange={(e) => setPasswords({ ...passwords, confirm: e.target.value })}
                      placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                    />
                  </div>

                  <Button type="submit" loading={passwordLoading}>
                    <Key className="w-4 h-4 mr-2" />
                    Change Password
                  </Button>
                </form>
              </Card>

              <Card className="p-6">
                <h2 className="text-lg font-semibold text-gray-900 mb-4">Account Security</h2>
                
                <div className="space-y-4">
                  <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                    <div className="flex items-center gap-3">
                      <Mail className="w-5 h-5 text-gray-400" />
                      <div>
                        <p className="font-medium text-gray-900">Email Verification</p>
                        <p className="text-sm text-gray-500">Verify your email for account security</p>
                      </div>
                    </div>
                    <Badge variant={user?.email_verified ? 'verified' : 'pending'}>
                      {user?.email_verified ? 'Verified' : 'Pending'}
                    </Badge>
                  </div>

                  <div className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                    <div className="flex items-center gap-3">
                      <Phone className="w-5 h-5 text-gray-400" />
                      <div>
                        <p className="font-medium text-gray-900">Phone Verification</p>
                        <p className="text-sm text-gray-500">Verify your phone for additional security</p>
                      </div>
                    </div>
                    <Badge variant={user?.phone_verified ? 'verified' : 'pending'}>
                      {user?.phone_verified ? 'Verified' : 'Not Set'}
                    </Badge>
                  </div>
                </div>
              </Card>
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

export default SettingsPage;



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/pages/TermsPage.tsx
â”‚ Language: TSX | Lines: 105 | Size: 5.4 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React from 'react';
import { Link } from 'react-router-dom';
import { ArrowLeft, FileText } from 'lucide-react';
import { Card } from '../components/ui';

const TermsPage: React.FC = () => {
  return (
    <div className="max-w-3xl mx-auto px-4 py-8 sm:py-12">
      <Link to="/" className="inline-flex items-center text-gray-600 hover:text-gray-900 mb-6">
        <ArrowLeft className="w-4 h-4 mr-2" />Back to Home
      </Link>

      <div className="flex items-center gap-3 mb-8">
        <div className="w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center">
          <FileText className="w-6 h-6 text-primary-600" />
        </div>
        <div>
          <h1 className="text-2xl sm:text-3xl font-bold text-gray-900">Terms of Service</h1>
          <p className="text-sm text-gray-500">Last updated: February 2026</p>
        </div>
      </div>

      <Card className="p-6 sm:p-8 prose prose-gray max-w-none">
        <h2 className="text-lg font-semibold text-gray-900 mt-0">1. Acceptance of Terms</h2>
        <p className="text-gray-600">
          By creating an account or using Byaboneka+, you agree to these Terms of Service. 
          Byaboneka+ is a lost and found platform designed to facilitate the recovery of lost 
          items within Rwanda's transport ecosystem.
        </p>

        <h2 className="text-lg font-semibold text-gray-900">2. User Accounts</h2>
        <p className="text-gray-600">
          You must provide accurate information when creating an account. You are responsible 
          for maintaining the security of your credentials. Each person may only create one 
          account. Accounts found to be duplicates or fraudulent may be suspended.
        </p>

        <h2 className="text-lg font-semibold text-gray-900">3. Reporting Items</h2>
        <p className="text-gray-600">
          When reporting lost or found items, you must provide truthful and accurate descriptions. 
          Deliberately filing false reports, claiming items that don't belong to you, or manipulating 
          item descriptions is prohibited and may result in account suspension and trust score penalties.
        </p>

        <h2 className="text-lg font-semibold text-gray-900">4. Verification & Claims</h2>
        <p className="text-gray-600">
          The verification system is designed to protect rightful owners. You must answer verification 
          questions honestly when claiming items. Attempting to guess or brute-force verification 
          answers is prohibited. Failed verification attempts are logged and may affect your trust score.
        </p>

        <h2 className="text-lg font-semibold text-gray-900">5. Trust Score</h2>
        <p className="text-gray-600">
          Your trust score reflects your reputation on the platform. It increases with successful 
          returns and honest interactions, and decreases with failed verifications, reported scams, 
          or policy violations. Users with very low trust scores may face restrictions.
        </p>

        <h2 className="text-lg font-semibold text-gray-900">6. Prohibited Conduct</h2>
        <ul className="text-gray-600 list-disc pl-5 space-y-1">
          <li>Filing false lost or found item reports</li>
          <li>Claiming items that do not belong to you</li>
          <li>Requesting payment or rewards for returning items</li>
          <li>Harassing or threatening other users</li>
          <li>Attempting to bypass verification or security measures</li>
          <li>Creating multiple accounts to circumvent restrictions</li>
          <li>Sharing personal information of other users outside the platform</li>
        </ul>

        <h2 className="text-lg font-semibold text-gray-900">7. Cooperative Partners</h2>
        <p className="text-gray-600">
          Transport cooperatives using Byaboneka+ agree to register found items promptly, 
          facilitate handovers in good faith, and maintain their staff accounts responsibly. 
          Cooperative accountability scores are publicly visible on the platform leaderboard.
        </p>

        <h2 className="text-lg font-semibold text-gray-900">8. Disputes</h2>
        <p className="text-gray-600">
          If you believe a claim or verification result is incorrect, you may open a dispute. 
          Disputes are reviewed by platform administrators who may examine evidence, messages, 
          and platform logs to reach a resolution. Trust score adjustments may be applied based 
          on dispute outcomes.
        </p>

        <h2 className="text-lg font-semibold text-gray-900">9. Limitation of Liability</h2>
        <p className="text-gray-600">
          Byaboneka+ facilitates connections between item finders and owners but does not 
          guarantee recovery of any item. We are not responsible for the condition of items, 
          the conduct of users during physical meetups, or any losses arising from use of the platform. 
          Always meet at recommended safe handover locations.
        </p>

        <h2 className="text-lg font-semibold text-gray-900">10. Contact</h2>
        <p className="text-gray-600">
          Questions about these terms can be directed to{' '}
          <a href="mailto:support@byaboneka.rw" className="text-primary-500 hover:underline">
            support@byaboneka.rw
          </a>
        </p>
      </Card>
    </div>
  );
};

export default TermsPage;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/services/api.ts
â”‚ Language: TypeScript | Lines: 562 | Size: 18.0 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import axios, { AxiosInstance, AxiosError, InternalAxiosRequestConfig, AxiosResponse } from 'axios';
import { useAuthStore } from '../store/authStore';
import { User, LostItem, FoundItem, Claim, Message, Cooperative, MessageThread } from '../types';

// ============================================
// CONFIGURATION
// ============================================

const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:4000/api/v1';
const TIMEOUT = 30000; // 30 seconds
const MAX_RETRIES = 3;
const RETRY_DELAY = 1000; // 1 second

// ============================================
// API RESPONSE TYPES
// ============================================

interface ApiResponse<T = any> {
  success: boolean;
  data: T;
  message?: string;
}

interface PaginatedResponse<T> {
  success: boolean;
  data: T[];
  pagination: {
    page: number;
    limit: number;
    total: number;
    totalPages: number;
  };
}

interface AuthTokens {
  accessToken: string;
  refreshToken: string;
}

interface LoginResponse {
  user: User;
  tokens: AuthTokens;
}

// ============================================
// CREATE AXIOS INSTANCE
// ============================================

const api: AxiosInstance = axios.create({
  baseURL: API_URL,
  timeout: TIMEOUT,
  headers: {
    'Content-Type': 'application/json',
  },
  withCredentials: false,
});

// ============================================
// RETRY LOGIC
// ============================================

const sleep = (ms: number) => new Promise(resolve => setTimeout(resolve, ms));

const shouldRetry = (error: AxiosError): boolean => {
  if (!error.response) return true;
  const status = error.response.status;
  return status >= 500 && status <= 599;
};

// ============================================
// REQUEST INTERCEPTOR
// ============================================

api.interceptors.request.use(
  (config: InternalAxiosRequestConfig) => {
    const token = useAuthStore.getState().accessToken;
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    (config as any).metadata = { startTime: new Date() };
    return config;
  },
  (error) => {
    console.error('Request interceptor error:', error);
    return Promise.reject(error);
  }
);

// ============================================
// RESPONSE INTERCEPTOR
// ============================================

api.interceptors.response.use(
  (response: AxiosResponse) => {
    if (import.meta.env.DEV) {
      const startTime = (response.config as any).metadata?.startTime;
      if (startTime) {
        const duration = new Date().getTime() - startTime.getTime();
        console.debug(`${response.config.method?.toUpperCase()} ${response.config.url} - ${duration}ms`);
      }
    }
    return response;
  },
  async (error: AxiosError) => {
    const originalRequest = error.config as InternalAxiosRequestConfig & { _retry?: boolean };

    if (error.response?.status === 401 && !originalRequest._retry) {
      originalRequest._retry = true;

      const refreshToken = useAuthStore.getState().refreshToken;
      
      if (refreshToken) {
        try {
          const response = await axios.post(`${API_URL}/auth/refresh`, {
            refreshToken,
          });

          const { accessToken, refreshToken: newRefreshToken } = response.data.data;
          useAuthStore.getState().setTokens(accessToken, newRefreshToken);

          originalRequest.headers.Authorization = `Bearer ${accessToken}`;
          return api(originalRequest);
        } catch (refreshError) {
          console.error('Token refresh failed:', refreshError);
          useAuthStore.getState().logout();
          
          if (typeof window !== 'undefined') {
            window.location.href = '/login?session_expired=true';
          }
          return Promise.reject(refreshError);
        }
      } else {
        useAuthStore.getState().logout();
        if (typeof window !== 'undefined') {
          window.location.href = '/login';
        }
      }
    }

    if (error.response?.status === 429) {
      console.warn('Rate limited. Please slow down.');
    }

    if (!error.response) {
      console.error('Network error:', error.message);
    }

    return Promise.reject(error);
  }
);

// ============================================
// ERROR HELPER
// ============================================

export const getErrorMessage = (error: any): string => {
  if (axios.isAxiosError(error)) {
    return error.response?.data?.message || error.message || 'An error occurred';
  }
  return error?.message || 'An unexpected error occurred';
};

// ============================================
// AUTH API
// ============================================

export const authApi = {
  register: (data: { email: string; password: string; name: string; phone?: string }) =>
    api.post<ApiResponse<LoginResponse>>('/auth/register', data),

  login: (data: { email: string; password: string }) =>
    api.post<ApiResponse<LoginResponse>>('/auth/login', data),

  logout: () => {
    const refreshToken = useAuthStore.getState().refreshToken;
    return api.post<ApiResponse>('/auth/logout', { refreshToken });
  },

  refreshToken: (refreshToken: string) =>
    api.post<ApiResponse<AuthTokens>>('/auth/refresh', { refreshToken }),

  forgotPassword: (email: string) =>
    api.post<ApiResponse>('/auth/forgot-password', { email }),

  resetPassword: (token: string, password: string) =>
    api.post<ApiResponse>('/auth/reset-password', { token, password }),

  getProfile: () =>
    api.get<ApiResponse<User>>('/auth/profile'),

  updateProfile: (data: { name?: string; phone?: string }) =>
    api.put<ApiResponse<User>>('/auth/profile', data),

  changePassword: (data: { currentPassword: string; newPassword: string }) =>
    api.post<ApiResponse>('/auth/change-password', data),
};

// ============================================
// EMAIL VERIFICATION API (FIX #10 - was missing)
// ============================================

export const emailVerificationApi = {
  requestVerification: () =>
    api.post<ApiResponse<{ message: string }>>('/auth/email/verify/request'),

  verify: (token: string) =>
    api.post<ApiResponse<{ verified: boolean }>>('/auth/email/verify', { token }),

  getStatus: () =>
    api.get<ApiResponse<{ email_verified: boolean }>>('/auth/email/status'),
};

// ============================================
// LOST ITEMS API
// ============================================

export interface CreateLostItemData {
  category: string;
  title: string;
  description: string;
  location_area: string;
  location_hint?: string;
  lost_date: string;
  verification_questions: Array<{ question: string; answer: string }>;
}

export interface UpdateLostItemData {
  title?: string;
  description?: string;
  location_area?: string;
  location_hint?: string;
  status?: string;
}

export const lostItemsApi = {
  create: (data: CreateLostItemData) =>
    api.post<ApiResponse<LostItem>>('/lost-items', data),

  getAll: (params?: { page?: number; limit?: number; category?: string; location_area?: string; keyword?: string }) =>
    api.get<PaginatedResponse<LostItem>>('/lost-items', { params }),

  getById: (id: number) =>
    api.get<ApiResponse<LostItem>>(`/lost-items/${id}`),

  update: (id: number, data: UpdateLostItemData) =>
    api.put<ApiResponse<LostItem>>(`/lost-items/${id}`, data),

  delete: (id: number) =>
    api.delete<ApiResponse>(`/lost-items/${id}`),

  getMatches: (id: number) =>
    api.get<ApiResponse<Array<{ found_item: FoundItem; score: number; explanation: string[] }>>>(`/lost-items/${id}/matches`),

  getMine: (params?: { page?: number; limit?: number }) =>
    api.get<PaginatedResponse<LostItem>>('/users/me/lost-items', { params }),
};

// ============================================
// FOUND ITEMS API
// ============================================

export interface CreateFoundItemData {
  category: string;
  title: string;
  description: string;
  location_area: string;
  location_hint?: string;
  found_date: string;
  cooperative_id?: number;
}

export interface UpdateFoundItemData {
  title?: string;
  description?: string;
  location_area?: string;
  location_hint?: string;
  status?: string;
}

export const foundItemsApi = {
  create: (data: CreateFoundItemData) =>
    api.post<ApiResponse<FoundItem>>('/found-items', data),

  getAll: (params?: { page?: number; limit?: number; category?: string; location_area?: string; keyword?: string }) =>
    api.get<PaginatedResponse<FoundItem>>('/found-items', { params }),

  getById: (id: number) =>
    api.get<ApiResponse<FoundItem>>(`/found-items/${id}`),

  update: (id: number, data: UpdateFoundItemData) =>
    api.put<ApiResponse<FoundItem>>(`/found-items/${id}`, data),

  delete: (id: number) =>
    api.delete<ApiResponse>(`/found-items/${id}`),

  uploadImages: (id: number, files: FileList | File[]) => {
    const formData = new FormData();
    Array.from(files).forEach((file) => {
      formData.append('images', file);
    });
    return api.post<ApiResponse<{ image_urls: string[] }>>(`/found-items/${id}/images`, formData, {
      headers: { 'Content-Type': 'multipart/form-data' },
      timeout: 60000,
    });
  },

  getMatches: (id: number) =>
    api.get<ApiResponse<Array<{ lost_item: LostItem; score: number; explanation: string[] }>>>(`/found-items/${id}/matches`),

  getMine: (params?: { page?: number; limit?: number }) =>
    api.get<PaginatedResponse<FoundItem>>('/users/me/found-items', { params }),
};

// ============================================
// DUPLICATE DETECTION API (FIX #9 - was missing)
// ============================================

export const duplicateApi = {
  checkLost: (data: { category: string; title: string; description: string; location_area: string; lost_date: string }) =>
    api.post<ApiResponse<{
      has_potential_duplicates: boolean;
      candidates: Array<{
        id: number;
        title: string;
        description: string;
        category: string;
        location_area: string;
        date: string;
        similarity_score: number;
        similarity_reasons: string[];
      }>;
      highest_score: number;
    }>>('/lost-items/check-duplicate', data),

  checkFound: (data: { category: string; title: string; description: string; location_area: string; found_date: string }) =>
    api.post<ApiResponse<{
      has_potential_duplicates: boolean;
      candidates: Array<{
        id: number;
        title: string;
        description: string;
        category: string;
        location_area: string;
        date: string;
        similarity_score: number;
        similarity_reasons: string[];
      }>;
      highest_score: number;
    }>>('/found-items/check-duplicate', data),
};

// ============================================
// CLAIMS API
// ============================================

export const claimsApi = {
  create: (data: { lost_item_id: number; found_item_id: number }) =>
    api.post<ApiResponse<Claim>>('/claims', data),

  getById: (id: number) =>
    api.get<ApiResponse<Claim>>(`/claims/${id}`),

  getQuestions: (claimId: number) =>
    api.get<ApiResponse<{ claim_id: number; questions: string[]; attempts_remaining: number }>>(`/claims/${claimId}/questions`),

  verify: (claimId: number, answers: string[]) =>
    api.post<ApiResponse<{ verified: boolean; correct_count: number; attempts_remaining: number }>>(`/claims/${claimId}/verify`, { answers }),

  cancel: (claimId: number) =>
    api.post<ApiResponse>(`/claims/${claimId}/cancel`),

  getMine: (params?: { page?: number; limit?: number; status?: string }) =>
    api.get<PaginatedResponse<Claim>>('/users/me/claims', { params }),

  // FIX #11 - Verification cooldown status
  getVerificationStatus: (claimId: number) =>
    api.get<ApiResponse>(`/claims/${claimId}/verification/status`),
};

// ============================================
// HANDOVER API (FIX #1 - URLs were completely wrong)
// Old: /handovers/:id/generate-otp  â†’  Fixed: /claims/:id/handover/otp
// Old: /handovers/:id/confirm       â†’  Fixed: /claims/:id/handover/verify
// ============================================

export const handoverApi = {
  generateOtp: (claimId: number) =>
    api.post<ApiResponse<{ otp: string; expires_at: string; validity_hours: number }>>(`/claims/${claimId}/handover/otp`),

  confirmHandover: (claimId: number, otp: string) =>
    api.post<ApiResponse<{ message: string; handover_completed: boolean }>>(`/claims/${claimId}/handover/verify`, { otp }),

  getStatus: (claimId: number) =>
    api.get<ApiResponse<{
      has_otp: boolean;
      otp_verified?: boolean;
      expires_at?: string;
      attempts_used?: number;
      is_expired?: boolean;
      message?: string;
    }>>(`/claims/${claimId}/handover`),
};

// ============================================
// DISPUTE API (FIX #8 - was completely missing)
// ============================================

export const disputeApi = {
  open: (claimId: number, data: { reason: string; evidence_urls?: string[] }) =>
    api.post<ApiResponse>(`/claims/${claimId}/dispute`, data),

  get: (claimId: number) =>
    api.get<ApiResponse<{
      id: number;
      claim_id: number;
      opened_by: number;
      reason: string;
      status: 'OPEN' | 'UNDER_REVIEW' | 'RESOLVED_OWNER' | 'RESOLVED_FINDER' | 'DISMISSED';
      evidence_urls: string[];
      resolution_notes?: string;
      resolved_by?: number;
      created_at: string;
      resolved_at?: string;
    }>>(`/claims/${claimId}/dispute`),

  addEvidence: (disputeId: number, evidence_urls: string[]) =>
    api.post<ApiResponse>(`/disputes/${disputeId}/evidence`, { evidence_urls }),
};

// ============================================
// MESSAGES API (FIX #3 - unread count key, FIX #6 - removed markAsRead)
// ============================================

export const messagesApi = {
  getThreads: (params?: { page?: number; limit?: number }) =>
    api.get<PaginatedResponse<MessageThread>>('/messages/threads', { params }),

  getMessages: (claimId: number, params?: { page?: number; limit?: number }) =>
    api.get<ApiResponse<Message[]>>(`/messages/threads/${claimId}`, { params }),
    // NOTE: Backend auto-marks messages as read when fetched, no separate markAsRead needed

  sendMessage: (claimId: number, content: string) =>
    api.post<ApiResponse<Message>>(`/messages/threads/${claimId}`, { content }),

  reportScam: (messageId: number, reason: string) =>
    api.post<ApiResponse>(`/messages/${messageId}/report`, { reason }),

  // FIX #3: Backend returns { unread_count: number }, NOT { count: number }
  getUnreadCount: () =>
    api.get<ApiResponse<{ unread_count: number }>>('/messages/unread-count'),
};

// ============================================
// COOPERATIVES API
// ============================================

export const cooperativesApi = {
  getAll: (params?: { page?: number; limit?: number; verified?: boolean }) =>
    api.get<PaginatedResponse<Cooperative>>('/cooperatives', { params }),

  getById: (id: number) =>
    api.get<ApiResponse<Cooperative>>(`/cooperatives/${id}`),

  getDashboard: () =>
    api.get<ApiResponse<{
      cooperative: Cooperative;
      stats: { total_items: number; pending_claims: number; returned_items: number; active_staff: number };
      recent_items: FoundItem[];
    }>>('/cooperative/dashboard'),
};

// ============================================
// ADMIN API (FIX #2 - AdminStats type matched to real backend response)
// ============================================

// FIX #2: This now matches what the backend ACTUALLY returns
export interface AdminStats {
  total_users: number;
  total_lost_items: number;
  total_found_items: number;
  total_claims: number;
  successful_returns: number;
  pending_scam_reports: number;
}

// FIX #7: Status uses 'OPEN' not 'PENDING' to match backend
export interface ScamReport {
  id: number;
  reporter_id: number;
  reporter_name: string;
  reporter_email: string;
  reported_user_id: number;
  reported_name: string;
  reported_email: string;
  message_id: number;
  message_content: string;
  claim_id: number;
  reason: string;
  status: 'OPEN' | 'RESOLVED' | 'DISMISSED';
  resolution_notes?: string;
  resolved_by?: number;
  resolved_at?: string;
  created_at: string;
}

export interface AuditLog {
  id: number;
  actor_id: number;
  actor_name: string;
  action: string;
  resource_type: string;
  resource_id: number;
  changes: any;
  ip_address: string;
  timestamp: string;
}

export const adminApi = {
  getStats: () =>
    api.get<ApiResponse<AdminStats>>('/admin/stats'),

  getUsers: (params?: { page?: number; limit?: number; search?: string; role?: string; status?: string }) =>
    api.get<PaginatedResponse<User>>('/admin/users', { params }),

  banUser: (userId: number, reason: string) =>
    api.post<ApiResponse>(`/admin/users/${userId}/ban`, { reason }),

  unbanUser: (userId: number) =>
    api.post<ApiResponse>(`/admin/users/${userId}/unban`),

  recalculateTrust: (userId: number) =>
    api.post<ApiResponse<{ user_id: number; new_trust_score: number }>>(`/admin/users/${userId}/recalculate-trust`),

  getScamReports: (params?: { page?: number; limit?: number; status?: string }) =>
    api.get<PaginatedResponse<ScamReport>>('/admin/scam-reports', { params }),

  resolveScamReport: (reportId: number, data: { resolution_notes: string; action: 'dismiss' | 'warn' | 'ban' }) =>
    api.post<ApiResponse>(`/admin/scam-reports/${reportId}/resolve`, data),

  getAuditLogs: (params?: { page?: number; limit?: number; action?: string; resourceType?: string; actorId?: number }) =>
    api.get<PaginatedResponse<AuditLog>>('/admin/audit-logs', { params }),

  triggerCleanup: () =>
    api.post<ApiResponse<{ message: string }>>('/admin/cleanup'),

  // Admin dispute endpoints
  getDisputes: (params?: { page?: number; limit?: number; status?: string }) =>
    api.get<PaginatedResponse<any>>('/admin/disputes', { params }),

  resolveDispute: (disputeId: number, data: { resolution: string; resolution_notes: string }) =>
    api.post<ApiResponse>(`/admin/disputes/${disputeId}/resolve`, data),
};

// ============================================
// HEALTH CHECK
// ============================================

export const healthApi = {
  check: () => api.get<{ status: string; timestamp: string; database: string }>('/health'),
};

export default api;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/services/novelFeatureApi.ts
â”‚ Language: TypeScript | Lines: 83 | Size: 2.6 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/**
 * ============================================
 * API METHODS FOR NOVEL FEATURES
 * ============================================
 * 
 * Add to: frontend/src/services/novelFeatureApi.ts
 * 
 * Uses the existing default-exported axios instance from api.ts.
 */

import api from './api';

// ============================================
// VERIFICATION STRENGTH API
// ============================================

export const verificationStrengthApi = {
  /** Analyze question quality before saving */
  analyzeStrength: (data: {
    questions: string[];
    answers: string[];
    category: string;
    description: string;
  }) => api.post('/verification/analyze-strength', data),

  /** Get suggested templates for a category */
  getTemplates: (category: string) => 
    api.get(`/verification/templates/${category}`),

  /** Get all templates grouped by category */
  getAllTemplates: () => 
    api.get('/verification/templates'),
};

// ============================================
// COOPERATIVE LEADERBOARD API
// ============================================

export const cooperativeLeaderboardApi = {
  /** Public: get all cooperatives ranked by accountability */
  getLeaderboard: () => 
    api.get('/cooperatives/leaderboard'),

  /** Get detailed accountability report for one cooperative */
  getAccountability: (cooperativeId: number) => 
    api.get(`/cooperatives/${cooperativeId}/accountability`),
};

// ============================================
// SAFE HANDOVER LOCATIONS API
// ============================================

export const handoverLocationsApi = {
  /** Get all safe handover locations */
  getAllLocations: () => 
    api.get('/handover/safe-locations'),

  /** Get recommended locations for a specific area and item type */
  getRecommended: (area: string, category: string) =>
    api.get('/handover/recommended-locations', {
      params: { area, category }
    }),
};

// ============================================
// PRIVACY REDACTION API (admin/testing)
// ============================================

export const privacyApi = {
  /** Preview what redaction would do to text */
  previewRedaction: (text: string, category?: string) =>
    api.post('/privacy/preview-redaction', { text, category }),
};

// ============================================
// FRAUD DETECTION API (admin only)
// ============================================

export const fraudApi = {
  /** Get users flagged by fraud detection */
  getFlaggedUsers: () =>
    api.get('/admin/fraud/flagged-users'),
};


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/store/authStore.ts
â”‚ Language: TypeScript | Lines: 70 | Size: 1.7 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import { create } from 'zustand';
import { persist } from 'zustand/middleware';
import { User } from '../types';

interface AuthState {
  user: User | null;
  accessToken: string | null;
  refreshToken: string | null;
  isAuthenticated: boolean;
  isLoading: boolean;
  
  // Actions
  setUser: (user: User) => void;
  setTokens: (accessToken: string, refreshToken: string) => void;
  login: (user: User, accessToken: string, refreshToken: string) => void;
  logout: () => void;
  updateUser: (updates: Partial<User>) => void;
  setLoading: (loading: boolean) => void;
}

export const useAuthStore = create<AuthState>()(
  persist(
    (set) => ({
      user: null,
      accessToken: null,
      refreshToken: null,
      isAuthenticated: false,
      isLoading: true,

      setUser: (user) => set({ user }),

      setTokens: (accessToken, refreshToken) =>
        set({ accessToken, refreshToken }),

      login: (user, accessToken, refreshToken) =>
        set({
          user,
          accessToken,
          refreshToken,
          isAuthenticated: true,
          isLoading: false,
        }),

      logout: () =>
        set({
          user: null,
          accessToken: null,
          refreshToken: null,
          isAuthenticated: false,
        }),

      updateUser: (updates) =>
        set((state) => ({
          user: state.user ? { ...state.user, ...updates } : null,
        })),

      setLoading: (isLoading) => set({ isLoading }),
    }),
    {
      name: 'byaboneka-auth',
      partialize: (state) => ({
        user: state.user,
        accessToken: state.accessToken,
        refreshToken: state.refreshToken,
        isAuthenticated: state.isAuthenticated,
      }),
    }
  )
);



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/types/index.ts
â”‚ Language: TypeScript | Lines: 320 | Size: 7.8 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

// ============================================
// BYABONEKA+ FRONTEND TYPES
// ============================================

export enum UserRole {
  CITIZEN = 'citizen',
  COOP_STAFF = 'coop_staff',
  ADMIN = 'admin'
}

export enum ItemCategory {
  PHONE = 'PHONE',
  ID = 'ID',
  WALLET = 'WALLET',
  BAG = 'BAG',
  KEYS = 'KEYS',
  OTHER = 'OTHER'
}

export enum LostItemStatus {
  ACTIVE = 'ACTIVE',
  CLAIMED = 'CLAIMED',
  RETURNED = 'RETURNED',
  EXPIRED = 'EXPIRED'
}

export enum FoundItemStatus {
  UNCLAIMED = 'UNCLAIMED',
  MATCHED = 'MATCHED',
  RETURNED = 'RETURNED',
  EXPIRED = 'EXPIRED'
}

export enum ClaimStatus {
  PENDING = 'PENDING',
  VERIFIED = 'VERIFIED',
  REJECTED = 'REJECTED',
  RETURNED = 'RETURNED',
  DISPUTED = 'DISPUTED',
  CANCELLED = 'CANCELLED',
  EXPIRED = 'EXPIRED'
}

// User
export interface User {
  id: number;
  email: string;
  name: string;
  phone?: string;
  role: UserRole;
  trust_score: number;
  cooperative_id?: number;
  cooperative_name?: string;
  email_verified: boolean;
  phone_verified: boolean;
  created_at: string;
}

// Lost Item
export interface LostItem {
  id: number;
  user_id: number;
  category: ItemCategory;
  title: string;
  description: string;
  location_area: string;
  location_hint?: string;
  lost_date: string;
  status: LostItemStatus;
  keywords?: string[];
  photo_url?: string;
  created_at: string;
  user_name?: string;
  verification_questions?: string[];
  match_count?: number;
  claim_count?: number;
}

// Found Item
export interface FoundItem {
  id: number;
  finder_id: number;
  cooperative_id?: number;
  category: ItemCategory;
  title: string;
  description: string;
  location_area: string;
  location_hint?: string;
  found_date: string;
  status: FoundItemStatus;
  source: 'CITIZEN' | 'COOPERATIVE';
  image_urls: string[];
  keywords?: string[];
  created_at: string;
  finder_name?: string;
  cooperative_name?: string;
  claim_count?: number;
}

// Claim â€” FIX: Added finder_id which backend returns
export interface Claim {
  id: number;
  lost_item_id: number;
  found_item_id: number;
  claimant_id: number;
  finder_id?: number;
  status: ClaimStatus;
  verification_score: number;
  attempts_made: number;
  created_at: string;
  updated_at?: string;
  lost_item_title?: string;
  found_item_title?: string;
  category?: ItemCategory;
  claimant_name?: string;
  otp_expires_at?: string;
  otp_verified?: boolean;
  // Dispute info
  dispute_reason?: string;
}

// Match
export interface Match {
  found_item?: FoundItem;
  lost_item?: LostItem;
  score: number;
  explanation: string[];
}

// Message
export interface Message {
  id: number;
  sender_id: number;
  receiver_id: number;
  claim_id: number;
  content: string;
  is_read: boolean;
  is_flagged: boolean;
  created_at: string;
  sender_name?: string;
  is_mine?: boolean;
  warning?: string;
}

// Message Thread
export interface MessageThread {
  claim_id: number;
  claim_status: ClaimStatus;
  item_title: string;
  category: ItemCategory;
  my_role: 'owner' | 'finder';
  other_party_name: string;
  other_user_id?: number;
  other_user_name?: string;
  last_message?: string;
  last_message_at?: string;
  unread_count: number;
}

// Cooperative â€” FIX INT-01: Matches backend schema exactly
export interface Cooperative {
  id: number;
  name: string;
  registration_number: string;
  status: 'PENDING' | 'VERIFIED' | 'SUSPENDED';
  contact_info: string;
  address?: string;
  verified_at?: string;
  verified_by?: number;
  created_at: string;
  updated_at?: string;
  // Computed fields from backend queries
  staff_count?: number;
  items_count?: number;
}

// Verification Question
export interface VerificationQuestion {
  question: string;
  answer: string;
}

// API Response types
export interface ApiResponse<T = unknown> {
  success: boolean;
  data?: T;
  message?: string;
  errors?: Array<{ field: string; message: string }>;
}

export interface PaginatedResponse<T> {
  success: boolean;
  data: T[];
  pagination: {
    page: number;
    limit: number;
    total: number;
    totalPages: number;
  };
}

// Auth types
export interface AuthTokens {
  accessToken: string;
  refreshToken: string;
}

export interface LoginResponse {
  user: User;
  tokens: AuthTokens;
}

// Form types
export interface CreateLostItemForm {
  category: ItemCategory;
  title: string;
  description: string;
  location_area: string;
  location_hint?: string;
  lost_date: string;
  photo_url?: string;
  verification_questions: VerificationQuestion[];
}

export interface CreateFoundItemForm {
  category: ItemCategory;
  title: string;
  description: string;
  location_area: string;
  location_hint?: string;
  found_date: string;
  cooperative_id?: number;
}

// Search params
export interface ItemSearchParams {
  category?: ItemCategory;
  location_area?: string;
  date_from?: string;
  date_to?: string;
  keyword?: string;
  status?: string;
  page?: number;
  limit?: number;
}

// Category info for UI
export const CATEGORY_INFO: Record<ItemCategory, { label: string; icon: string; color: string }> = {
  [ItemCategory.PHONE]: { label: 'Phone', icon: 'ğŸ“±', color: 'bg-blue-100 text-blue-800' },
  [ItemCategory.ID]: { label: 'ID/Document', icon: 'ğŸªª', color: 'bg-purple-100 text-purple-800' },
  [ItemCategory.WALLET]: { label: 'Wallet', icon: 'ğŸ‘›', color: 'bg-green-100 text-green-800' },
  [ItemCategory.BAG]: { label: 'Bag', icon: 'ğŸ‘œ', color: 'bg-orange-100 text-orange-800' },
  [ItemCategory.KEYS]: { label: 'Keys', icon: 'ğŸ”‘', color: 'bg-yellow-100 text-yellow-800' },
  [ItemCategory.OTHER]: { label: 'Other', icon: 'ğŸ“¦', color: 'bg-gray-100 text-gray-800' },
};

// Status info for UI
export const STATUS_INFO: Record<string, { label: string; color: string }> = {
  ACTIVE: { label: 'Active', color: 'blue' },
  UNCLAIMED: { label: 'Unclaimed', color: 'blue' },
  CLAIMED: { label: 'Claimed', color: 'yellow' },
  MATCHED: { label: 'Matched', color: 'yellow' },
  VERIFIED: { label: 'Verified', color: 'green' },
  RETURNED: { label: 'Returned', color: 'green' },
  PENDING: { label: 'Pending', color: 'yellow' },
  REJECTED: { label: 'Rejected', color: 'red' },
  EXPIRED: { label: 'Expired', color: 'gray' },
  CANCELLED: { label: 'Cancelled', color: 'gray' },
  DISPUTED: { label: 'Disputed', color: 'red' },
};

// Rwanda locations
export const RWANDA_LOCATIONS = [
  'Kimironko', 'Remera', 'Kacyiru', 'Gisozi', 'Kimihurura', 'Nyarutarama',
  'Kibagabaga', 'Kinyinya', 'Nyabugogo', 'Muhima', 'Gitega', 'Nyamirambo',
  'Rwezamenyo', 'Kimisagara', 'Gikondo', 'Kagarama', 'Kicukiro', 'Kanombe',
  'Niboye', 'Masaka', 'Nyarugunga', 'Gasabo', 'Nyarugenge', 'Huye', 'Musanze',
  'Rubavu', 'Muhanga', 'Rwamagana', 'Kayonza', 'Nyagatare'
];

// Verification question templates
export const QUESTION_TEMPLATES: Record<ItemCategory, string[]> = {
  [ItemCategory.PHONE]: [
    'What is your lockscreen wallpaper?',
    'How many apps are in your dock?',
    'What music app is on your home screen?',
    'What color is your phone case?',
    'What are the last 4 digits of your IMEI?'
  ],
  [ItemCategory.WALLET]: [
    'How many cards are in the wallet?',
    'What personal item is in the photo slot?',
    'Approximately how much cash was inside?',
    'What color is the inside of the wallet?',
    'What bank cards are inside?'
  ],
  [ItemCategory.ID]: [
    'What are the last 4 characters of your ID number?',
    'What district is shown on the ID?',
    'What is your birth year on the ID?'
  ],
  [ItemCategory.BAG]: [
    'What brand is the bag?',
    'What items were inside?',
    'What distinctive marks or stickers are on it?',
    'How many compartments does it have?'
  ],
  [ItemCategory.KEYS]: [
    'How many keys are on the keychain?',
    'What does the keychain look like?',
    'What brand is the car key?',
    'Are there any distinctive items attached?'
  ],
  [ItemCategory.OTHER]: [
    'What unique features does it have?',
    'What color is it?',
    'What brand or make is it?'
  ]
};



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/utils/dateUtils.ts
â”‚ Language: TypeScript | Lines: 61 | Size: 1.8 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import { format, isValid, parseISO } from 'date-fns';

/**
 * Safe date formatting that handles invalid dates gracefully
 */
export const formatDate = (dateString: string | null | undefined, formatStr: string = 'MMM d, yyyy'): string => {
  if (!dateString) return 'Unknown';
  try {
    // Try parsing as ISO string first
    let date = parseISO(dateString);
    
    // If that fails, try creating a new Date
    if (!isValid(date)) {
      date = new Date(dateString);
    }
    
    if (!isValid(date)) return 'Unknown';
    return format(date, formatStr);
  } catch {
    return 'Unknown';
  }
};

export const formatDateShort = (dateString: string | null | undefined): string => {
  return formatDate(dateString, 'MMM d');
};

export const formatDateLong = (dateString: string | null | undefined): string => {
  return formatDate(dateString, 'MMMM d, yyyy');
};

export const formatDateTime = (dateString: string | null | undefined): string => {
  return formatDate(dateString, 'MMM d, yyyy h:mm a');
};

export const formatRelative = (dateString: string | null | undefined): string => {
  if (!dateString) return 'Unknown';
  try {
    let date = parseISO(dateString);
    if (!isValid(date)) {
      date = new Date(dateString);
    }
    if (!isValid(date)) return 'Unknown';
    
    const now = new Date();
    const diffMs = now.getTime() - date.getTime();
    const diffMins = Math.floor(diffMs / 60000);
    const diffHours = Math.floor(diffMs / 3600000);
    const diffDays = Math.floor(diffMs / 86400000);
    
    if (diffMins < 1) return 'Just now';
    if (diffMins < 60) return `${diffMins}m ago`;
    if (diffHours < 24) return `${diffHours}h ago`;
    if (diffDays < 7) return `${diffDays}d ago`;
    
    return format(date, 'MMM d');
  } catch {
    return 'Unknown';
  }
};



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/utils/index.ts
â”‚ Language: TypeScript | Lines: 2 | Size: 29 B
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

export * from './dateUtils';



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/App.tsx
â”‚ Language: TSX | Lines: 328 | Size: 9.1 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React, { useEffect } from 'react';
import { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';
import { Toaster } from 'react-hot-toast';
import { Layout } from './components/layout';
import { useAuthStore } from './store/authStore';
import { LoadingSpinner } from './components/ui';

// Pages
import HomePage from './pages/HomePage';
import LoginPage from './pages/LoginPage';
import RegisterPage from './pages/RegisterPage';
import ForgotPasswordPage from './pages/ForgotPasswordPage';
import ResetPasswordPage from './pages/ResetPasswordPage';
import DashboardPage from './pages/DashboardPage';
import SearchPage from './pages/SearchPage';
import ReportLostPage from './pages/ReportLostPage';
import ReportFoundPage from './pages/ReportFoundPage';
import LostItemDetailPage from './pages/LostItemDetailPage';
import FoundItemDetailPage from './pages/FoundItemDetailPage';
import ClaimDetailPage from './pages/ClaimDetailPage';
import MessagesPage from './pages/MessagesPage';
import MyItemsPage from './pages/MyItemsPage';
import SettingsPage from './pages/SettingsPage';
import EditLostItemPage from './pages/EditLostItemPage';
import EditFoundItemPage from './pages/EditFoundItemPage';

// Static Pages (FIX: Add routes for footer links)
import AboutPage from './pages/AboutPage';
import PrivacyPolicyPage from './pages/PrivacyPolicyPage';
import TermsPage from './pages/TermsPage';
import ContactPage from './pages/ContactPage';

// Admin Pages
import AdminDashboardPage from './pages/AdminDashboardPage';
import AdminUsersPage from './pages/AdminUsersPage';
import AdminScamReportsPage from './pages/AdminScamReportsPage';
import AdminFraudDashboard from './pages/AdminFraudDashboard';

// Cooperative Pages
import CoopDashboardPage from './pages/CoopDashboardPage';
import CooperativeLeaderboard from './components/CooperativeLeaderboard';

// Protected Route Component
const ProtectedRoute: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const { isAuthenticated, isLoading } = useAuthStore();

  if (isLoading) {
    return (
      <div className="flex items-center justify-center min-h-screen">
        <LoadingSpinner size="lg" />
      </div>
    );
  }

  if (!isAuthenticated) {
    return <Navigate to="/login" replace />;
  }

  return <>{children}</>;
};

// Admin Route Component
const AdminRoute: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const { isAuthenticated, isLoading, user } = useAuthStore();

  if (isLoading) {
    return (
      <div className="flex items-center justify-center min-h-screen">
        <LoadingSpinner size="lg" />
      </div>
    );
  }

  if (!isAuthenticated || user?.role !== 'admin') {
    return <Navigate to="/dashboard" replace />;
  }

  return <>{children}</>;
};

// Coop Staff Route Component
const CoopRoute: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const { isAuthenticated, isLoading, user } = useAuthStore();

  if (isLoading) {
    return (
      <div className="flex items-center justify-center min-h-screen">
        <LoadingSpinner size="lg" />
      </div>
    );
  }

  if (!isAuthenticated || (user?.role !== 'coop_staff' && user?.role !== 'admin')) {
    return <Navigate to="/dashboard" replace />;
  }

  return <>{children}</>;
};

// Guest Route Component
const GuestRoute: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const { isAuthenticated } = useAuthStore();

  if (isAuthenticated) {
    return <Navigate to="/dashboard" replace />;
  }

  return <>{children}</>;
};

function App() {
  const { setLoading, accessToken } = useAuthStore();

  useEffect(() => {
    setLoading(false);
  }, [accessToken, setLoading]);

  return (
    <BrowserRouter>
      <Layout>
        <Routes>
          {/* Public Routes */}
          <Route path="/" element={<HomePage />} />
          <Route path="/search" element={<SearchPage />} />
          <Route path="/leaderboard" element={<CooperativeLeaderboard />} />
          <Route path="/lost-items/:id" element={<LostItemDetailPage />} />
          <Route path="/found-items/:id" element={<FoundItemDetailPage />} />

          {/* Static Pages (FIX: These were dead links in the footer) */}
          <Route path="/how-it-works" element={<AboutPage />} />
          <Route path="/about" element={<AboutPage />} />
          <Route path="/privacy" element={<PrivacyPolicyPage />} />
          <Route path="/terms" element={<TermsPage />} />
          <Route path="/contact" element={<ContactPage />} />
          <Route path="/faq" element={<ContactPage />} />

          {/* Guest Routes */}
          <Route
            path="/login"
            element={
              <GuestRoute>
                <LoginPage />
              </GuestRoute>
            }
          />
          <Route
            path="/register"
            element={
              <GuestRoute>
                <RegisterPage />
              </GuestRoute>
            }
          />
          <Route
            path="/forgot-password"
            element={
              <GuestRoute>
                <ForgotPasswordPage />
              </GuestRoute>
            }
          />
          <Route
            path="/reset-password"
            element={
              <GuestRoute>
                <ResetPasswordPage />
              </GuestRoute>
            }
          />

          {/* Protected Routes */}
          <Route
            path="/dashboard"
            element={
              <ProtectedRoute>
                <DashboardPage />
              </ProtectedRoute>
            }
          />
          <Route
            path="/report-lost"
            element={
              <ProtectedRoute>
                <ReportLostPage />
              </ProtectedRoute>
            }
          />
          <Route
            path="/report-found"
            element={
              <ProtectedRoute>
                <ReportFoundPage />
              </ProtectedRoute>
            }
          />
          <Route
            path="/claims/:id"
            element={
              <ProtectedRoute>
                <ClaimDetailPage />
              </ProtectedRoute>
            }
          />
          <Route
            path="/messages"
            element={
              <ProtectedRoute>
                <MessagesPage />
              </ProtectedRoute>
            }
          />
          <Route
            path="/my-items"
            element={
              <ProtectedRoute>
                <MyItemsPage />
              </ProtectedRoute>
            }
          />
          <Route
            path="/settings"
            element={
              <ProtectedRoute>
                <SettingsPage />
              </ProtectedRoute>
            }
          />
          <Route
            path="/lost-items/:id/edit"
            element={
              <ProtectedRoute>
                <EditLostItemPage />
              </ProtectedRoute>
            }
          />
          <Route
            path="/found-items/:id/edit"
            element={
              <ProtectedRoute>
                <EditFoundItemPage />
              </ProtectedRoute>
            }
          />

          {/* Admin Routes */}
          <Route
            path="/admin"
            element={
              <AdminRoute>
                <AdminDashboardPage />
              </AdminRoute>
            }
          />
          <Route
            path="/admin/users"
            element={
              <AdminRoute>
                <AdminUsersPage />
              </AdminRoute>
            }
          />
          <Route
            path="/admin/scam-reports"
            element={
              <AdminRoute>
                <AdminScamReportsPage />
              </AdminRoute>
            }
          />
          <Route
            path="/admin/fraud"
            element={
              <AdminRoute>
                <AdminFraudDashboard />
              </AdminRoute>
            }
          />

          {/* Cooperative Routes */}
          <Route
            path="/coop"
            element={
              <CoopRoute>
                <CoopDashboardPage />
              </CoopRoute>
            }
          />

          {/* 404 */}
          <Route
            path="*"
            element={
              <div className="flex flex-col items-center justify-center min-h-[50vh]">
                <h1 className="text-4xl font-bold text-gray-900 mb-4">404</h1>
                <p className="text-gray-600 mb-8">Page not found</p>
                <a href="/" className="px-6 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600">
                  Go Home
                </a>
              </div>
            }
          />
        </Routes>
      </Layout>

      <Toaster
        position="top-right"
        toastOptions={{
          duration: 4000,
          style: {
            background: '#fff',
            color: '#1F2937',
            boxShadow: '0 4px 12px rgba(0, 0, 0, 0.1)',
            borderRadius: '12px',
            padding: '16px',
          },
          success: {
            iconTheme: { primary: '#2E7D32', secondary: '#fff' },
          },
          error: {
            iconTheme: { primary: '#EF4444', secondary: '#fff' },
          },
        }}
      />
    </BrowserRouter>
  );
}

export default App;


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/index.css
â”‚ Language: CSS | Lines: 208 | Size: 4.3 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/* =========================
   SATOSHI FONT (public/)
   Path: /public/fonts/satoshi/
   ========================= */

/* Variable â€“ Normal */
@font-face {
  font-family: "Satoshi";
  src: url("/fonts/satoshi/Satoshi-Variable.woff2") format("woff2-variations");
  font-weight: 300 900;
  font-style: normal;
  font-display: swap;
}

/* Variable â€“ Italic */
@font-face {
  font-family: "Satoshi";
  src: url("/fonts/satoshi/Satoshi-VariableItalic.woff2") format("woff2-variations");
  font-weight: 300 900;
  font-style: italic;
  font-display: swap;
}

/* Static fallbacks (optional but recommended) */
@font-face {
  font-family: "Satoshi";
  src: url("/fonts/satoshi/Satoshi-Light.woff2") format("woff2");
  font-weight: 300;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Satoshi";
  src: url("/fonts/satoshi/Satoshi-LightItalic.woff2") format("woff2");
  font-weight: 300;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: "Satoshi";
  src: url("/fonts/satoshi/Satoshi-Regular.woff2") format("woff2");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Satoshi";
  src: url("/fonts/satoshi/Satoshi-Italic.woff2") format("woff2");
  font-weight: 400;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: "Satoshi";
  src: url("/fonts/satoshi/Satoshi-Medium.woff2") format("woff2");
  font-weight: 500;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Satoshi";
  src: url("/fonts/satoshi/Satoshi-MediumItalic.woff2") format("woff2");
  font-weight: 500;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: "Satoshi";
  src: url("/fonts/satoshi/Satoshi-Bold.woff2") format("woff2");
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Satoshi";
  src: url("/fonts/satoshi/Satoshi-BoldItalic.woff2") format("woff2");
  font-weight: 700;
  font-style: italic;
  font-display: swap;
}

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html {
    font-family: "Satoshi", "Inter", system-ui, sans-serif;
  }

  body {
    @apply bg-gray-50 text-gray-900 antialiased;
  }
}

@layer components {
  .btn {
    @apply inline-flex items-center justify-center px-4 py-2 rounded-lg font-semibold transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed;
  }

  .btn-primary {
    @apply btn bg-primary-500 text-white hover:bg-primary-600 focus:ring-primary-500;
  }

  .btn-secondary {
    @apply btn bg-white text-primary-500 border border-primary-500 hover:bg-primary-50 focus:ring-primary-500;
  }

  .btn-accent {
    @apply btn bg-accent-500 text-white hover:bg-accent-600 focus:ring-accent-500;
  }

  .btn-danger {
    @apply btn bg-red-500 text-white hover:bg-red-600 focus:ring-red-500;
  }

  .input {
    @apply w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary-500 focus:ring-2 focus:ring-primary-200 transition-colors duration-200 outline-none;
  }

  .input-error {
    @apply input border-red-500 focus:border-red-500 focus:ring-red-200;
  }

  .label {
    @apply block text-sm font-medium text-gray-700 mb-1;
  }

  .card {
    @apply bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden;
  }

  .badge {
    @apply inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium;
  }

  .badge-active {
    @apply badge bg-blue-100 text-blue-800;
  }

  .badge-verified {
    @apply badge bg-green-100 text-green-800;
  }

  .badge-pending {
    @apply badge bg-yellow-100 text-yellow-800;
  }

  .badge-expired {
    @apply badge bg-gray-100 text-gray-800;
  }

  .badge-rejected {
    @apply badge bg-red-100 text-red-800;
  }
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: #f1f1f1;
}

::-webkit-scrollbar-thumb {
  background: #c1c1c1;
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: #a1a1a1;
}

/* Animations */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fade-in {
  animation: fadeIn 0.3s ease-out;
}

.animate-slide-up {
  animation: slideUp 0.3s ease-out;
}



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/main.tsx
â”‚ Language: TSX | Lines: 11 | Size: 236 B
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';
import './index.css';

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: src/vite-env.d.ts
â”‚ Language: TypeScript | Lines: 10 | Size: 157 B
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/// <reference types="vite/client" />

interface ImportMetaEnv {
  readonly VITE_API_URL: string;
}

interface ImportMeta {
  readonly env: ImportMetaEnv;
}




â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  SECTION: (root)/
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: .env.example
â”‚ Language: Text | Lines: 6 | Size: 106 B
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# API Configuration
VITE_API_URL=http://localhost:4000/api/v1

# Optional: Analytics
VITE_GA_TRACKING_ID=



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: .gitignore
â”‚ Language: Text | Lines: 107 | Size: 1.6 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# =========================
# Node / JavaScript
# =========================
node_modules/
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*

# =========================
# Build outputs
# =========================
dist/
build/
coverage/

# Vite
.vite/

# =========================
# Environment files
# =========================
.env
.env.*
!.env.example

# =========================
# TypeScript
# =========================
*.tsbuildinfo

# =========================
# Logs
# =========================
logs/
*.log

# =========================
# Uploads / user content
# =========================
uploads/
public/uploads/

# =========================
# Database
# =========================
*.sqlite
*.db
*.dump
*.sql

# =========================
# Cache / temp
# =========================
.cache/
tmp/
temp/

# =========================
# OS generated files
# =========================
.DS_Store
Thumbs.db
ehthumbs.db
desktop.ini

# =========================
# Editor / IDE
# =========================
.vscode/
!.vscode/extensions.json
!.vscode/settings.json

.idea/
*.suo
*.ntvs*
*.njsproj
*.sln

# =========================
# Testing
# =========================
coverage/
.nyc_output/

# =========================
# Misc
# =========================
*.pem
*.key
*.crt

# =========================
# Turborepo / Monorepo
# =========================
.turbo/

# =========================
# Storybook
# =========================
storybook-static/

# =========================
# ESLint
# =========================
.eslintcache



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: Dockerfile
â”‚ Language: Text | Lines: 14 | Size: 140 B
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FROM node:20-alpine

WORKDIR /app

COPY package*.json ./

RUN npm install

COPY . .

EXPOSE 3000

CMD ["npm", "run", "dev", "--", "--host"]



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: index.html
â”‚ Language: HTML | Lines: 19 | Size: 806 B
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/logo.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Byaboneka+ - Trust-Aware Lost & Found Platform for Rwanda's Transport Ecosystem" />
    <meta name="theme-color" content="#1E3A5F" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <title>Byaboneka+ | Lost & Found Rwanda</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: package.json
â”‚ Language: JSON | Lines: 40 | Size: 1.0 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

{
  "name": "byaboneka-plus-frontend",
  "private": true,
  "version": "1.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "lint": "eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0",
    "preview": "vite preview"
  },
  "dependencies": {
    "axios": "^1.6.4",
    "clsx": "^2.1.0",
    "date-fns": "^3.2.0",
    "lucide-react": "^0.303.0",
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-hot-toast": "^2.4.1",
    "react-router-dom": "^6.21.1",
    "zustand": "^4.4.7"
  },
  "devDependencies": {
    "@types/node": "^25.2.2",
    "@types/react": "^18.2.46",
    "@types/react-dom": "^18.2.18",
    "@typescript-eslint/eslint-plugin": "^6.18.0",
    "@typescript-eslint/parser": "^6.18.0",
    "@vitejs/plugin-react": "^4.2.1",
    "autoprefixer": "^10.4.16",
    "eslint": "^8.56.0",
    "eslint-plugin-react-hooks": "^4.6.0",
    "eslint-plugin-react-refresh": "^0.4.5",
    "postcss": "^8.4.33",
    "tailwindcss": "^3.4.1",
    "typescript": "^5.3.3",
    "vite": "^5.0.11"
  }
}



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: postcss.config.js
â”‚ Language: JavaScript | Lines: 7 | Size: 80 B
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: tailwind.config.js
â”‚ Language: JavaScript | Lines: 54 | Size: 1.2 KB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {
      colors: {
        primary: {
          50: "#E8F0F7",
          100: "#D1E1EF",
          200: "#A3C3DF",
          300: "#75A5CF",
          400: "#4787BF",
          500: "#1E3A5F", // Main primary
          600: "#183050",
          700: "#122640",
          800: "#0C1C30",
          900: "#061220",
        },
        trust: {
          50: "#E8F5E9",
          100: "#C8E6C9",
          200: "#A5D6A7",
          300: "#81C784",
          400: "#66BB6A",
          500: "#2E7D32", // Trust green
          600: "#27702D",
          700: "#1F5E26",
          800: "#184D1E",
          900: "#103C17",
        },
        accent: {
          50: "#FFF3E0",
          100: "#FFE0B2",
          200: "#FFCC80",
          300: "#FFB74D",
          400: "#FFA726",
          500: "#FF6B35", // Warm orange
          600: "#E65C2F",
          700: "#CC4D29",
          800: "#B33E23",
          900: "#992F1D",
        },
      },
      fontFamily: {
        sans: ["Satoshi", "Inter", "system-ui", "sans-serif"],
      },
    },
  },
  plugins: [],
};



â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: tsconfig.json
â”‚ Language: JSON | Lines: 25 | Size: 640 B
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx",

    /* Linting - relaxed to allow build to pass */
    "strict": true,
    "noUnusedLocals": false,
    "noUnusedParameters": false,
    "noFallthroughCasesInSwitch": true,
  },
  "include": ["src"],
  "references": [{ "path": "./tsconfig.node.json" }]
}


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: tsconfig.node.json
â”‚ Language: JSON | Lines: 10 | Size: 212 B
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

{
  "compilerOptions": {
    "composite": true,
    "skipLibCheck": true,
    "module": "ESNext",
    "moduleResolution": "bundler",
    "allowSyntheticDefaultImports": true
  },
  "include": ["vite.config.ts"]
}


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: vercel.json
â”‚ Language: JSON | Lines: 23 | Size: 345 B
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

{
  "version": 2,
  "name": "byaboneka-plus",
  "builds": [
    {
      "src": "package.json",
      "use": "@vercel/static-build",
      "config": {
        "distDir": "dist"
      }
    }
  ],
  "routes": [
    {
      "src": "/assets/(.*)",
      "dest": "/assets/$1"
    },
    {
      "src": "/(.*)",
      "dest": "/index.html"
    }
  ]
}


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FILE: vite.config.ts
â”‚ Language: TypeScript | Lines: 16 | Size: 319 B
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import { fileURLToPath } from 'url'

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': fileURLToPath(new URL('./src', import.meta.url)),
    },
  },
  server: {
    host: '0.0.0.0',
    port: 3000
  }
})


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  END OF DUMP â€” 57 files | 11,353 lines
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•